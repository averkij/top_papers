
<!DOCTYPE html>
<html>
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-C1CRWDNJ1J"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-C1CRWDNJ1J');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"><title>HF (2 статьи)</title>
    <link rel="icon" href="favicon.svg" sizes="any" type="image/svg+xml">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@100..900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #0989eacf;
            --secondary-color: #fff;
            --background-color: #f5f5f5;
            --text-color: #333333;
            --header-color: #0989eacf;
            --body-color: #f5f5f5;
        }
        body {
            font-family: 'Roboto Slab', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        header {
            padding: 1.6em 0;
            text-align: center;
        }
        h1 {
            font-size: 2.4em;
            margin: 0;
            font-weight: 700;
        }
        h2 {
            # color: var(--primary-color);
            font-size: 1.2em;
            margin-top: 0;
            margin-bottom: 0.5em;
        }
        header p {
            font-size: 1.2em;
            margin-top: 0.5em;
            font-weight: 300;
        }
        main {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2em;
            padding: 10px 0 20px 0;
        }
        body.dark-tmeme>header {
            background-color: background-color: #333333;
            color: white;
        }
        body.dark-theme>div>main>article>div.article-content>p.meta {
            color: #fff;
        }
        body.light-theme>div>main>article>div.article-content>p.meta {
            color: #555;
        }
        body.dark-theme>div>main>article>div.article-content>p.pub-date {
            color: #ccc;
        }
        body.light-theme>div>main>article>div.article-content>p.pub-date {
            color: #555;
        }
        body.dark-theme>div>main>article>div.article-content>p.tags {
            color: #ccc;
        }
        body.light-theme>div>main>article>div.article-content>p.tags {
            color: #555;
        }
        body.light-theme>header {
            background-color: var(--header-color);
            color: white;
        }
        article {
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);
            transition: background-color 0.2s ease;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        .article-content {
            padding: 1.5em;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 1;
            cursor: pointer;
        }
        body.dark-theme>div>main>article {
            background-color: #444;
        }
        body.light-theme>div>main>article {
            background-color: #fff;
        }
        body.dark-theme>div>main>article:hover {
            background-color: #414141;
        }
        body.light-theme>div>main>article:hover {
            background-color: #fafafa;
        }
        .meta {
            font-size: 0.9em;
            margin-bottom: 0em;
        }
        .pub-date {
            font-size: 0.9em;
            margin-bottom: 0.8em;
            font-weight: 300;
        }
        .tags {
            font-size: 0.9em;
            margin-bottom: 1em;
            position: absolute;
            bottom: 10px;
            font-weight: 300;
            font-family: 'Roboto Slab';
        }
        .background-digit {
            position: absolute;
            bottom: -20px;
            right: -10px;
            font-size: 12em;
            font-weight: bold;
            color: rgba(0, 0, 0, 0.03);
            z-index: 0;
            line-height: 1;
        }
        .abstract {
            position: relative;
            max-height: 170px;
            overflow: hidden;
            transition: max-height 0.3s ease;
            cursor: pointer;
        }
        .abstract.expanded {
            max-height: 1000px;
        }
        .abstract-toggle {
            position: absolute;
            bottom: 4px;
            right: 0;
            cursor: pointer;
            color: var(--primary-color);
            float: right;
            font-weight: 400;
        }
        .explanation {
            background-color: #e8f5e9;
            border-left: 4px solid var(--secondary-color);
            padding: 1em;
            margin-top: 1.5em;
        }
        .links {
            margin-top: 1.5em;
            margin-bottom: 80px;
        }
        a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }
        a:hover {
            color: var(--secondary-color);
        }
        footer {
            background-color: var(--primary-color);
            color: white;
            text-align: center;
            padding: 1em 0;
            margin-top: 2em;
        }
        .light-theme {
            background-color: var(--body-color);
            color: #333333;
        }
        .dark-theme {
            background-color: #333333;
            color: #ffffff;
        }
        .theme-switch {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 30px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 30px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 24px;
            width: 24px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: var(--primary-color);
        }
        input:checked + .slider:before {
            transform: translateX(20px);
        }
        .switch-label {
            margin-right: 10px;
        }
        .update-info-container {
            margin-top: 15px;
            margin-bottom: 0px;
            text-align: left;
        }
        .sort-container {
            margin-top: 15px;
            margin-bottom: 0px;
            text-align: right;
        }
        .sub-header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        .update-info-container {
            flex: 1;
        }
        .sort-container {
            flex: 2;
        }
        .sort-dropdown {
            padding: 5px 10px;
            font-size: 16px;
            border-radius: 5px;
            border: 1px solid #ccc;
            background-color: white;
            color: var(--text-color);
            font-family: 'Roboto Slab', sans-serif;
        }
        .sort-label {
            margin-right: 10px;
            font-size: 1.0em !important;
        }        
        .dark-theme .sort-dropdown {
            background-color: #444;
            color: white;
            border-color: var(--text-color);
        }
        .title-sign {
            display: inline-block;
            transition: all 0.5s ease;            
        }
        .rotate {
            transform: rotate(45deg) translateY(-6px);
            transform-origin: center;
        }
        .title-text {
            display: inline;
            padding-left: 10px;
        }
        .category-filters {
            margin-top: 20px;
            margin-bottom: 20px;
            text-align: center;
        }
        .category-button {
            display: inline-block;
            margin: 5px;
            padding: 5px 10px;
            border-radius: 15px;
            background-color: #f0f0f0;
            color: #333;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .category-button.active {
            background-color: var(--primary-color);
            color: white;
        }
        .dark-theme .category-button {
            background-color: #555;
            color: #fff;
        }
        .dark-theme .category-button.active {
            background-color: var(--primary-color);
        }
        .category-toggle {
            display: none;
            margin-bottom: 10px;
            margin-top: 15px;
            cursor: pointer;
        }
        .clear-categories {
            display: inline-block;
            margin: 5px;
            padding: 5px 10px;
            border-radius: 15px;
            background-color: #f0f0f0;
            color: #333;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .clear-categories:hover {
            background-color: #bbb;
        }
        .svg-container {
            display: inline-block;
            position: relative;
            overflow: hidden;
        }

        .svg-container span {
            position: relative;
            z-index: 1;
        }

        .svg-container svg {
            position: absolute;
            bottom: 0;
            left: 0;
            z-index: 0;
        }
        
        @media (max-width: 768px) {
            .category-filters {
                display: none;
            }
            .category-toggle {
                display: inline-block;
                width: 100%;
                text-align: left;
            }
            .category-filters.expanded {
                display: block;
                margin-top: 10px;
            }
        }
        @media (max-width: 600px) {
            .sub-header-container {
                flex-direction: column;
                align-items: flex-start;
            }
            .update-info-container {
                text-align: left;
                width: 100%;
                margin-bottom: 0px;
            }
            .sort-container {
                margin-top: 0px;
                text-align: left;
                width: 100%;
            .sort-dropdown {
                float: right;
            }
            .sort-label {
                margin-top: 5px;
                float: left;
            }
        }
    </style>
    <script>
    function toggleAbstract(id) {
        var abstract = document.getElementById('abstract-' + id);
        var toggle = document.getElementById('toggle-' + id);
        if (abstract.classList.contains('expanded')) {
            abstract.classList.remove('expanded');
            toggle.textContent = '...';
        } else {
            abstract.classList.add('expanded');
            toggle.textContent = '';
        }
    }
    function getTimeDiffRu(dateString) {
        const timeUnits = {
            minute: ["минуту", "минуты", "минут"],
            hour: ["час", "часа", "часов"],
            day: ["день", "дня", "дней"]
        };

        function getRussianPlural(number, words) {
            if (number % 10 === 1 && number % 100 !== 11) {
                return words[0];
            } else if (number % 10 >= 2 && number % 10 <= 4 && (number % 100 < 10 || number % 100 >= 20)) {
                return words[1];
            } else {
                return words[2];
            }
        }

        const pastDate = new Date(dateString.replace(" ", "T") + ":00Z");
        const currentDate = new Date();
        const diffInSeconds = Math.floor((currentDate - pastDate) / 1000);

        const minutes = Math.floor(diffInSeconds / 60);
        const hours = Math.floor(diffInSeconds / 3600);
        const days = Math.floor(diffInSeconds / 86400);

        if (minutes == 0) {
            return 'только что';
        }
        else if (minutes < 60) {
            return `${minutes} ${getRussianPlural(minutes, timeUnits.minute)} назад`;
        } else if (hours < 24) {
            return `${hours} ${getRussianPlural(hours, timeUnits.hour)} назад`;
        } else {
            return `${days} ${getRussianPlural(days, timeUnits.day)} назад`;
        }
    }
    function formatArticlesTitle(number) {
        const lastDigit = number % 10;
        const lastTwoDigits = number % 100;

        let word;

        if (lastTwoDigits >= 11 && lastTwoDigits <= 14) {
            word = "статей";
        } else if (lastDigit === 1) {
            word = "статья";
        } else if (lastDigit >= 2 && lastDigit <= 4) {
            word = "статьи";
        } else {
            word = "статей";
        }

        return `${number} ${word}`;
    }
    </script>
</head>
<body class="light-theme">
    <header>
        <div class="container">
            <h1 class="title-sign" id="doomgrad-icon">🔺</h1><h1 class="title-text" id="doomgrad">хф дэйли</h1>
            <p>22 октября | 2 статьи</p>
        </div>
        <div class="theme-switch">
            <label class="switch">
                <input type="checkbox" id="theme-toggle">
                <span class="slider"></span>
            </label>
        </div>
    </header>
    <div class="container">
        <div class="sub-header-container">
            <div class="update-info-container">
                <label class="update-info-label" id="timeDiff"></label>
            </div>
            <div class="sort-container">
                <label class="sort-label">🔀 Сортировка по</label>
                <select id="sort-dropdown" class="sort-dropdown">
                    <option value="default">рейтингу</option>
                    <option value="pub_date">дате публикации</option>
                    <option value="issue_id">добавлению на HF</option>
                </select>
            </div>
        </div>
        <div class="category-toggle">
            <div class="svg-container">
                <span id="category-toggle">🔍 Фильтр</span>
                <svg height="3" width="200">
                    <line x1="0" y1="0" x2="200" y2="0" 
                        stroke="black" 
                        stroke-width="2" 
                        stroke-dasharray="3, 3" />
                </svg>
            </div>
        </div>
        <div class="category-filters" id="category-filters">
            <span class="clear-categories" id="clear-categories">🧹</span>
            <!-- Categories -->
        </div>
        <main id="articles-container">
            <!-- Articles -->
        </main>
    </div>
    <footer>
        <div class="container">
            <p><a style="color:white;" href="https://t.me/doomgrad">градиент обреченный</a> ✖️ <a style="color:white;" href="https://huggingface.co/papers">hugging face</a></p>
        </div>
    </footer>
    <script>    
        function toggleTheme() {
            const body = document.body;
            body.classList.toggle('light-theme');
            body.classList.toggle('dark-theme');

            const isDarkMode = body.classList.contains('dark-theme');
            localStorage.setItem('darkMode', isDarkMode);
            
            if (isDarkMode) {
                const title = document.getElementById('doomgrad');
                title.innerHTML = "хф найтли";
                const titleSign = document.getElementById('doomgrad-icon');
                titleSign.classList.add('rotate');
            }  else {
                const title = document.getElementById('doomgrad');
                title.innerHTML = "хф дэйли";
                const titleSign = document.getElementById('doomgrad-icon');
                titleSign.classList.remove('rotate');
            }
        }

        const articlesData = [{'id': 'https://huggingface.co/papers/2410.13218', 'title': 'CBT-Bench: Evaluating Large Language Models on Assisting Cognitive Behavior Therapy', 'url': 'https://huggingface.co/papers/2410.13218', 'abstract': "There is a significant gap between patient needs and available mental health support today. In this paper, we aim to thoroughly examine the potential of using Large Language Models (LLMs) to assist professional psychotherapy. To this end, we propose a new benchmark, CBT-BENCH, for the systematic evaluation of cognitive behavioral therapy (CBT) assistance. We include three levels of tasks in CBT-BENCH: I: Basic CBT knowledge acquisition, with the task of multiple-choice questions; II: Cognitive model understanding, with the tasks of cognitive distortion classification, primary core belief classification, and fine-grained core belief classification; III: Therapeutic response generation, with the task of generating responses to patient speech in CBT therapy sessions. These tasks encompass key aspects of CBT that could potentially be enhanced through AI assistance, while also outlining a hierarchy of capability requirements, ranging from basic knowledge recitation to engaging in real therapeutic conversations. We evaluated representative LLMs on our benchmark. Experimental results indicate that while LLMs perform well in reciting CBT knowledge, they fall short in complex real-world scenarios requiring deep analysis of patients' cognitive structures and generating effective responses, suggesting potential future work.", 'score': 2, 'issue_id': 207, 'pub_date': '2024-10-17', 'pub_date_ru': '17 октября', 'hash': 'f4f24ef7771a745c', 'data': {'desc': 'Исследователи представили новый бенчмарк CBT-BENCH для оценки потенциала использования больших языковых моделей в когнитивно-поведенческой терапии (КПТ). Бенчмарк включает три уровня задач: базовые знания КПТ, понимание когнитивной модели и генерацию терапевтических ответов. Эксперименты показали, что языковые модели хорошо справляются с воспроизведением знаний КПТ, но испытывают трудности в сложных сценариях, требующих глубокого анализа когнитивных структур пациентов. Результаты указывают на потенциальные направления для будущих исследований в области применения ИИ в психотерапии.', 'emoji': '🧠', 'title': 'Оценка потенциала ИИ в когнитивно-поведенческой терапии', 'categories': ['#benchmark', '#nlp', '#medicine'], 'embedding': [-0.025578980649462672, -0.028054364371478905, 0.1278294073180521, 0.04539515770985954, -0.023575096756998575, 0.0014660762675723612, 0.064229033504388, 0.054903777760467426, -0.044399765356553614, 0.12080927624912374, 0.017340793338380633, -0.1329635491917903, 0.013228248263463896, -0.019252995077501067, -0.030700013214330208, -0.029390286966454966, 0.08733263650564549, -0.003683608691128205, -0.05715651176586169, 0.054589443865898105, 0.05621350603294635, 0.07077767486678263, -0.0025867120221534858, -0.0479360292627223, 0.038741743106683726, -0.04646913303065686, 0.014184349133024113, -0.043640123930325604, -0.012946657069555627, 0.03206213013180341, 0.09623877904040451, -0.026548178680271456, -0.1449082655298761, 0.004937673117229059, -0.021400949768303094, 0.11127445377760396, 0.03580795064255287, 0.09398605110882129, 0.09367171923885566, 0.01635849814632328, -0.049376729147686906, -0.049193366865603265, 0.007308280156637854, 0.010209327288122872, -0.08759457973061685, 0.004662630301484706, 0.07193024125348611, -0.01044507740535931, -0.07800737266331018, 0.026115968309861334, -0.07135395806013436, 0.091523768597261, 0.008873404693146807, -0.03515309055552077, 0.0010281360662688151, 0.03350283001676802, 0.003552636066340681, 0.04628577277317691, 0.05346307990010651, 0.05157707045887952, 0.009809859820834172, -0.032978941542221606, -0.028918785112299145, 0.02839489258854536, -0.17864684647372203, -0.05930446645666372, -0.030071345425191565, -0.03599131494924019, 0.03929182792833096, 0.0009184464803554908, 0.026928000405687304, 0.02235705063786331, 0.00017752947984671366, 0.0352316714984085, 0.017733712225045047, -0.002431181764489067, 0.09786284323205642, 0.08073160852286027, -0.02944267561144924, -0.043273401390762016, 0.0021184843570796193, -0.07633092590047504, -0.014799921785517872, -0.04222561836785813, 0.03701289960043956, 0.020890154405797882, -0.0069153616748941745, 0.06176675301743138, -0.11399868761255036, -0.09791522985244702, 0.025565881463610416, -0.07465447508843251, -0.09388127179422907, 0.06779149983146855, 0.13034408657302138, -0.0012573384127224432, 0.03030709432766579, 0.006011649450328231, 0.04123022398994852, 0.09210004369219799, -0.015428590384497986, 0.05521811570424412, 0.0059461630367042845, -0.05804712682917906, 0.09534817005089818, -0.008938890499389647, 0.05731367567624082, -0.07821692926789095, -0.06380993041824487, 0.05270343644927481, -0.16387311293689025, 0.05220574027262185, -0.028971173757293415, -0.03510069583671544, 0.032376464026372724, -0.10991234090933814, -0.05694695516128091, -0.024950310835720343, -0.05453705522090383, 0.016712123524638304, 0.038008293978349164, 0.09812479050623517, 0.047595496996448466, -0.05878057393290993, 0.0059134199311224964, -0.014642754230852106, 0.08879953273771092, -0.05809951344956965, 0.030228513384778073, -0.026797026768597933, -0.04707161054650574, 0.06328603789449108, 0.08879953273771092, -0.010870738992684776, -0.12510518158152042, 0.020261484592055554, -0.13243965261882915, 0.04123022398994852, -0.05631828737214227, -0.10153008077531449, 0.051839017733058254, -0.0008586901608234496, 0.003366000000095821, 0.007884560110623696, -0.09843912035159712, -0.018755298900848105, 0.007799427752666529, 0.016620443395898327, -0.07748348621336745, 0.05841384936874266, -0.022854744789912586, -0.06270975470113935, -0.032586020630953505, 0.03819165828503649, -0.0626049774111508, -0.08046965922407785, 0.0212044883003672, 0.061400026428660416, 0.06202869826700643, -0.10959800296556145, 0.09854390574000041, 0.010451625783523223, 0.05134131953180161, 0.01363426431137688, 0.10042990910741634, 0.1069785464206036, -0.032009741486809136, 0.10310175429736845, -0.055270504349238386, -0.07124917672093846, -0.010248618164487468, -0.030411873642258024, -0.06370514705444526, -0.07931710093578911, -0.0050359028388951635, -0.03287416222762938, 0.05464183251089238, -0.042880480479493915, -0.013241345424712463, -0.043587733260727644, -0.0801553293787159, 0.128458067008776, -0.055427670284221214, 0.029495064256443514, -0.04474029357362007, 0.01487850475300928, -0.0718254578896865, 0.028159143686071135, -0.04088969577288207, -0.00489838082364188, -0.00672545101464662, 0.014236738790320228, 0.16303488449396344, 0.14480347406766175, 0.10042990910741634, -0.029626036881231037, 0.11536080453002356, 0.06124286251828128, -0.0199602478587348, -0.015232132155927992, -0.007301731171092832, 0.02218678551702824, 0.0005337139977136653, -0.15863419782237084, 0.08565618366899927, -0.0103337501175239, 0.017314599015883496, 0.029049756724784825, -0.061923918952414204, -0.018113533950460895, 0.07575464473172698, -0.0564754512825214, 0.11850414752492415, 0.060037911535790904, -0.08780413835980132, 0.02658747016401716, -0.0834034537128124, -0.0067647427008526925, -0.007249342121177823, 0.060561802034941, 0.0007547305070337354, 0.06711044339733563, 0.04437357103405648, 0.015821510485924617, -0.042278007012852406, 0.040680139168301294, 0.049193366865603265, -0.08796130227018044, 0.06506726599652216, -0.12416217382400141, 0.04845992178647608, -0.032795579260137965, -0.051943792998443115, -0.060561802034941, -0.0026505611387760844, -0.007380314948425715, 0.009790213269119845, -0.009285968309382232, 0.04660010869234992, -0.10682138048562077, 0.1263625171597977, 0.005618731373505291, 0.037929711010857764, -0.07748348621336745, 0.0025130397309039076, 0.04398065214739206, -0.05050309513808219, -0.12468606837235888, 0.09115703795928266, -0.05469422318049033, -0.03381716796054471, -0.07999815736992202, -0.05532289299423266, -0.05961880035123304, -0.05689456651628664, 0.04476648789611721]}}, {'id': 'https://huggingface.co/papers/2410.14745', 'title': 'SemiEvol: Semi-supervised Fine-tuning for LLM Adaptation', 'url': 'https://huggingface.co/papers/2410.14745', 'abstract': 'Supervised fine-tuning (SFT) is crucial in adapting large language models (LLMs) to a specific domain or task. However, only a limited amount of labeled data is available in practical applications, which poses a severe challenge for SFT in yielding satisfactory results. Therefore, a data-efficient framework that can fully exploit labeled and unlabeled data for LLM fine-tuning is highly anticipated. Towards this end, we introduce a semi-supervised fine-tuning framework named SemiEvol for LLM adaptation from a propagate-and-select manner. For knowledge propagation, SemiEvol adopts a bi-level approach, propagating knowledge from labeled data to unlabeled data through both in-weight and in-context methods. For knowledge selection, SemiEvol incorporates a collaborative learning mechanism, selecting higher-quality pseudo-response samples. We conducted experiments using GPT-4o-mini and Llama-3.1 on seven general or domain-specific datasets, demonstrating significant improvements in model performance on target data. Furthermore, we compared SemiEvol with SFT and self-evolution methods, highlighting its practicality in hybrid data scenarios.', 'score': 1, 'issue_id': 207, 'pub_date': '2024-10-17', 'pub_date_ru': '17 октября', 'hash': '863b95d8e45c3aa2', 'data': {'desc': 'Статья представляет новый полу-контролируемый метод тонкой настройки больших языковых моделей под названием SemiEvol. Этот подход эффективно использует как размеченные, так и неразмеченные данные для адаптации модели к конкретной задаче или домену. SemiEvol применяет двухуровневый метод распространения знаний и механизм совместного обучения для отбора высококачественных псевдо-ответов. Эксперименты на семи наборах данных показали значительное улучшение производительности модели по сравнению с традиционными методами тонкой настройки.', 'emoji': '🧠', 'title': 'SemiEvol: эффективная полу-контролируемая настройка языковых моделей', 'categories': ['#nlp', '#training', '#dataset'], 'embedding': [0.02396001414792346, -0.06013493568530362, 0.13936677064213313, -0.04065710826490381, -0.003498136610833921, 0.04657409995300698, -0.008526311046590546, 0.037889071325759756, -0.07201971278985864, 0.08999924929267838, 0.020849147457884663, -0.0514499070580564, -0.10472824358984163, 0.012989451159889321, 0.007739071532226059, -0.01890644553614779, 0.03735578266995749, -0.0992937509648156, -0.04350132959313559, 0.049012004539437576, 0.015249590103970135, -0.0343337977671877, 0.07725104911179587, 0.07653999067802027, 0.050738848624280804, -0.08217764374175866, 0.00015603926813809462, 0.12209829464090076, 0.03517182397934085, -0.03555274799259123, 0.11559722677208194, -0.05729071435707185, -0.11102615515557164, -0.03687328153906859, -0.03367353306176079, 0.11661301655877312, 0.08248237509467424, 0.07780973049614893, -0.015109918310413625, 0.05327833239616169, -0.09172608924189808, -0.13875729552943136, -0.005688439968308244, 0.06653443263991923, -0.0481231866667475, -0.03288629230670924, 0.005015476830794161, 0.11905091287395664, -0.004542498593455347, 0.03529880002896549, -0.008215225101320786, -0.031438786846230776, 0.016024132220153333, -0.02573765196111537, 0.00080747594748253, -0.021826849185655514, -0.006602653257704421, 0.010888028969340475, -0.027756539305845852, -0.038981049637162195, -0.029077068716699676, -0.03476550930535145, -0.02030315830218345, -0.02717245898950666, -0.06506152617964288, -0.05657966212673156, -0.18284269923547086, 0.025382124812039344, -0.016659001922436495, 0.05000240159757794, -0.01155464371793568, -0.07323866715088571, -0.003596541498434187, -0.02628363904900482, -0.020734870874253082, 0.02788351328765872, 0.04672646873118242, 0.09086266823338235, -0.03598446159856675, -0.05045950793210426, 0.028696148839072844, 0.006072536418378051, -0.05155148831131847, -0.025382124812039344, -0.005075789523850567, -0.06404573846076349, -0.0941132063034153, -0.029000884327611956, -0.05845887912537377, -0.10858825470476458, -0.024506003303624672, 0.005177369329644394, -0.04512659656034029, 0.013370373725671457, 0.05637650168801921, 0.003723515687028232, -0.01883026114706007, -0.09787164030069971, 0.04951990046668905, 0.11468301203521752, -0.06389336761477626, 0.032276817194007476, 0.031362602457143056, -0.10980720906579165, 0.10168086595852105, -0.08888187618491337, 0.012424416010306765, -0.011440367134304099, 0.04682804791663271, -0.05642729334855612, -0.08832318859712499, -0.03773670461539609, -0.024201263679462022, 0.05183082900349501, 0.041749086576306244, -0.16303473739454583, -0.045278965338515734, 0.06765180574768424, -0.016341566967904328, 0.006513771677216591, 0.00810729649304573, 0.010557896823408196, 0.02526784719450188, 0.023083892639508788, 0.07262918997037218, 0.013903664035723146, -0.012792641591469965, -0.0665852201648326, 0.010316645844401394, -0.03166734208130571, 0.08578370275743233, -0.01681137173451782, 0.08994845349651794, -0.01870328509743543, -0.13784309526724936, 0.04131737090251895, -0.18284269923547086, 0.02349020938130996, -0.0649091594692792, -0.04014921233765235, -0.009580196336324408, -0.04063171553635301, -0.049088188928525296, 0.0539385971015886, 0.004459965401886395, -0.04672646873118242, 0.019503222216762383, 0.012284744216750257, -0.03501945933678896, 0.12148882159601077, -0.02564876913994048, -0.10041111993695706, -0.056935189275807596, 0.10838509840167576, -0.021623690814754924, 0.006843904443492401, -0.13885888505394053, 0.031845105655843725, 0.0941132063034153, -0.018462033498085097, -0.034409982156275415, 0.07247682326000851, 0.06521389702563009, -0.02319816818923448, 0.034663930119901154, 0.05101819551989265, -0.007008970413067951, 0.05099280279134185, -0.1570415778598491, 0.0014490919890599425, 0.020709476077890508, -0.014157612412911233, 0.003894930459085015, -0.041901455354481684, -0.09304662899181074, 0.010532502647389154, -0.0009158007484929565, -0.0680073308289485, -0.1215903987136493, -0.015884460633378002, -0.10411876847713987, 0.05414175754030096, -0.12118408817528344, 0.04286645761625948, -0.06399494680022656, -0.018855653875610872, 0.004380606714948648, 0.07552419882351732, 0.08669791956210852, -0.031718129606219087, -0.05820493116174803, 0.032175238008557185, 0.14698521988996402, 0.0818221124570591, -0.0011816528149920602, 0.03981907998493889, 0.09990322814532913, 0.0680073308289485, 0.04695502189844558, 0.04284106075208513, -0.04355211711804896, 0.002936276172663745, -0.04555831016631581, -0.08756134057062424, 0.024493303837631614, -0.01716689888359385, -0.049494505670326476, -0.01288787197443903, -0.014284587221848812, -0.08938977211216485, 0.11072141553140899, 0.09045634942376939, 0.10325534540081237, 0.03969210393531425, -0.056020976606754945, -0.009250063156486245, -0.061557046349419504, -0.109502469441629, 0.09446872931686778, 0.0604396732416545, 0.02115388604814143, -0.026461404691354603, 0.04243474401028396, 0.03966671120676345, -0.0680581162860501, -0.020912634448791097, -0.0220300075565561, -0.09924295723646691, -0.02406159333337375, -0.12219988002978636, 0.055411499426241406, -0.07831762642340041, -0.020658686485165362, -0.025712256130846916, -0.04360290671077411, -0.1122451095165987, 0.014195704814236272, -0.03697485865670711, 0.0440600151131122, -0.04131737090251895, 0.01314181952450241, 0.021788755957205766, -0.04682804791663271, -0.014056033227460941, -0.018423942337447125, 0.04352672232168639, -0.006666140455392032, -0.08705344877899632, 0.07948579119170233, 0.1021379702252356, 0.06424889683166407, -0.09863348419157691, -0.030676942955353576, -0.05363386368086127, -0.008729469417491136, 0.02686772143315578]}}];
        const articlesContainer = document.getElementById('articles-container');
        const sortDropdown = document.getElementById('sort-dropdown');
        const categoryFiltersContainer = document.getElementById('category-filters');
        const categoryToggle = document.getElementById('category-toggle');
        const clearCategoriesButton = document.getElementById('clear-categories');
        let selectedCategories = [];
        let selectedArticles = [];
        let sortBy = 'issue_id';     

        function getUrlParameters() {
            const urlParams = new URLSearchParams(window.location.search);
            const categoriesParam = urlParams.get('cat');
            let categories = categoriesParam ? categoriesParam.split(',') : [];
            categories = categories.map(element => `#${element}`);
            return categories
        }

        function updateUrlWithCategories() {
            let cleanedCategories = selectedCategories.map(element => element.replace(/^#/, ''));
            const newUrl = cleanedCategories.length > 0 
                ? `${window.location.pathname}?cat=${cleanedCategories.join(',')}`
                : window.location.pathname;
            console.log("cleanedCategories", cleanedCategories)
            window.history.pushState({}, '', newUrl);
        }

        function loadSettings() {
            const isDarkMode = localStorage.getItem('darkMode') === 'true';
            const themeToggle = document.getElementById('theme-toggle');
            let settingSortBy = localStorage.getItem('sort_by');
            const sortDropdown = document.getElementById('sort-dropdown');
            
            if (isDarkMode) {
                document.body.classList.remove('light-theme');
                document.body.classList.add('dark-theme');
                themeToggle.checked = true;
                const title = document.getElementById('doomgrad');
                title.innerHTML = "хф найтли";
                const titleSign = document.getElementById('doomgrad-icon');
                titleSign.classList.add('rotate');
            }

            if ((!settingSortBy) || (settingSortBy === 'null')) {
                settingSortBy = 'issue_id';
            }
            
            sortDropdown.value = settingSortBy;
            sortBy = settingSortBy;
        }

        document.getElementById('theme-toggle').addEventListener('change', toggleTheme);

        function getUniqueCategories(articles) {
            const categories = new Set();
            articles.forEach(article => {
                if (article.data && article.data.categories) {
                    article.data.categories.forEach(cat => categories.add(cat));
                }
            });
            let res = Array.from(categories);
            res.sort();
            return res;
        }
        
        function createCategoryButtons() {
            const categories = getUniqueCategories(articlesData);
            categories.forEach(category => {
                const button = document.createElement('span');
                button.textContent = category;
                button.className = 'category-button';
                button.onclick = () => toggleCategory(category, button);
                categoryFiltersContainer.appendChild(button);
            });
        }

        function toggleCategory(category, button) {
            const index = selectedCategories.indexOf(category);
            if (index === -1) {
                selectedCategories.push(category);
                button.classList.add('active');
            } else {
                selectedCategories.splice(index, 1);
                button.classList.remove('active');
            }         
            filterAndRenderArticles();
            saveCategorySelection();
            updateSelectedArticlesTitle();
            updateUrlWithCategories();
        }

        function saveCategorySelection() {
            localStorage.setItem('selectedCategories', JSON.stringify(selectedCategories));
        }

        function updateSelectedArticlesTitle() {
            if (selectedArticles.length === articlesData.length) {
                categoryToggle.textContent = '🏷️ Фильтр';
            } else {
                categoryToggle.textContent = `🏷️ Фильтр (${formatArticlesTitle(selectedArticles.length)})`;
            }
        }

        function cleanCategorySelection() {
            localStorage.setItem('selectedCategories', JSON.stringify('[]'));
        }

        function loadCategorySelection() {
            const urlCategories = getUrlParameters();
            if (urlCategories.length > 0) {
                selectedCategories = urlCategories;
                saveCategorySelection();
            } else {
                const savedCategories = localStorage.getItem('selectedCategories');
                if (savedCategories && savedCategories !== '"[]"') {
                    selectedCategories = JSON.parse(savedCategories);                    
                }
            }
            updateCategoryButtonStates();
        }

        function updateCategoryButtonStates() {
            const buttons = categoryFiltersContainer.getElementsByClassName('category-button');
            Array.from(buttons).forEach(button => {
                if (selectedCategories.includes(button.textContent)) {
                    button.classList.add('active');
                } else {
                    button.classList.remove('active');
                }
            });
        }

        function filterAndRenderArticles() {
            console.log(selectedCategories);
            let filteredArticles = selectedCategories.length === 0
                ? articlesData
                : articlesData.filter(article => 
                    article.data && article.data.categories && 
                    article.data.categories.some(cat => selectedCategories.includes(cat))
                );

            console.log('filteredArticles', filteredArticles)

            if (filteredArticles.length === 0) {
                selectedArticles = articlesData;
                selectedCategories = [];
                cleanCategorySelection();
            } else {
                selectedArticles = filteredArticles;
            }

            console.log('selectedArticles', selectedArticles)

            sortArticles(selectedArticles);
        }

        function clearAllCategories() {
            selectedCategories = [];
            updateCategoryButtonStates();
            filterAndRenderArticles();
            saveCategorySelection();
            updateSelectedArticlesTitle();
            updateUrlWithCategories();
        }

        function renderArticles(articles) {
            console.log(articles);
            articlesContainer.innerHTML = '';
            articles.forEach((item, index) => {
                if ("error" in item) {
                    console.log(`Omitting JSON. ${item["raw_data"]}`);
                    return;
                }
                const explanation = item["data"]["desc"];
                const cats = item["data"]["categories"].join(" ");
                const articleHTML = `
                    <article class='x${item["hash"]}'>
                        <div class="background-digit">${index + 1}</div>
                        <div class="article-content" onclick="toggleAbstract(${index})">
                            <h2>${item['data']['emoji']} ${item['title']}</h2>
                            <p class="meta"><svg class="text-sm peer-checked:text-gray-500 group-hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 12 12"><path transform="translate(0, 2)" fill="currentColor" d="M5.19 2.67a.94.94 0 0 1 1.62 0l3.31 5.72a.94.94 0 0 1-.82 1.4H2.7a.94.94 0 0 1-.82-1.4l3.31-5.7v-.02Z"></path></svg> ${item['score']}. ${item['data']['title']}</p>
                            <p class="pub-date">📅 Статья от ${item['pub_date_ru']}</p>
                            <div id="abstract-${index}" class="abstract">
                                <p>${explanation}</p>
                                <div id="toggle-${index}" class="abstract-toggle">...</div>
                            </div>
                            <div class="links">
                                <a href="${item['url']}" target="_blank">Статья</a>
                            </div>
                            <p class="tags">${cats}</p>
                        </div>
                    </article>
                `;
                articlesContainer.innerHTML += articleHTML;
            });
        }
        
        function sortArticles() {
            let sortedArticles = [...selectedArticles];
            if (sortBy === 'issue_id') {
                sortedArticles.sort((a, b) => b.issue_id - a.issue_id);
            }
            if (sortBy === 'pub_date') {
                sortedArticles.sort((a, b) => b.pub_date.localeCompare(a.pub_date));
            }
            renderArticles(sortedArticles);
            localStorage.setItem('sort_by', sortBy);
        }
        
        sortDropdown.addEventListener('change', (event) => {
            sortBy = event.target.value;
            sortArticles(event.target.value);
        });

        categoryToggle.addEventListener('click', () => {
            categoryFiltersContainer.classList.toggle('expanded');
        });

        clearCategoriesButton.addEventListener('click', clearAllCategories);
        
        function updateTimeDiffs() {
            const timeDiff = document.getElementById('timeDiff');
            timeDiff.innerHTML = '🔄 ' + getTimeDiffRu('2024-10-22 02:46');
        } 

        loadSettings();
        createCategoryButtons();
        loadCategorySelection();
        filterAndRenderArticles();
        updateSelectedArticlesTitle();
        updateTimeDiffs();  
    </script>
</body>
</html>
    