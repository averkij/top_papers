[
    {
        "header": "Abstract",
        "images": [
            {
                "img": "https://arxiv.org/html/2508.04010/icon.png",
                "caption": "",
                "position": 54
            }
        ]
    },
    {
        "header": "1Introduction",
        "images": [
            {
                "img": "https://arxiv.org/html/2508.04010/x1.png",
                "caption": "Figure 1:The results indicate thatHarmonyGuardachieves superior performance in terms of both utility and safety.",
                "position": 92
            }
        ]
    },
    {
        "header": "2Related Works",
        "images": [
            {
                "img": "https://arxiv.org/html/2508.04010/x2.png",
                "caption": "Figure 2:The workflow ofHarmonyGuardconsists of three stages: (1)Policy Enhancement(Top Center): The Policy Agent First extracts text from external documents and uses a LLM-based approach to identify, refine, and de-duplicate potential security policies. These are then converted into structured data and stored in a policy database for future use. (2)Dual-Objective Optimization(Bottom Right): During the web agent’s reasoning phase, the Utility Agent constructs contextual states based on a second-order Markovian evaluation strategy, and evaluates the reasoning process from two perspectives: safety and utility. If a policy violation or goal deviation is detected, the Utility Agent provides optimization suggestions and builds metacognitive capabilities to enhance the web agent’s alignment and self-correction. (3)Policy Update(Top Right): Once a violation is confirmed, a Violation Reference is generated and sent to the Policy Agent. The Policy Agent then compares this Violation Reference against the corresponding policy queue in the database for the relevant violation category using a similarity-based threshold. If the similarity is below the defined threshold, the case is added to the queue.",
                "position": 139
            }
        ]
    },
    {
        "header": "3HarmonyGuard",
        "images": [
            {
                "img": "https://arxiv.org/html/2508.04010/x3.png",
                "caption": "Figure 3:Structure of extracted policies.",
                "position": 172
            },
            {
                "img": "https://arxiv.org/html/2508.04010/x4.png",
                "caption": "Figure 4:The content of the optimization guidance includes reflection.",
                "position": 266
            }
        ]
    },
    {
        "header": "4Experiments",
        "images": [
            {
                "img": "https://arxiv.org/html/2508.04010/x5.png",
                "caption": "Figure 5:Utility gap of different guardrails. The numbers on top of bars indicate the violation betweenCompletionandCuP(v​i​o​l​a​t​i​o​n=C​o​m​p​l​e​t​i​o​n−C​u​Pviolation=Completion-CuP). The red star indicates the minimum violation of the current category.",
                "position": 495
            },
            {
                "img": "https://arxiv.org/html/2508.04010/x6.png",
                "caption": "Figure 6:Pareto front comparison of all guardrail methods.",
                "position": 508
            },
            {
                "img": "https://arxiv.org/html/2508.04010/x7.png",
                "caption": "Table 3:Performance ofHarmonyGuardacross rounds on theWASPBenchmark.",
                "position": 606
            },
            {
                "img": "https://arxiv.org/html/2508.04010/x7.png",
                "caption": "Figure 7:Performance trends across rounds. Red star denotes best result.",
                "position": 681
            }
        ]
    },
    {
        "header": "5Conclusion",
        "images": []
    },
    {
        "header": "References",
        "images": []
    },
    {
        "header": "Appendix ACase Study",
        "images": [
            {
                "img": "https://arxiv.org/html/2508.04010/x8.png",
                "caption": "Figure 8:During the reasoning stage of the Web Agent, the Utility Agent checks the safety and utility of the reasoning content.",
                "position": 1141
            }
        ]
    },
    {
        "header": "Appendix BMore Defense Exploration",
        "images": []
    },
    {
        "header": "Appendix CMetric Calculation Formulas",
        "images": []
    },
    {
        "header": "Appendix DAdditional Results",
        "images": [
            {
                "img": "https://arxiv.org/html/2508.04010/x9.png",
                "caption": "Figure 9:Prompt template of the Policy Agent.",
                "position": 1273
            },
            {
                "img": "https://arxiv.org/html/2508.04010/x10.png",
                "caption": "Figure 10:Prompt template of the Utlity Agent.",
                "position": 1289
            }
        ]
    },
    {
        "header": "Appendix EPrompt Templates",
        "images": []
    }
]