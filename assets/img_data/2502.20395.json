[
    {
        "header": "Abstract",
        "images": []
    },
    {
        "header": "1Introduction",
        "images": [
            {
                "img": "https://arxiv.org/html/2502.20395/extracted/6189153/fig/radar.png",
                "caption": "Figure 1:R2-T2 applied to MoAI-7B compared against 7/8/13B VLMs on 9 benchmarks. R2-T2 significantly enhances performance of the 7B base MoE model, surpassing a recent 13B VLM.",
                "position": 113
            },
            {
                "img": "https://arxiv.org/html/2502.20395/extracted/6189153/fig/example.png",
                "caption": "Figure 2:An example of how R2-T2 optimizes the routing weights. Given the test sample, it findskğ‘˜kitalic_kNN in the reference set of correctly predicted samples with similar questions. In the example, the test sample requires reasoning about positional relationships.\nR2-T2 identifies relevant kNN samples, adjusting the top-1 expert fromğˆlangsubscriptğˆlang\\mathbf{I}_{\\textsc{lang}}bold_I start_POSTSUBSCRIPT lang end_POSTSUBSCRIPT(aligning visual features with language) toğˆauxsubscriptğˆaux\\mathbf{I}_{\\textsc{aux}}bold_I start_POSTSUBSCRIPT aux end_POSTSUBSCRIPT(aligning visual features with auxiliary computer vision features).\nThis expert shift is crucial in correcting the initial wrong answer.",
                "position": 122
            }
        ]
    },
    {
        "header": "2Related Work",
        "images": []
    },
    {
        "header": "3Test-Time Re-Routing",
        "images": [
            {
                "img": "https://arxiv.org/html/2502.20395/extracted/6189153/fig/method.png",
                "caption": "Figure 3:Illustration of R2-T2â€™ test-time re-routing mechanism with three strategies. (a) Neighborhood Gradient Descent: Optimizesrğ‘Ÿritalic_rusing gradients derived from neighborsâ€™ loss functions (âˆ‡rl1subscriptâˆ‡ğ‘Ÿsubscriptğ‘™1\\nabla_{r}l_{1}âˆ‡ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT italic_l start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT,âˆ‡rl2subscriptâˆ‡ğ‘Ÿsubscriptğ‘™2\\nabla_{r}l_{2}âˆ‡ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT italic_l start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT, andâˆ‡rl3subscriptâˆ‡ğ‘Ÿsubscriptğ‘™3\\nabla_{r}l_{3}âˆ‡ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT italic_l start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPTfor the 3 nearest neighbors), weighted by their similarity to the test sample. (b) Kernel Regression: Estimatesrğ‘Ÿritalic_ras a weighted average of neighborsâ€™ routing weights (r^^ğ‘Ÿ\\hat{r}over^ start_ARG italic_r end_ARG), and further optimizes it through binary search betweenr^^ğ‘Ÿ\\hat{r}over^ start_ARG italic_r end_ARGand initial weightsrğ‘Ÿritalic_rto find the optimal coefficientÎ±ğ›¼\\alphaitalic_Î±. (c) Mode Finding: Iteratively updatesrğ‘Ÿritalic_rthrough weighted interpolation between currecnt weights and the local averagerÂ¯Â¯ğ‘Ÿ\\bar{r}overÂ¯ start_ARG italic_r end_ARGin routing weight space, shifting towards the densest region.",
                "position": 212
            }
        ]
    },
    {
        "header": "4Experiments",
        "images": [
            {
                "img": "https://arxiv.org/html/2502.20395/extracted/6189153/fig/final.png",
                "caption": "Figure 4:Top-1 expert transitions to correct/incorrect preditions on CVBench2D/3Dafter re-routing. The primary transitions to correct predictions in (a) includeğˆLANGsubscriptğˆLANG\\mathbf{I}_{\\textsc{LANG}}bold_I start_POSTSUBSCRIPT LANG end_POSTSUBSCRIPTtoğ‹IMGsubscriptğ‹IMG\\mathbf{L}_{\\textsc{IMG}}bold_L start_POSTSUBSCRIPT IMG end_POSTSUBSCRIPT,ğ‹AUXsubscriptğ‹AUX\\mathbf{L}_{\\textsc{AUX}}bold_L start_POSTSUBSCRIPT AUX end_POSTSUBSCRIPTandğ‹AUXsubscriptğ‹AUX\\mathbf{L}_{\\textsc{AUX}}bold_L start_POSTSUBSCRIPT AUX end_POSTSUBSCRIPT. The primary transitions to incorrect predictions in (b) includeğˆLANGsubscriptğˆLANG\\mathbf{I}_{\\textsc{LANG}}bold_I start_POSTSUBSCRIPT LANG end_POSTSUBSCRIPTtoğˆAUXsubscriptğˆAUX\\mathbf{I}_{\\textsc{AUX}}bold_I start_POSTSUBSCRIPT AUX end_POSTSUBSCRIPT,ğ‹IMGsubscriptğ‹IMG\\mathbf{L}_{\\textsc{IMG}}bold_L start_POSTSUBSCRIPT IMG end_POSTSUBSCRIPTandğ‹AUXsubscriptğ‹AUX\\mathbf{L}_{\\textsc{AUX}}bold_L start_POSTSUBSCRIPT AUX end_POSTSUBSCRIPT.R2-T2 considerably mitigates themobility imbalanceof the base model.",
                "position": 1226
            },
            {
                "img": "https://arxiv.org/html/2502.20395/extracted/6189153/fig/transition_diagram.png",
                "caption": "Figure 5:Transition between correct and incorrect predictions on CVBench2D/3Dduring NGD steps of R2-T2 from Step 0 to 10.NGD keeps turning more incorrect predictions to correct.",
                "position": 1232
            }
        ]
    },
    {
        "header": "5Conclusions",
        "images": []
    },
    {
        "header": "References",
        "images": []
    },
    {
        "header": "Appendix AMoAI Experts",
        "images": []
    },
    {
        "header": "Appendix BEvaluation Benchmarks and Reference Datasets",
        "images": []
    },
    {
        "header": "Appendix CHyperparameter Choices",
        "images": []
    },
    {
        "header": "Appendix DAdditional Analysis",
        "images": [
            {
                "img": "https://arxiv.org/html/2502.20395/extracted/6189153/fig/hat.png",
                "caption": "Figure 6:Example for transition fromğˆlangsubscriptğˆlang\\mathbf{I}_{\\textsc{lang}}bold_I start_POSTSUBSCRIPT lang end_POSTSUBSCRIPTtoğˆauxsubscriptğˆaux\\mathbf{I}_{\\textsc{aux}}bold_I start_POSTSUBSCRIPT aux end_POSTSUBSCRIPTusing R2-T2. The model initially gives incorrect answer â€œ(C)2\" by relying onğˆlangsubscriptğˆlang\\mathbf{I}_{\\textsc{lang}}bold_I start_POSTSUBSCRIPT lang end_POSTSUBSCRIPT. Afterkğ‘˜kitalic_kNN retrieval with similar questions about counting hats , it re-routes toğˆauxsubscriptğˆaux\\mathbf{I}_{\\textsc{aux}}bold_I start_POSTSUBSCRIPT aux end_POSTSUBSCRIPTand correctly answers â€œ(D) 1\" for the number of hats in the image.",
                "position": 2791
            },
            {
                "img": "https://arxiv.org/html/2502.20395/extracted/6189153/fig/plane.png",
                "caption": "Figure 7:Example of routing transition fromğˆLANGsubscriptğˆLANG\\mathbf{I}_{\\textsc{LANG}}bold_I start_POSTSUBSCRIPT LANG end_POSTSUBSCRIPTtoğ‹AUXsubscriptğ‹AUX\\mathbf{L}_{\\textsc{AUX}}bold_L start_POSTSUBSCRIPT AUX end_POSTSUBSCRIPTusing R2-T2. Initially, the model selectsğˆLANGsubscriptğˆLANG\\mathbf{I}_{\\textsc{LANG}}bold_I start_POSTSUBSCRIPT LANG end_POSTSUBSCRIPT, misidentifying the plane number. By retrievingkğ‘˜kitalic_kNN with similar queries, R2-T2 shifts the routing weights towardsğ‹AUXsubscriptğ‹AUX\\mathbf{L}_{\\textsc{AUX}}bold_L start_POSTSUBSCRIPT AUX end_POSTSUBSCRIPT, leading to the correct answer.",
                "position": 2796
            },
            {
                "img": "https://arxiv.org/html/2502.20395/extracted/6189153/fig/plate.png",
                "caption": "Figure 8:Example for transition fromğˆlangsubscriptğˆlang\\mathbf{I}_{\\textsc{lang}}bold_I start_POSTSUBSCRIPT lang end_POSTSUBSCRIPTtoğ‹auxsubscriptğ‹aux\\mathbf{L}_{\\textsc{aux}}bold_L start_POSTSUBSCRIPT aux end_POSTSUBSCRIPTusing R2-T2. The model initially gives incorrect answer â€œFRENCH\" by relying onğˆlangsubscriptğˆlang\\mathbf{I}_{\\textsc{lang}}bold_I start_POSTSUBSCRIPT lang end_POSTSUBSCRIPT. Afterkğ‘˜kitalic_kNN retrieval with similar questions, it re-routes to LAUX and correctly identifies â€œCalifornia\" as the plateâ€™s state.",
                "position": 2801
            },
            {
                "img": "https://arxiv.org/html/2502.20395/extracted/6189153/fig/speaker.png",
                "caption": "Figure 9:Example of routing transition fromğˆLANGsubscriptğˆLANG\\mathbf{I}_{\\textsc{LANG}}bold_I start_POSTSUBSCRIPT LANG end_POSTSUBSCRIPTtoğ‹IMGsubscriptğ‹IMG\\mathbf{L}_{\\textsc{IMG}}bold_L start_POSTSUBSCRIPT IMG end_POSTSUBSCRIPTusing R2-T2. Initially, the model selectsğˆLANGsubscriptğˆLANG\\mathbf{I}_{\\textsc{LANG}}bold_I start_POSTSUBSCRIPT LANG end_POSTSUBSCRIPT, leading to the incorrect prediction â€œDVD Playerâ€ when asked which device is not illuminated. By retrievingkğ‘˜kitalic_kNN samples with similar illumination-related queries, R2-T2 shifts the routing weights towardsğ‹IMGsubscriptğ‹IMG\\mathbf{L}_{\\textsc{IMG}}bold_L start_POSTSUBSCRIPT IMG end_POSTSUBSCRIPT, enabling the correct answer â€œSpeaker.â€",
                "position": 2806
            },
            {
                "img": "https://arxiv.org/html/2502.20395/extracted/6189153/fig/shirt.png",
                "caption": "Figure 10:Example of routing transition fromğˆLANGsubscriptğˆLANG\\mathbf{I}_{\\textsc{LANG}}bold_I start_POSTSUBSCRIPT LANG end_POSTSUBSCRIPTtoğ‹IMGsubscriptğ‹IMG\\mathbf{L}_{\\textsc{IMG}}bold_L start_POSTSUBSCRIPT IMG end_POSTSUBSCRIPTusing R2-T2. Initially, the model selectsğˆLANGsubscriptğˆLANG\\mathbf{I}_{\\textsc{LANG}}bold_I start_POSTSUBSCRIPT LANG end_POSTSUBSCRIPT, leading to the incorrect prediction â€œNoâ€ when asked if the shirt is soft and white. By retrievingkğ‘˜kitalic_kNN samples with similar color-based queries, R2-T2 shifts the routing weights towardsğ‹IMGsubscriptğ‹IMG\\mathbf{L}_{\\textsc{IMG}}bold_L start_POSTSUBSCRIPT IMG end_POSTSUBSCRIPT, allowing the model to correctly answer â€œYes.â€",
                "position": 2811
            },
            {
                "img": "https://arxiv.org/html/2502.20395/extracted/6189153/fig/wrong2right.png",
                "caption": "Figure 11:Top-1 expert transitions from incorrect to correct predictions on CVBench2D/3Dafter re-routing. For transitions to incorrect predictions, the main patterns include transitions fromğˆLANGsubscriptğˆLANG\\mathbf{I}_{\\textsc{LANG}}bold_I start_POSTSUBSCRIPT LANG end_POSTSUBSCRIPTtoğˆIMGsubscriptğˆIMG\\mathbf{I}_{\\textsc{IMG}}bold_I start_POSTSUBSCRIPT IMG end_POSTSUBSCRIPT,ğ‹AUXsubscriptğ‹AUX\\mathbf{L}_{\\textsc{AUX}}bold_L start_POSTSUBSCRIPT AUX end_POSTSUBSCRIPTandğˆAUXsubscriptğˆAUX\\mathbf{I}_{\\textsc{AUX}}bold_I start_POSTSUBSCRIPT AUX end_POSTSUBSCRIPT",
                "position": 2826
            },
            {
                "img": "https://arxiv.org/html/2502.20395/extracted/6189153/fig/right2wrong.png",
                "caption": "Figure 12:Top-1 expert transitions from correct to incorrect predictions on CVBench2D/3Dafter re-routing. The visualization shows primary transitions fromğˆLANGsubscriptğˆLANG\\mathbf{I}_{\\textsc{LANG}}bold_I start_POSTSUBSCRIPT LANG end_POSTSUBSCRIPTtoğˆAUXsubscriptğˆAUX\\mathbf{I}_{\\textsc{AUX}}bold_I start_POSTSUBSCRIPT AUX end_POSTSUBSCRIPTandğ‹IMGsubscriptğ‹IMG\\mathbf{L}_{\\textsc{IMG}}bold_L start_POSTSUBSCRIPT IMG end_POSTSUBSCRIPT, demonstrating how correct predictions can shift to incorrect outcomes through these pathways.",
                "position": 2831
            },
            {
                "img": "https://arxiv.org/html/2502.20395/extracted/6189153/fig/right2right.png",
                "caption": "Figure 13:Top-1 expert transitions from correct to correct predictions on CVBench2D/3Dafter re-routing. The main transition patterns demonstrate consistent routing fromğˆLANGsubscriptğˆLANG\\mathbf{I}_{\\textsc{LANG}}bold_I start_POSTSUBSCRIPT LANG end_POSTSUBSCRIPTthroughğˆAUXsubscriptğˆAUX\\mathbf{I}_{\\textsc{AUX}}bold_I start_POSTSUBSCRIPT AUX end_POSTSUBSCRIPTtoğ‹IMGsubscriptğ‹IMG\\mathbf{L}_{\\textsc{IMG}}bold_L start_POSTSUBSCRIPT IMG end_POSTSUBSCRIPTandğˆAUXsubscriptğˆAUX\\mathbf{I}_{\\textsc{AUX}}bold_I start_POSTSUBSCRIPT AUX end_POSTSUBSCRIPT, showing stable pathways for maintaining correct predictions.",
                "position": 2836
            },
            {
                "img": "https://arxiv.org/html/2502.20395/extracted/6189153/fig/wrong2wrong.png",
                "caption": "Figure 14:Top-1 expert transitions from incorrect to incorrect predictions on CVBench2D/3Dafter re-routing. The visualization reveals persistent incorrect prediction patterns, with transitions primarily flowing fromğˆLANGsubscriptğˆLANG\\mathbf{I}_{\\textsc{LANG}}bold_I start_POSTSUBSCRIPT LANG end_POSTSUBSCRIPTthroughğˆAUXsubscriptğˆAUX\\mathbf{I}_{\\textsc{AUX}}bold_I start_POSTSUBSCRIPT AUX end_POSTSUBSCRIPTtoğ‹IMGsubscriptğ‹IMG\\mathbf{L}_{\\textsc{IMG}}bold_L start_POSTSUBSCRIPT IMG end_POSTSUBSCRIPTandğˆAUXsubscriptğˆAUX\\mathbf{I}_{\\textsc{AUX}}bold_I start_POSTSUBSCRIPT AUX end_POSTSUBSCRIPT, with additionalğˆSELFsubscriptğˆSELF\\mathbf{I}_{\\textsc{SELF}}bold_I start_POSTSUBSCRIPT SELF end_POSTSUBSCRIPTrouting observed.",
                "position": 2841
            }
        ]
    },
    {
        "header": "Appendix EExpert Transition Analysis",
        "images": []
    }
]