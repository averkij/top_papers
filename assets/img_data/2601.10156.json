[
    {
        "header": "Abstract",
        "images": []
    },
    {
        "header": "1Introduction",
        "images": [
            {
                "img": "https://arxiv.org/html/2601.10156/x1.png",
                "caption": "Figure 1:Illustration of two categories of tool invocation security risks considered in this study. (a)Malicious user requeststhat directly induce unsafe tool invocation. (b)Prompt injection attacksoccurring during benign task execution, leading to unintended tool use.",
                "position": 167
            }
        ]
    },
    {
        "header": "2Related Work",
        "images": [
            {
                "img": "https://arxiv.org/html/2601.10156/x2.png",
                "caption": "Figure 2:Illustration of our proactive step-level guardrail and feedback framework for LLM agents. (a) Input and output format of TS-Guard. (b) TS-Flow feeds guardrail feedback to the agent, enabling safe tool invocation reasoning rather than aborting execution.",
                "position": 359
            }
        ]
    },
    {
        "header": "3TS-Bench: Step-Level Tool Invocation Safety Detection Benchmark",
        "images": []
    },
    {
        "header": "4Method",
        "images": []
    },
    {
        "header": "5Experiments",
        "images": []
    },
    {
        "header": "6Analyses",
        "images": [
            {
                "img": "https://arxiv.org/html/2601.10156/x3.png",
                "caption": "Figure 3:Ablation results on training methods and reward designs. (a) Comparision of SFT, SFT+RL and RL only (b) Comparision of multi-task rewards and single-task rewards.",
                "position": 900
            },
            {
                "img": "https://arxiv.org/html/2601.10156/x4.png",
                "caption": "Figure 4:Entropy comparison of guardrails. (a) Specialized models show lower entropy than general LLMs. (b) TS-Guard lowers final-decision entropy while preserving reasoning-step entropy to facilitate exploration.",
                "position": 905
            },
            {
                "img": "https://arxiv.org/html/2601.10156/x5.png",
                "caption": "Figure 5:Token-wise entropy of a ReAct-style agent (Qwen2.5-14B-IT). Without guardrails, entropy decreases as the agent grows overconfident; with TS-Flow, TS-Guard feedback raises entropy in risky steps, maintaining uncertainty and guiding safe exploration..",
                "position": 910
            }
        ]
    },
    {
        "header": "7Conclusion",
        "images": []
    },
    {
        "header": "Limitations",
        "images": []
    },
    {
        "header": "Ethics Statement",
        "images": []
    },
    {
        "header": "References",
        "images": []
    },
    {
        "header": "Appendix ASource Dataset of TS-Bench",
        "images": [
            {
                "img": "https://arxiv.org/html/2601.10156/x6.png",
                "caption": "Figure 6:Illustration of TS-Bench Construction Pipeline.",
                "position": 1740
            },
            {
                "img": "https://arxiv.org/html/2601.10156/x7.png",
                "caption": "Figure 7:Prompt template for TS-Guard.",
                "position": 2490
            },
            {
                "img": "https://arxiv.org/html/2601.10156/x8.png",
                "caption": "Figure 8:Prompt template for ReAct-style LLM-based agents.",
                "position": 2495
            }
        ]
    },
    {
        "header": "Appendix BAnnotation Guidelines of TS-Bench",
        "images": []
    },
    {
        "header": "Appendix CExample in TS-Bench",
        "images": []
    },
    {
        "header": "Appendix DAnalysis of Data Leakage Risk",
        "images": []
    },
    {
        "header": "Appendix EEvaluation Details",
        "images": []
    },
    {
        "header": "Appendix FImplementation Details",
        "images": [
            {
                "img": "https://arxiv.org/html/2601.10156/x9.png",
                "caption": "Figure 9:Safe sample in AgentHarm-Traj.",
                "position": 2590
            },
            {
                "img": "https://arxiv.org/html/2601.10156/x10.png",
                "caption": "Figure 10:Controversial or potentially unsafe sample in AgentHarm-Traj.",
                "position": 2595
            },
            {
                "img": "https://arxiv.org/html/2601.10156/x11.png",
                "caption": "Figure 11:Significantly unsafe sample in AgentHarm-Traj.",
                "position": 2600
            },
            {
                "img": "https://arxiv.org/html/2601.10156/x12.png",
                "caption": "Figure 12:Significantly unsafe sample in ASB-Traj (direct prompt injection attacks).",
                "position": 2605
            },
            {
                "img": "https://arxiv.org/html/2601.10156/x13.png",
                "caption": "Figure 13:Safe sample in ASB-Traj (direct prompt injection attacks).",
                "position": 2610
            },
            {
                "img": "https://arxiv.org/html/2601.10156/x14.png",
                "caption": "Figure 14:controversial or potentially unsafe sample in ASB-Traj (direct prompt injection attacks).",
                "position": 2615
            },
            {
                "img": "https://arxiv.org/html/2601.10156/x15.png",
                "caption": "Figure 15:Significantly unsafe sample in ASB-Traj (indirect prompt injection attacks).",
                "position": 2620
            },
            {
                "img": "https://arxiv.org/html/2601.10156/x16.png",
                "caption": "Figure 16:Safe sample in ASB-Traj (indirect prompt injection attacks).",
                "position": 2625
            },
            {
                "img": "https://arxiv.org/html/2601.10156/x17.png",
                "caption": "Figure 17:controversial or potentially unsafe sample in ASB-Traj (indirect prompt injection attacks).",
                "position": 2630
            },
            {
                "img": "https://arxiv.org/html/2601.10156/x18.png",
                "caption": "Figure 18:Safe sample in AgentDojo-Traj.",
                "position": 2635
            },
            {
                "img": "https://arxiv.org/html/2601.10156/x19.png",
                "caption": "Figure 19:Significantly unsafe sample in AgentDojo-Traj.",
                "position": 2640
            }
        ]
    },
    {
        "header": "Appendix GSupplementary results of Guardrail Model Evaluation",
        "images": []
    },
    {
        "header": "Appendix HOverhead Analysis of TS-Flow",
        "images": []
    },
    {
        "header": "Appendix IComparison between Model-Based and Agent-Based Guardrails",
        "images": [
            {
                "img": "https://arxiv.org/html/2601.10156/x20.png",
                "caption": "Figure 20:ReAct trajectory in AgentHarm.",
                "position": 2692
            },
            {
                "img": "https://arxiv.org/html/2601.10156/x21.png",
                "caption": "Figure 21:ReAct+TS-Flow trajectory in AgentHarm.",
                "position": 2697
            },
            {
                "img": "https://arxiv.org/html/2601.10156/x22.png",
                "caption": "Figure 22:ReAct trajectory in ASB.",
                "position": 2702
            },
            {
                "img": "https://arxiv.org/html/2601.10156/x23.png",
                "caption": "Figure 23:ReAct+TS-Flow trajectory in ASB.",
                "position": 2707
            },
            {
                "img": "https://arxiv.org/html/2601.10156/x24.png",
                "caption": "Figure 24:ReAct trajectory in AgentDojo.",
                "position": 2712
            },
            {
                "img": "https://arxiv.org/html/2601.10156/x25.png",
                "caption": "Figure 25:ReAct+TS-Flow trajectory in AgentDojo.",
                "position": 2717
            }
        ]
    },
    {
        "header": "Appendix JPerformance on Auxiliary Safety Tasks",
        "images": []
    }
]