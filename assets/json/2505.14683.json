{
    "paper_title": "Emerging Properties in Unified Multimodal Pretraining",
    "authors": [
        "Chaorui Deng",
        "Deyao Zhu",
        "Kunchang Li",
        "Chenhui Gou",
        "Feng Li",
        "Zeyu Wang",
        "Shu Zhong",
        "Weihao Yu",
        "Xiaonan Nie",
        "Ziang Song",
        "Guang Shi",
        "Haoqi Fan"
    ],
    "sections": [
        {
            "title": "Abstract",
            "content": "Unifying multimodal understanding and generation has shown impressive capabilities in cutting-edge proprietary systems. In this work, we introduce BAGEL, an open0source foundational model that natively supports multimodal understanding and generation. BAGEL is a unified, decoder0only model pretrained on trillions of tokens curated from large0scale interleaved text, image, video, and web data. When scaled with such diverse multimodal interleaved data, BAGEL exhibits emerging capabilities in complex multimodal reasoning. As a result, it significantly outperforms open-source unified models in both multimodal generation and understanding across standard benchmarks, while exhibiting advanced multimodal reasoning abilities such as free-form image manipulation, future frame prediction, 3D manipulation, and world navigation. In the hope of facilitating further opportunities for multimodal research, we share the key findings, pretraining details, data creation protocal, and release our code and checkpoints to the community. The project page is at https://bagel-ai.org/"
        },
        {
            "title": "Start",
            "content": "5 2 0 2 0 2 ] . [ 1 3 8 6 4 1 . 5 0 5 2 : r a"
        },
        {
            "title": "Emerging Properties in Unified Multimodal Pretraining",
            "content": "Chaorui Deng1, Deyao Zhu1, Kunchang Li2, Chenhui Gou3, Feng Li4 Zeyu Wang5, Shu Zhong1, Weihao Yu1,Xiaonan Nie1, Ziang Song1, Guang Shi1 Haoqi Fan 1ByteDance Seed, 2Shenzhen Institutes of Advanced Technology, 3Monash University 4Hong Kong University of Science and Technology, 5UC Santa Cruz Equal contribution, Corresponding Author, Project lead"
        },
        {
            "title": "Abstract",
            "content": "Unifying multimodal understanding and generation has shown impressive capabilities in In this work, we introduce BAGEL, an open-source founcutting-edge proprietary systems. dational model that natively supports multimodal understanding and generation. BAGEL is unified, decoder-only model pretrained on trillions of tokens curated from large-scale interleaved text, image, video, and web data. When scaled with such diverse multimodal interleaved data, BAGEL exhibits emerging capabilities in complex multimodal reasoning. As result, it significantly outperforms open-source unified models in both multimodal generation and understanding across standard benchmarks, while exhibiting advanced multimodal reasoning abilities such as free-form image manipulation, future frame prediction, 3D manipulation, and world navigation. In the hope of facilitating further opportunities for multimodal research, we share the key findings, pretraining details, data creation protocal, and release our code and checkpoints to the community. Date: May 21, 2025 Project Page: https://bagel-ai.org/"
        },
        {
            "title": "Introduction",
            "content": "The field of unified multimodal understanding and generation has witnessed surge in interest, with numerous research projects [56, 65, 67, 69, 72, 78, 82, 87] demonstrate promising results in jointly optimizing generation and understanding benchmarks with crafted unified architecture. While several efforts [1, 11, 69] attempt to scale up their unified models, they are still trained predominantly on image-text paired data from standard image generation and understanding tasks. Recent research [10] has revealed substantial gap in unified multimodal understanding and generation between academic models and proprietary systems such as GPT-4o and Gemini 2.0, whose underlying techniques remain undisclosed. We argue that the key to close this gap lies in scaling with carefully structured multimodal interleaved data - integrates texts, images, videos and web sources. Our experiments reveal emerging properties as the interleaved multimodal pretraining scales up. Beyond enhancing core multimodal understanding and generation capabilities, the scaling also facilitates complex compositional abilities such as free-form visual manipulation and multimodal generation with long-context reasoning, paving the way for broad spectrum of advanced functions. Work was done during their internship. 1 Figure 1 Showcase of the versatile abilities of the BAGEL model. 2 To realize this vision, we established new protocol for scalable data sourcing, filtering, and construction of high-quality multimodal interleaved data. In addition to the web source, we incorporate video data that naturally provides pixel-level, conceptual, temporal, and physical continuity, which offers exclusive signals essential for acquiring grounded world knowledge at scale. Moreover, our interleaved format inherently includes tasks such as multimodal conversation, text-to-image/video, and image manipulation, enabling seamless integration of diverse generative data. Inspired by DeepSeek-R1 [26], we further enrich the interleaved data with reasoning-oriented content to facilitate multi-modal reasoning, which enables seamless knowledge transfer between understanding and generation processes. As result, the curated data captures rich world knowledge and nuanced cross-modal interaction content, equipping models with foundational capabilities in in-context prediction, world modeling, and complex multimodal reasoning. Regarding architecture design, our primary objective is to maximize the capacity of the model without introducing heuristic bottlenecks or task-specific constraints commonly employed in previous models. Following this design philosophy, we adopt Mixture-of-Transformer-Experts (MoT) architecture that employs selective activation of modality-specific parameters. Unlike prior approaches [18, 56, 68, 72] that introduce bottleneck connectors between generation and understanding modules, our design enables long-context interaction between multimodal understanding and generation through shared self-attention operations. This bottleneck-free design enables effective scaling of training data and steps, allowing the models full capacity signals to emerge without being hindered or obscured by architectural constraints. We present the Scalable Generative Cognitive Model (BAGEL), an open-source multimodal foundation model with 7B active parameters (14B total) trained on large-scale interleaved multimodal data. BAGEL outperforms the current top-tier open-source VLMs [4, 12] on standard multimodal-understanding leaderboards, and delivers text-to-image quality that is competitive with leading public generators such as SD3 [19] and FLUX.1dev [35]. Moreover, BAGEL demonstrates consistently superior qualitative results in classical image-editing scenarios than the leading open-source models. More importantly, it extends to free-form visual manipulation, multiview synthesis, and world navigation, capabilities that constitute \"world-modeling\" tasks beyond the scope of previous image-editing models. We showcase the qualitative performance in Figure 1. As BAGEL scales with interleaved multimodal pre-training, we observe clear emerging pattern: basic multimodal understanding and high-fidelity generation converge first; next, complex editing and free-form visual manipulation abilities surface; finally, long-context reasoning starts to benefit multimodal understanding and generation, suggesting that previously independent atomic skills synergize into compositional reasoning across modalities. These emerging capabilities are not only supported by public benchmarks but are more distinctly revealed in our proposed IntelligentBench, and further verified by qualitative observations. These observations highlight that, while the optimization landscapes for understanding and generation remain partially decoupled, they can be jointly explored via shared self-attention context within single transformer model, yielding rich spectrum of capabilities in an open-source system."
        },
        {
            "title": "2 Model",
            "content": "As illustrated in Figure 2, BAGEL adopts MoT architecture comprising two transformer expertsone dedicated to multimodal understanding and the other to multimodal generation. Accordingly, the model employs two separate visual encoders: an understanding-oriented encoder and generation-oriented encoder. The two transformer experts operates on the same token sequence through the shared self-attention operation at every layer. When predicting text tokens, BAGEL follows the Next-Token-Prediction paradigm, adhering to the well-established strengths of autoregressive language models. For visual token prediction, BAGEL adopts the Rectified Flow [19, 40, 44] method following the best practice in the field of visual generation. In the remainder of this section, we share the insights and motivations that shaped these design choices."
        },
        {
            "title": "2.1 Model Design Space",
            "content": "Typical design choices for unified multi-modal generation and understanding models include: 3 Figure 2 We use two Transformer experts to process understanding and generation information, and all tokens do shared multi-modal self attention in each Transformer block. We adopt two distinct encoders to separately capture semantic content and low-level pixel information for image understanding and generation tasks. Quantized AR. Autoregressive visual generation [11, 47, 58, 69, 78, 8284, 88] with discrete visual tokenizers [31, 36, 50, 92]. This line of methods leverage the Next-Token-Prediction paradigm for both text and visual token generation, which is straightforward to implement as it can directly utilize existing LLM infrastructures. Unfortunately, the visual generation quality of autoregressive models is empirically inferior to diffusion-based models. Furthermore, inference latency suffers due to the sequential nature of the autoregressive approach. External Diffuser. LLM backbone combined with an external diffusion module [18, 23, 56, 68, 72]. This design connects pre-trained LLMs/VLMs to diffusion models via lightweight, trainable adapters. Typically, the language backbone autoregressively generates set of latent tokens as \"semantic condition\" signals, which are then employed by the diffusion module to generate images. This setup often exhibits rapid convergence with minimal data consumption and may also yield competitive performance [56] on established benchmarks for multi-modal generation and understanding. Its primary drawback, however, is the compression of the LLM context into relatively small number of latent tokens. This introduces an explicit bottleneck between understanding and generation modules, risking substantial information lossparticularly in long-context multimodal reasoning. Such constraint might contradict the scaling philosophy of large foundational models. Integrated Transformer. Unified integration of LLM and diffusion models within single transformer [49, 65, 101]. Driven by the complementary strengths of autoregressive transformers (powerful understanding/reasoning ability) and diffusion transformers (strong visual generation ability), this approach uses their common model architecture to enable seamless switching between both paradigms. Compared to the External Diffuser solution, it demands substantially higher training compute. Nonetheless, it offers significant advantage by maintaining bottleneck-free context throughout all transformer blocks, thereby enabling lossless interaction between the generation and understanding modules and is more amenable to scaling. In this work, we argue that unified models have the capacity to learn richer multi-modal capabilities from large-scale interleaved multi-modal dataemergent abilities that are not captured by traditional benchmarks. To this end, we choose the bottleneck-free Integrated Transformer solution, which we believe to have greater potential in large-scale training settings and may better serve as the foundation model for long-context multimodel reasoning as well as reinforcement learning."
        },
        {
            "title": "2.2 Architecture",
            "content": "Our backbone model is inherited from an LLM with decoder-only transformer architecture. We choose Qwen2.5 LLM [91] as the initialization for its superior performance [21] and public availability. It adopts RMSNorm [96] for normalization, SwiGLU [64] for activation, RoPE [66] for positional encoding, and GQA [2] for KV cache reduction. Moreover, we add the QK-Norm [15] in each attention block following the common practice in image/video generation models [19, 35, 62], which is effective in stabilizing the training process. 4 The visual information is represented from two aspects: For visual understanding, we leverage ViT encoder to convert the raw pixels into tokens. We adopt SigLIP2-so400m/14 [74] with fixed 384-resolution as the initialization of the ViT encoder. Building upon this, we first interpolate the position embedding and set 980 980 as the maximum input size, and then integrate NaViT [16] to enable processing of images at their native aspect ratios. two-layer MLP connector is adopted to match the feature dimension of the ViT tokens and the LLM hidden states. For visual generation, we use pre-trained VAE model from FLUX [35] to convert images from pixel space to latent space and vice versa. The latent representation has downsample ration of 8 and latent channel of 16, and is then processed by 2 2 patch embedding layer to reduce the spatial size and match the hidden dimension of the LLM backbone. The VAE model is frozen during training. Our framework applies 2D positional encoding to both ViT and VAE tokens prior to their integration into the LLM backbone. For diffusion timestep encoding, we follow [17] and add timestep embedding directly to the initial hidden states of VAE tokens, instead of using AdaLN as in conventional diffusion transformers [19, 35, 81]. This modification preserves performance while yielding cleaner architecture. Within the LLM, the text, ViT, and VAE tokens from understanding and generation tasks are interleaved according to the modality structure of input. For tokens belonging to the same sample, we employ generalized version of the causal attention mechanism. These tokens are first partitioned into multiple consecutive splits, each containing tokens from single modality (e.g., either text, ViT, or VAE). Tokens in one split may attend to all tokens in preceding splits. Inside each split, we adopt causal attention on text tokens, and keep the bidirectional attention on vision tokens."
        },
        {
            "title": "2.3 Generalized Causal Attention",
            "content": "During training, an interleaved multimodal generation sample may contain multiple images. For each image, we prepare three sets of visual tokens: Noised VAE tokens: VAE latents corrupted with diffusion noise, used exclusively for Rectified-Flow training; the MSE loss is computed on this set. Clean VAE tokens: the original (noise-free) latents, which serve as conditioning when generating subsequent image or text tokens. ViT tokens: obtained from the SigLIP2 encoder, which help to unify the input format across interleaved generation and understanding data and, empirically, to boost interleaved-generation quality. For interleaved image or text generation, subsequent image or text tokens may attend to the clean VAE tokens and ViT tokens of preceding images, but not to their noised VAE counterparts. For interleaved multi-image generation, we adopt the diffusion forcing strategy [8], which adds independent noise levels to different images and conditions each image on noisy representations of preceding images. Additionally, to enhance generation consistency, we randomly group consecutive images following [17] and apply full attention within each group. The noise level is the same inside each group. We implement the generalized causal attention with PyTorch FlexAttention [71], achieving 2 speed-up over naive scaled-dot-product attention. During inference, the generalized causal structure allows us to cache key-value (KV) pairs of the generated multimodal context and thus accelerate multimodal decoding. Only the KV pairs of clean VAE tokens and ViT tokens are stored; once an image is fully generated, the corresponding noised VAE tokens in the context are replaced by their clean counterparts. To enable classifier-free guidance [29] in interleaved inference, we randomly drop text, ViT, and clean VAE tokens with probabilities 0.1, 0.5, and 0.1, respectively. An illustration of the generalized casual attention is shown in Figure 15."
        },
        {
            "title": "2.4 Transformer Design",
            "content": "Following the principle of the Integrated Transformer solution, we compare several transformer variants: the standard Dense Transformer, Mixture-of-Experts (MoE) transformer, and Mixture-of-Transformers (MoT) architecture. 5 Figure 3 Loss curves of various designs. CE loss and MSE loss are computed on multimodal understanding and generation tasks, respectively. Ablation experiments are carried out on 1.5B LLM. The sampling ratio for generation and understanding data is set at 4:1. MoE variant: we duplicate only the feed-forward network (FFN) in each Qwen2.5 LLM block as the initialization of the generation expert. MoT variant: we duplicate all trainable parameters of Qwen2.5 LLM to create full-size generation expert. similar architecture has also been adopted by [65]. Both MoE and MoT in our model use hard routing: the newly replicated generation expert exclusively processes VAE tokens, while the original parametersthe understanding experthandle text and ViT tokens, following the strategy of the Qwen-VL series [4, 76]. Although the MoE and MoT architectures increase the total parameter count by approximately twofold compared to the dense baseline, all three model variants have identical FLOPs during both training and inference. We conduct controlled experiment on 1.5B Qwen-2.5 LLM, maintaining identical hyper-parameters and data configurations to isolate the transformer architecture as the sole variable. As illustrated in Figure 3, the MoT variant consistently outperforms both the dense and MoE designs, with the gap being most pronounced on the multimodal generation task. The MSE loss (generation) exhibits smooth, monotonically decreasing trajectory, where MoT not only converges fastest but also attains the lowest final loss. In contrast, the CE loss (understanding) exhibits greater step-to-step fluctuationsan expected consequence of interleaving heterogeneous datayet MoT still maintains the best performance in general. These findings highlight the clear advantage of decoupling the parameters devoted to generation from those optimized for understanding, which suggests the two objectives may steer the model toward distinct regions of the parameter spaceat least at the 1.5B scale examined here. In short, allocating separate capacity for multimodal understanding and generation can mitigate optimization challenges arising from competing modality-specific learning objectives."
        },
        {
            "title": "3 Data",
            "content": "As data define the knowledge boundaries of large foundational models, BAGEL is trained on diverse set of datasets spanning multiple modalitiesincluding language, image, video, and web dataenabling it to perform multimodal reasoning, in-context prediction, physical dynamics modeling, and future frame prediction, all through unified multimodal interface. In addition to standard vision-language (VLM), text-to-image (T2I), and large-scale language modeling (LLM) datasets, we build new vision-text interleaved datasets from web and video sources to further enhance the models ability for sequential multimodal reasoning. In Table 1, we summarize the scale and composition of our training data across different modalities. In the following sections, we detail our dataset sources, preparation protocols, and data mixing strategies. 6 Data Source Text Data Image-Text-Pair Understanding Data Image-Text-Pair Generation Data Interleaved Understanding Data Interleaved Generation Data: Video Interleaved Generation Data: Web # Data (M) # Tokens (T) 400 500 1600 100 45 20 0.4 0.5 2.6 0.5 0.7 0. Table 1 Data statistics for BAGEL. Since data are randomly sampled during pre-training, the dataset size does not directly correspond to the total number of seen tokens. Multimodal interleaved data is highlight in gray ."
        },
        {
            "title": "3.1 Text Only Data",
            "content": "To maintain the language modeling capabilities of the underlying LLM, we supplement our training corpus with collection of high-quality text-only data. The data are curated to support broad linguistic coverage and enable strong reasoning and generation abilities across general-purpose text tasks."
        },
        {
            "title": "3.2 Vision-Text Paired Data",
            "content": "Text-image paired data plays central role in multimodal learning, providing large-scale visual supervision for both vision-language models (VLMs) [37, 76] and text-to-image (T2I) generation [5, 35, 57, 61]. In our setup, we organize vision-text paired data into two subsets based on their downstream usage: one for VLM pre-training and one for T2I generation. VLM Image-Text Pairs. We utilize large-scale image-text pairs for VLM training, covering broad range of visual concepts and primarily sourced from web alt-text and captions. The data have undergone CLIP-based similarity filtering, resolution and aspect ratio constraints, text length checks, and deduplication to ensure quality and diversity. To address long-tail distributions, concept-aware sampling is applied to improve coverage of rare categories. In addition, structured supervision from OCR documents, charts, and grounding annotations is included to enhance the models capabilities in reading and spatial understanding. T2I Image-Text Pairs. We incorporate high-quality image-text pairs, as well as minimal synthetic data from existing T2I models [19, 35]. These data feature not only diverse caption styles such as artistic, textual, and surreal captions, but also high-quality images that are filtered for clarity, structural integrity, and semantic diversity. Together, these examples enhance the visual quality and stylistic variety of our T2I training corpus."
        },
        {
            "title": "3.3 Vision-Text Interleaved Data",
            "content": "While vision-text paired data provides useful supervision, it falls short in supporting complex in-context reasoning involving multiple images and intermediate text. Models trained on such data often struggle to capture visual and semantic relationships across modalities, resulting in less coherent generations. To address these limitations, we incorporate large-scale vision-text interleaved data into training. For improving multimodal understanding, we utilize VLM interleaved datasets. For visual generation, we introduce unified protocol for constructing vision-text interleaved data by combining diverse sources to support richer multimodal interactions, as detailed below."
        },
        {
            "title": "3.3.1 Data Source",
            "content": "To comprehensively cover diverse real-world scenarios with scalable data supply, our training corpus integrates two primary sources that provide sufficient knowledge for multimodal reasoning: video data and web data. Video data offers rich world knowledge by capturing temporal and spatial dynamics directly from the real worldthe largest and most natural simulator. It preserves fine-grained visual details, maintains identity consistency across frames, and models complex motion, making it particularly effective for tasks such as image editing, navigation, and 3D manipulation. We construct our video dataset using publicly available online video resources, as well as two open-source datasets: Koala36M [77], which provides large-scale instructional and interaction-rich content, and MVImgNet2.0 [28], which contains objects captured from varying camera viewpoints to support multi-view spatial understanding."
        },
        {
            "title": "Description",
            "content": "UI removal Resolution Image clarity Text density Relevance Doc. trimming Remove unrelated headers and footers via an LLM Image quantity Keep documents with 38 images for balanced context Remove images whose URLs contain substrings such as icon or widget Require width and height within [150, 20000], and aspect ratio within [1/2, 2] Remove blurry or low-quality images using clarity operator Discard document-style images with over 100 OCR-detected text tokens Remove redundant or irrelevant images based on CLIP similarity Table 2 Quality filtering rules are applied to web documents, with each filter type accompanied by its specific filtering threshold or method. Web data captures complex real-world multimodal structures and offers diverse knowledge spanning wide range of domains. It includes naturally interleaved resources such as illustrated encyclopedic articles, step-bystep visual tutorials, and other richly grounded documents. This interleaved format offers rich supervision for training models to perform multimodal reasoning. We build upon OmniCorpus [39], large-scale dataset preprocessed from Common Crawl [14], which provides vast collection of web documents with interleaved text and images. We additionally include open-source image editing datasets as structured interleaved data [3, 22, 32, 79, 86, 99], which teach fine-grained editing behaviors and enhance the models ability for precise multimodal reasoning and step-by-step generation."
        },
        {
            "title": "3.3.2 Data Filter",
            "content": "Data Filtering for Video Data. We follow T2V video processing pipelines [62] protocol to preprocess videos into high-quality training clips through temporal splitting, spatial cropping, and quality filtering. Videos are first segmented into short, coherent clips using lightweight shot detection, with related segments optionally merged based on visual similarity. We then remove black borders and overlays such as logos or text using crop detection and frame-level bounding box aggregation. To ensure quality, we filter clips by length, resolution, clarity, and motion stability, and deduplicate using CLIP-based similarity. This process yields clean and diverse video dataset suitable for multimodal training. Data Filtering for Web Data. To curate high-quality interleaved data from large corpus, we design two-stage filtering pipeline targeting documents such as tutorials, encyclopedic entries, and design content, where text and images exhibit strong semantic alignment. Inspired by DeepSeekMath [63], we first apply lightweight topic selection process: LLMs are prompted to classify small subset of documents, and the resulting labels are used to train fastText [34] classifiers for efficient large-scale inference. The selected data are then passed through the LLM classifier again for fine-grained filtering. We adopt the 14B variant of Qwen2.5 models [91] for its balance of performance and efficiency. To further improve data quality, we apply set of rule-based filters targeting image clarity, relevance, and document structure, as summarized in Table 2."
        },
        {
            "title": "3.3.3 Data Construction",
            "content": "Interleaved Data from Videos. To construct image-text interleaved sequences from video, we generate textual descriptions of visual changes between consecutive framescapturing object motion, action transitions, and scene shifts. These inter-frame captions serve as temporal supervision for learning visual dynamics. While large VLMs can produce high-quality change descriptions, their inference cost limits scalability. We instead distill lightweight captioning model based on Qwen2.5-VL-7B [4], finetuned on small set of high-quality inter-frame examples. To reduce hallucination, we cap the caption length at 30 tokens. For each video clip, we sample an average of four frames and generate captions for each frame pair, resulting in 45 million temporally grounded interleaved sequences. Figure 4a illustrates the data pipeline along with an example. Interleaved Data from Webs. To construct high-quality interleaved sequences from web documents, we aim to reduce the difficulty of image generation caused by weak alignment between images, their accompanying text, and surrounding visual context. To provide more localized and relevant cues for each image, we adopt caption-first strategy: for each image, we generate concise description using Qwen2.5-VL-7B [4] and insert it directly before the image as conceptual scaffold. This enables the model to form conceptual draft of 8 (a) Data pipeline for interleaved data from videos. (b) Data pipeline for interleaved data from webs. Figure 4 Interleaved data construction pipelines. (a) We construct interleaved video data by preprocessing and filtering raw videos, then generating temporally grounded captions with small VLM distilled from limited outputs of large VLM. (b) For web data, we build on OmniCorpus [39] and perform two-stage topic selection followed by quality filtering and captioning to produce structured sequences. Data examples from both pipelines are shown. the target image-grounded in both preceding context and the inserted captionbefore generating it. By generating the caption to guide what the model should expect in the image, this approach mitigates issues caused by loosely related or ambiguous inputs. Additionally, we rewrite inter-image text segments exceeding 300 tokens using an LLM summarizer to improve contextual density. These steps yield cleaner and more structured dataset of 20 million interleaved web documents. Data pipeline and examples is shown in Figure 4b."
        },
        {
            "title": "3.3.4 Reasoning-Augmented Data",
            "content": "Inspired by recent models like O1 [33] and DeepSeek-R1 [26], we leverage long-context Chain-of-Thoughts data for multimodal understanding. Moreover, we hypothesize that introducing language-based reasoning step before image generation helps clarify visual goals and improve planning. To explore this, we construct 500k reasoning-augmented examples, covering four categories based on the structural relation between input and output: text-to-image generation, free-form image manipulation, and abstract edits. Text-to-Image generation. We begin by manually crafting set of brief and ambiguous T2I queries, each paired with simple generation guidance. Using in-context learning, we prompt Qwen2.5-72B [91] to generate additional query-guidance pairs and corresponding detailed prompts, which are then passed to FLUX.1-dev [35] to produce target images. This process yields training triplets of query, reasoning trace (guidance + detailed prompt), and image, enabling models to ground image generation in language-based reasoning. Free-form image manipulation. We generate reasoning-augmented examples by prompting VLM with the source image, target image, user query, and reasoning trace example from DeepSeek-R1 [26]. The R1 example is generated by conditioning on the source and target captions, user query, and reasoning instruction. The VLM prompt for the reasoning trace generation is demonstrated in Table 9 and Table 10. We sample source and target image pairs primarily from two sources: open-source editing datasets such as OmniEdit [79], and interleaved video data, which provide rich set of naturally occurring edit scenarios characterized by substantial motion, viewpoint variations, and human interactions while preserving spatial-temporal coherence. Conceptual Edits. Conceptual edits target cases where image manipulation requires high-level conceptual reasoning rather than simple local pixel modifications, such as transforming an object into design sketch. For these tasks, we use the web interleaved dataset, sampling candidate image pairs from each sequence and applying three-stage VLM pipeline to construct high-quality QA examples. First, given sequence of images, we prompt the VLM to identify plausible input-output pair. Next, we prompt the model to generate corresponding textual question based on the selected pair. Finally, we use the VLM to assess the quality of the question and its alignment with the input and output images, filtering out low-quality examples. Accepted examples are then passed to the VLM, prompted with reasoning trace example from DeepSeek-R1 [26], to produce grounded explanations of the intended transformation, as shown in Table 11. This setup helps the model learn to interpret complex visual goals from diverse textual instructions."
        },
        {
            "title": "4 Training",
            "content": "As shown in Table 3, we adopt multi-stage training strategy using dynamic mixture of the curated data described abovespecifically, an Alignment stage for initializing the VLM connector, Pre-training stage for large-scale pre-training, Continued Training stage for increased resolution and interleaved data ratio, and Supervised Fine-tuning stage for high-quality fine-tuning: Stage: Alignment. In this stage, we align the SigLIP2 ViT encoder with the Qwen2.5 LLM by training only the MLP connector while keeping the vision encoder and the language model frozen. Only imagetext pair data are used during this stage to perform image captioning, where each image is resized to fixed resolution of 378 378 to match the input size of the pre-trained SigLIP2. Stage: Pre-training (PT). During this stage, we add QK-Norm to the LLM and all model parameters except those of the VAE are trainable. The training corpus comprises 2.5T tokens, consisting of text, imagetext pairs, multimodal conversation, web-interleaved, and video-interleaved data. We adopt native-resolution strategy for both multimodal understanding and generation, with restrictions on the maximum long side and minimum short side of each image. Stage: Continued Training (CT). Compared with PT, we increase the visual input resolution in the CT stage, which is important for both multimodal generation and understanding performance. We further strategically increase the sampling ratio of interleaved data to emphasize learning cross-modal reasoning, as the models core understanding and generation capabilities become more stable and reliable. The CT stage consumes approximately 2.6T tokens. Stage: Supervised Fine-tuning (SFT). In the SFT stage, for multimodal generation we construct high-quality subset from the imagetext-pair dataset and the interleaved-generation dataset. For multimodal understanding, we filter subset from the LLaVA-OV [37] and Mammoth-VL [27] instruction-tuning data. The total number of training tokens at this stage is 72.7billion."
        },
        {
            "title": "Alignment",
            "content": "PT CT"
        },
        {
            "title": "SFT",
            "content": "Hyperparameters Learning rate LR scheduler Weight decay Gradient norm clip Optimizer Loss weight (CE : MSE) Warm-up steps Training steps EMA ratio Sequence length per rank (min, max) # Training seen tokens Max context window Gen resolution (min short side, max long side) Und resolution (min short side, max long side) Diffusion timestep shift Data sampling ratio Text Image-Text pair (T2I) Image-Text pair (I2T) Interleaved understanding Interleaved generation: video Interleaved generation: web 2.5 105 1 103 Constant Cosine 0.0 0.0 1.0 1.0 AdamW (β1 = 0.9, β2 = 0.95, ϵ = 1.0 1015) 1.0 104 Constant 0.0 1.0 1.0 104 Constant 0.0 1.0 - 250 5K - (32K, 36K) 4.9B 16K - (378, 378) - 0.25 : 1 2500 200K 0.9999 (32K, 36K) 2.5T 16k (256, 512) (224, 980) 1.0 0.25 : 1 2500 100k 0.9999 (40K, 45K) 2.6T 40k (512, 1024) (378, 980) 4.0 0.25 : 1 500 15K 0.995 (40K, 45K) 72.7B 40k (512, 1024) (378, 980) 4.0 0.0 0.0 1.0 0.0 0.0 0.0 0.05 0.6 0.1 0.1 0.1 0.05 0.05 0.4 0.1 0.15 0.15 0. 0.05 0.3 0.05 0.2 0.2 0.2 Table 3 Training recipe of BAGEL. Multimodal interleaved data is highlight in gray . 10 Figure 5 Loss curves of different data ratios. Ablation experiments are carried out on 1.5B LLM. \"1g1u\" means that the sampling ratio for generation and understanding data is set at 1:1. Figure 6 Loss curves of different learning rates. Ablation experiments are carried out on 1.5B LLM. The sampling ratio for generation and understanding data is set at 1:1. For all training stages, we use the AdamW [46] optimizer with β1 = 0.9, β2 = 0.95. Inspired by [51], we set ϵ = 1.0 1015 to suppress loss spikes. When increasing the resolution for generation, we also increase the diffusion timestep from 1.0 to 4.0 to ensure proper noise-level distribution. We adopt constant learning rate for the PT, CT, and SFT stages so that we can easily scale the training data without restarting the training process [30]. To ensure load balance among different ranks, we pack the sequences on each rank into narrow length range (32K to 36K tokens for Alignment and PT, 40K to 45K tokens for CT and SFT). Unlike the pre-training of standalone VLMs or T2I models, unified multimodal pre-training requires careful tuning of two key hyper-parametersthe data-sampling ratio and the learning rateto balance signals from understanding and generation tasks. Below, we describe the empirical insights that guided these choices, which in turn shaped the training protocol summarized in Table 3."
        },
        {
            "title": "4.1 Data Sampling Ratio",
            "content": "To choose the sampling ratios for each data source during unified pre-training, we conducted series of controlled studies on the 1.5B Qwen2.5 LLM [91] by adjusting the proportion of multimodal generation data versus multimodal understanding data. As shown in Figure 5, increasing the sampling ration of generation data from 50% (\"1g1u\") to 80% (\"4g1u\") steadily reduces the MSE loss, results in 0.4% absolute reductiona considerable margin for rectified-flow models in practice. In contrast, the cross-entropy (CE) loss exhibits no consistent pattern across sampling ratios; the largest observed gap, 0.07 at step 14,000 between \"4g1u\" and \"2g1u\", has negligible impact on downstream benchmarks. These findings suggest that generation examples should be sampled substantially more often than understanding examplesa heuristic we adopt throughout the training protocol summarized in Table 3."
        },
        {
            "title": "4.2 Learning Rate",
            "content": "We next carried out controlled experiment identical to the setup in Section 4.1 except for the learning-rate setup. As shown in Figure 6, the two losses behave oppositely: larger learning rate makes the MSE loss converge faster, whereas smaller learning rate benefits the CE loss. To reconcile this trade-off, we assign separate weighting factors to the two objectives, as listed in Table 3."
        },
        {
            "title": "5 Evaluation\nTo comprehensively evaluate a unified model, we draw on established benchmarks that target well-defined\nskills such as multimodal understanding, T2I generation, and classical image editing. Yet for capabilities\nthat demand strong multimodal reasoning and complex task composition, effective evaluation strategies are\nstill lacking. In the following, we first illustrate the available benchmarks used during our evaluation process,\nand then introduce a new evaluation suite for free-form image manipulation (including conceptual editing),\ndesigned to reveal a model’s proficiency in multimodal reasoning and complex compositional tasks.",
            "content": "Multimodal understanding. We adopt six widely used benchmarksMME [20], MMBench (1.0-EN) [45], MMVet [94], MMMU [95], MathVista [48], and MMVP [73]. Collectively they offer concise but comprehensive testbed that spans perception, cognition, and multimodal reasoning, while retaining strong discriminative power for ranking state-of-the-art models. Text-to-Image generation. We follow [11, 56] and report results on the popular GenEval [25] benchmark. We also adopt the recently proposed WISE benchmark [52], which offers comprehensive assessment of complex semantic understanding and world-knowledge integration in text-to-image generation. In addition, we include qualitative comparisons with state-of-the-art models as complement to these automatic evaluation metrics. Image Editing. We adopt GEdit-Bench [43] as our primary evaluation suite owing to its real-world relevance and diverse set of editing tasks. Built from authentic user requests scraped from the web, GEdit-Bench closely mirrors practical editing needs. Performance is scored automatically with GPT-4.1 [53], and we also supplement these scores with qualitative examples to provide more nuanced assessment. Intelligent Image Editing. We propose IntelligentBench as proxy task for the evaluation of free-form image manipulation ability, which requires complex multimodal reasoning and task composition. The initial release of IntelligentBench comprises 350 examples, each consisting of question image, question text, and reference answer image. Evaluation is performed using GPT-4o (version: gpt-4o-2024-11-20), which reviews complete quadrupletthe question image, question text, reference answer image, and the model-generated image. The evaluation criteria include request fulfillment, visual consistency, and knowledge-grounded creativity, reflecting the benchmarks focus on both task correctness and the depth of reasoning. Each answer is scored on scale from 0 to 2. The final score of model is calculated by summing all individual scores and normalizing the total to 100-point scale. The detailed evaluation prompt is provided in Appendix Table 12. With the help of IntelligentBench, we can evaluate how well the model performs reasoning and integrates world knowledge for image editing. Some showcases and qualitative results on IntelligentBench can be found in Figure 12."
        },
        {
            "title": "6 Emerging Properties\nEmerging properties have been studied extensively in the context of large visual or language models [7, 80].\nIn this work, situated within the scope of unified multimodal foundational models, we adopt a more focused\ndefinition for emerging properties:",
            "content": "An ability is emerging if it is not present in earlier training stages but is present in later pre-trainings. This qualitative shift, often referred to as phase transition, denotes sudden and dramatic change in model behavior that cannot be predicted by extrapolating from training loss curves [80]. Interestingly, we observe the similar phenomenon in unified multimodal scaling, where loss curves do not explicitly signal the emergence of new capabilities. Therefore, we investigate the emergence of model capabilities by evaluating performance across range of tasks on historical checkpoints. Specifically, we report the average performance on standard VLM benchmarks as proxy for multimodal understanding, the GenEval score for generation ability, and the GEdit score and IntelligentBench score to assess the models capability in naive and complex multimodal reasoning, respectively. 12 (a) Average score on Image Understanding tasks. (b) GenEval score on Image Generation task. (c) GEdit Overall Score on classical Image Editing task. (d) IntelligentBench Score on Intelligent Editing task. Figure 7 Emerging curves. Pre-training performance curves of BAGEL on different tasks. The lighter region represents the low-resolution pre-training stage, while the darker region indicates the high-resolution CT stage. BAGEL demonstrates consistent performance improvements as the number of training tokens increases. The relationship between performance and training scale can be summarized as follows: (i) BAGEL continues to improve across various tasks with more training tokens; (ii) Different capabilities emerge at different stagesunderstanding and generation abilities emerge first, basic editing follows, and intelligent editing emerges last, reflecting the increasing complexity of these tasks. (iii) Adopting both VAE and ViT features surpasses using VAE features alone in the image editing tasks, especially in Intelligent Editing, with noticeable gap. This supports the idea that ViT provides important semantic context to aid generation. Note: The average image understanding score is computed as the mean of the scores from MME-S, MMBench, MMMU, MMVet, MathVista and MMVP. All performance evaluations are conducted with BAGELs thinking mode disabled. Interestingly, different tasks demonstrate distinct learning dynamics and saturation behaviors. If we choose the number of seen tokens required to reach 85% of peak performance as an indicator, as noted in Figure 7, we find that conventional understanding and generation benchmarks saturate relatively early: at approximately 0.18T and 0.68T tokens, respectively. In contrast, editing tasks, which require both understanding and generation capabilities, exhibit slower convergence, reaching 85% performance only after 2.64T tokens. Most notably, the Intelligent Edit taskdesigned to eliminate naive edit cases and emphasize on complex multimodal reasoningrequires 3.61T tokens to reach 85%, demonstrating pattern akin to emergent behaviors described in [80]. In this setting, the model shows initially low performance that improves gradually and significantly after the 3T seen tokens. While traditional editing tasks remain largely unaffected by the resolution increase at 3T tokens, Intelligent Editing performance keeps improving significantlyfrom 15 to 45tripling in later training stages and underscoring its dependence on unified multimodal reasoning. We further find that understanding ability, particularly visual input, plays critical role in multimodal reasoning: removing the ViT tokens has minimal impact on GEdit-Bench but causes 16% drop in Intelligent Edit, highlighting the importance of visual-semantic reasoning in complex editing tasks. 13 Figure 8 Comparison of models with different amounts of training tokens. We present cases of Text-to-Image generation and image editing. While evaluation metrics may not linearly capture the models true capabilitiespotentially leading to spurious signs of emergence, albeit unlikelywe further examine qualitative emerging behavior by inspecting generation outputs across different training checkpoints. As illustrated in Figure 8, we observe trends consistent with the performance curves: generation quality is already strong before 1.5T seen tokens , with small quality improvement after 3.0T seen tokens when trained with higher resolution. For text rendering, the ability to generate correct spell of \"hello\" and \"BAGEL\" emerge lateraround 1.5T to 4.5T tokens. The emerging behavior is also observed in the qualitative visualization of Intelligent Editing task in Figure 9. Unlike traditional editing shown in Figure 8, which involves only partial modifications to the input image, Intelligent Editing often requires generating entirely new concept based on multimodal reasoning. Prior to 3.5T tokens, the model tends to reproduce the input image with minimal changesa fallback strategy when the task is not fully understood. However, after seeing 3.5T tokens, the model begins to demonstrate clear reasoning, producing coherent and semantically appropriate edits, aligning with the emergent behavior seen in Figure 7. 14 Figure 9 Comparison of models with different amounts of training tokens. We present cases of intelligent editing that requires strong multimodal reasoning abilities."
        },
        {
            "title": "7 Main Results",
            "content": "In this section, we present both quantitative and qualitative evaluations to examine the diverse multimodal capabilities of BAGEL. We begin with basic abilities on established benchmarks, including image understanding in Section 7.1 and image generation in Section 7.2. We then report performance on existing image editing benchmarks and IntelligentBench in Section 7.3. In Section 7.4, we explore generation and editing with explicit reasoning. In this setting, BAGEL is allowed to generate intermediate thinking steps before final outputs. We find that such reasoning significantly enhances performance. Finally, in Section 7.5, we provide qualitative visualizations that showcase BAGELs world modeling abilities, including world navigation and video generation. 7."
        },
        {
            "title": "Type Model",
            "content": "# LLM Params MME-P MME-S MMBench MMMU MM-Vet MathVista MMVP O . d fi InternVL2 [13] InternVL2.5 [12] Qwen2-VL[76] Qwen2.5-VL[4] BLIP-3 [89] LLava-OV [37] InternVL2 [13] InternVL2.5 [12] Qwen2-VL [76] Qwen2.5-VL[4] Emu3-Chat [78] Kimi-VL [70] DeepSeek-VL2 [85] 256 [84] Show-o512 [87] Janus [82] Janus-Pro [11] BAGEL ILLUME [75] VILA-U Chameleon [69] Janus-Pro [11] MetaQuery-XL [56] LlamaFusion [65] MetaMorph [72] SEED-X [23] TokenFlow-XL [58] MUSE-VL [88] BAGEL 1.8B 1.8B 1.5B 3B 4B 7B 7B 7B 7B 7B 8B 2.8B/16B 4.1B/28B 1.3B 1.5B 1.5B 1.5B MoT 7B 7B 7B 7B 7B 8B 8B 13B 13B 32B 7B MoT 1440 - - - - 1580 1648 - - - 1244 - - 1097 1338 1444 1610 1445 1336 - 1567 1685 1604 - 1457 1546 - 1687 1877 2138 1872 2157 - - 2210 2344 2327 2347 - - - - - - 2183 - - - - - - - - - - 2388 73.2 74.7 74.9 79.1 76.8 80.8 81.7 84.6 83.0 83.5 58.5 - - - 69.4 75.5 79.2 75.1 66.6 35.7 79.2 83.5 72.1 75.2 70.1 68.9 81.8 85.0 34.3 43.6 41.1 53.1 41.1 48.8 49.3 56.0 54.1 58.6 31.6 57.0 51.1 26.7 30.5 36.3 43.2 38.2 32.2 28.4 41.0 58.6 41.7 41.8 35.6 38.7 50.1 55.3 44.6 60.8 49.5 61.8 - 57.5 54.2 62.8 62.0 67.1 37.2 66.7 60. - 34.3 39.8 48.2 37.0 27.7 8.3 50.0 66.6 - - 43.0 40.7 - 67.2 46.4 51.3 43.0 62.3 39.6 63.2 58.3 64.4 58.2 68.2 - 68.7 62.8 - - - 63.4 - - - - - - - - - 55.9 73.1 35.3 - - - - - 51.3 - - - 36.6 - - - - - 54.7 - 22.0 0.0 - - - 48.3 - - - 69.3 Table 4 Comparison with state-of-the-arts on viusal understanding benchmarks. MME-S refers to the summarization of MME-P and MME-C. For MoE models, we report their activate params / total params. : MetaQuery [56] adopts pre-trained model from Qwen2.5-VL [4] and freezes it during training. : Partial results are from by MetaMorph [72] or MetaQuery [56]. We extensively benchmark BAGEL against state-of-the-art open-source multimodal models, including both specialized visual understanding and general-purpose unified models. Our evaluation spans diverse set of public benchmarks to ensure comprehensive assessment of model capabilities. The visual understanding results are summarized in Table 4. At comparable activated parameter size of 7B, BAGEL outperforms existing unified models in understanding tasks. For instance, it achieves significant improvements of 14.3 and 17.1 points over Janus-Pro [11] on MMMU and MM-Vet, respectively. Notably, MetaQuery-XL [56] relies on frozen, pre-trained Qwen2.5-VL [4] backbone, limiting its adaptability. Moreover, BAGEL delivers superior performance on most of these benchmarks when compared to specialized understanding models like Qwen2.5-VL and InternVL2.5 [12], demonstrating that our MoT design effectively mitigates task conflicts while maintaining strong visual understanding capabilities."
        },
        {
            "title": "Type Model",
            "content": "Single Obj. Two Obj. Counting Colors Position Color Attri. Overall O . d fi PixArt-α [9] SDv2.1 [60] DALL-E 2 [59] Emu3-Gen [78] SDXL [57] DALL-E 3 [5] SD3-Medium [19] FLUX.1-dev [35] Chameleon [69] LWM [41] SEED-X [23] TokenFlow-XL [58] ILLUME [75] Janus [82] Transfusion [101] Emu3-Gen[78] Show-o [87] Janus-Pro-7B [11] MetaQuery-XL [56] BAGEL BAGEL 0.98 0.98 0.94 0.98 0.98 0.96 0.99 0.98 - 0.93 0.97 0.95 0.99 0.97 - 0.99 0.98 0.99 - 0.99 0.98 0.50 0.51 0.66 0.71 0.74 0.87 0.94 0.93 - 0.41 0.58 0.60 0.86 0.68 - 0.81 0.80 0.89 - 0.94 0.95 0.44 0.44 0.49 0.34 0.39 0.47 0.72 0.75 - 0.46 0.26 0.41 0.45 0.30 - 0.42 0.66 0.59 - 0.81 0. 0.80 0.85 0.77 0.81 0.85 0.83 0.89 0.93 - 0.79 0.80 0.81 0.71 0.84 - 0.80 0.84 0.90 - 0.88 0.95 0.08 0.07 0.10 0.17 0.15 0.43 0.33 0.68 - 0.09 0.19 0.16 0.39 0.46 - 0.49 0.31 0.79 - 0.64 0.78 0.07 0.17 0.19 0.21 0.23 0.45 0.60 0.65 - 0.15 0.14 0.24 0.28 0.42 - 0.45 0.50 0.66 - 0.63 0. 0.48 0.50 0.52 0.54 0.55 0.67 0.74 0.82 0.39 0.47 0.49 0.55 0.61 0.61 0.63 0.66 0.68 0.80 0.80 0.82 0.88 Table 5 Evaluation of text-to-image generation ability on GenEval benchmark. Gen. Only stands for an image generation model, and Unified denotes model that has both understanding and generation capabilities. refer to the methods using LLM rewriter."
        },
        {
            "title": "Chemistry",
            "content": "Overall O . d fi SDv1.5 [60] SDXL [57] SD3.5-large [19] PixArt-Alpha [9] playground-v2.5 [38] FLUX.1-dev [35] Janus [82] VILA-U [84] Show-o-512 [87] Janus-Pro-7B [11] Emu3 [78] MetaQuery-XL [56] GPT-4o BAGEL BAGEL w/ Self-CoT 0.34 0.43 0.44 0.45 0.49 0.48 0.16 0.26 0.28 0.30 0.34 0.56 0.81 0.44 0.76 0.35 0.48 0.50 0.50 0.58 0.58 0.26 0.33 0.40 0.37 0.45 0.55 0.71 0.55 0.69 0.32 0.47 0.58 0.48 0.55 0.62 0.35 0.37 0.48 0.49 0.48 0.62 0.89 0.68 0. 0.28 0.44 0.44 0.49 0.43 0.42 0.28 0.35 0.30 0.36 0.41 0.49 0.83 0.44 0.65 0.29 0.45 0.52 0.56 0.48 0.51 0.30 0.39 0.46 0.42 0.45 0.63 0.79 0.60 0.75 0.21 0.27 0.31 0.34 0.33 0.35 0.14 0.23 0.30 0.26 0.27 0.41 0.74 0.39 0. 0.32 0.43 0.46 0.47 0.49 0.50 0.23 0.31 0.35 0.35 0.39 0.55 0.80 0.52 0.70 Table 6 Comparison of world knowledge reasoning on WISE. WISE examines the complex semantic understanding and world knowledge for T2I generation. Gen. Only stands for an image generation model, and Unified denotes model that has both understanding and generation capabilities. **: Results of GPT-4o are tested by [90]. We evaluate visual generation performance on two benchmarks: GenEval and WISE. As shown in Table 5, under the same evaluation settings as MetaQuery-XL, BAGEL achieves an 88% overall score, outperforming both specialized generation models (FLUX-1-dev: 82%, SD3-Medium: 74%) and unified models (Janus-Pro: 80%, MetaQuery-XL: 80%). Even without an LLM rewriter, BAGEL attains 82%, surpassing the previous SOTA unified model, Janus-Pro-7B. On the WISE benchmark, BAGEL exceeds all prior models except the leading private model, GPT-4o. It indicates that BAGEL has strong reasoning ability with world knowledge. We conduct qualitative comparison between BAGEL and Janus-Pro 7B, SD3-medium, and GPT-4o. As shown in Figure 10, BAGEL generates significantly higher-quality images than Janus-Pro 7B and also surpasses the widely used specialist text-to-image model SD3-medium. Moreover, it natively supports prompts in both Chinese and English and allows generation at arbitrary aspect ratios. Figure 10 T2I qualitative comparison. Note that SD3-medium cannot take Chinese prompts so we translate them into English. For GPT-4o, we control the aspect ratio via text prompt. JanusPro can only generates square images."
        },
        {
            "title": "Model",
            "content": "Private Gemini 2.0 [24] GPT-4o [54] Open-source Instruct-Pix2Pix [6] MagicBrush [97] AnyEdit [93] OmniGen [86] Step1X-Edit [42] BAGEL GEdit-Bench-EN (Full set) GEdit-Bench-CN (Full set) G_SC G_PQ 6.73 7.85 3.58 4.68 3.18 5.96 7.09 7.36 6.61 7.62 5.49 5.66 5.82 5.89 6.76 6.83 G_O 6.32 7. 3.68 4.52 3.21 5.06 6.70 6.52 G_SC G_PQ 5.43 7.67 - - - - 7.20 7.34 6.78 7.56 - - - - 6.87 6. G_O 5.36 7.30 - - - - 6.86 6.50 Table 7 Comparison on GEdit-Bench. All metrics are reported as higher-is-better (). G_SC, G_PQ, and G_O refer to the metrics evaluated by GPT-4.1."
        },
        {
            "title": "Model",
            "content": "Score Private GPT-4o [54] Gemini 2.0 [24] Open-source Step1X-Edit [42] BAGEL BAGEL w/ Self-CoT 78.9 57. 14.9 44.9 55.3 Table 8 Comparison on IntelligentBench. IntelligentBench examines complex reasoning ability in an image-editing context. : Results are reported only on the subset of cases answered (some responses were rejected). GPT-4o answered 318 of 350 questions, while Gemini 2.0 answered 349 questions. We further evaluate the classical image editing capabilities of BAGEL using the GEdit-Bench [43]. As shown in Table 7, BAGEL achieves results competitive with the current leading specialist image editing model Step1X-Edit [43], and also outperforms Gemini 2.0. Additionally, we report results on our newly proposed IntelligentBench in Table 8, where BAGEL attains performance of 44.9, significantly surpassing the existing open-source Step1X-Edit model by 30. We also provide qualitative comparisons across diverse set of image editing scenarios in Figure 11 and Figure 12, benchmarking BAGEL against Gemini 2.0, GPT-4o, Step1X-Edit, and IC-Edit [98]. As illustrated, BAGEL consistently demonstrates superior performance over Step1X-Edit and IC-Edit, and also exceeds the capabilities of Gemini 2.0. While GPT-4o successfully handles these scenarios, it tends to introduce unintended modifications to the source images, an issue that BAGEL effectively avoids."
        },
        {
            "title": "7.4 Generation/Editing with Thinking",
            "content": "In this section, we validate the effectiveness of reasoning-augmented generation across various benchmarks from both quantitative and qualitative perspectives. Generation with thinking. For Text-to-Image task, we evaluate Bagel on WISE with explicit chain-of-thought (CoT) reasoning process before generation. As shown in Table 6, BAGEL with CoT achieves score of 0.70, surpassing its non-CoT counterpart by 0.18, and also outperforms all existing open-source models by significant margin (previous SOTA: MetaQuery-XL at 0.55). In addition to the quantitative evaluation, we provide visualizations in Figure 13a, where BAGEL fails to generate correct images when given only short prompt, but succeeds when using the CoT-based thinking paradigm. Editing with Thinking. As presented in Table 8, incorporating CoT into BAGEL improves its Intelligent Score from 44.9 to 55.3. This performance gain is primarily attributed to the inclusion of reasoning, which enables the model to leverage world knowledge and provide detailed editing guidance. We further illustrate several representative cases from IntelligentBench in Figure 13b, where the tasks demand general knowledge or multi-step reasoning. In these scenarios, BAGEL demonstrates significantly improved image editing capabilities when guided by the thinking content. 19 Figure 11 Comparison on editing and manipulation tasks. Figure 12 Comparison on IntelligentBench. The results demonstrate that (i) BAGEL achieves performance comparable to Gemini 2.0, effectively handling complex cases that require multi-step reasoning and the incorporation of world knowledge; and (ii) Step1X-Edit fails to address certain instances, often producing outputs that closely resemble the input image, which may be attributed to its limited reasoning capabilities. Note that BAGEL results here are generated in thinking mode. 21 (a) Thinking Helps Generation: Text-to-Image Generation Cases (b) Thinking Helps Generation: Image Editing Cases Figure 13 Illustration of thinking-aided generation in two tasks. (a) Text-to-image generation. (b) Intelligent editing."
        },
        {
            "title": "7.5 World Modeling",
            "content": "To improve BAGELs world modeling ability for long-sequence visual generation, we fine-tune the model by increasing the proportion of video and navigation data in the training recipe. For navigation, we construct our dataset from video interleave sequences, annotating camera trajectories using ParticleSfM [100]. In Figure 14, we demonstrate BAGELs world modeling capabilities, which include world navigation, rotation, and multi-frame generation. From the figure, BAGEL exhibits robust world understanding and simulation capabilities. It can follow input instructions to generate dynamic number of images for tasks like navigating and rotating an input image, or produce multiple images based on given prompt. Additionally, BAGEL demonstrates strong generalization in world understanding. For instance, while trained solely on real-world street navigation, it seamlessly extends to diverse domains such as ink paintings, cartoons, and video games."
        },
        {
            "title": "7.6 More Qualitative Results\nPerformance of BAGEL-1.5B. Figure 16 compares the text-to-image (T2I) and image-editing performance of\nBAGEL-1.5B—with 1.5 B activated parameters—against JanusPro-7B and Step1X-Edit (12B). Although\nBAGEL-1.5B is considerably smaller, it surpasses both larger models on both tasks in terms of qualitative\ncomparison. Moreover, the gap between BAGEL-1.5B and BAGEL-7B underscores the gains from model\nscaling, indicating a greater potential for even larger BAGEL variants.",
            "content": "Failure cases. In Figure 17 we present representative failure cases for BAGEL alongside other state-of-the-art models. Tasks that feature special IP generation, complex textual rendering, intricate human pose generation, or the simultaneous generation of multiple instances remain persistently challenging for contemporary text-toimage systems. For image editing, operations such as swapping object positions or simultaneously modifying large amount of instances likewise challenge most existing models. In some complex scenarios, both BAGEL and Gemini 2.0 exhibit similar difficulties in adhering precisely to the given instructions. By contrast, GPT-4o delivers the most consistently successful results across all examples. Performance of BAGEL can be simply enhanced by scaling data with additional text-containing images, increasing model capacity, or applying RLHF [55] during the final post-training stage."
        },
        {
            "title": "8 Conclusion",
            "content": "We presented BAGEL, unified multimodal understanding and generation model that shows emerging capabilities when scaling up unified pretraining. BAGEL yields top-tier performance on standard multimodal understanding and generation benchmarks, and further distinguish itself with powerful world modeling and reasoning capabilities. In the hope of unlocking further opportunities for multimodal research, we open source BAGEL to the research community."
        },
        {
            "title": "9 Acknowledgement",
            "content": "Wed like to thank Ziqian Wei, Haoli Chen, Shengyang Xu, Chen Li, Yujia Qin, Yi Lin, Wenhao Huang, Yan Shen, Xiaojun Xiao, Yan Wu, Gang Wu, Guodong Li, Kang Lei, Liang-Wei Tao, Qifan Yang, Bairen Yi, Xiuli Chen, Rui Cao, Yating Wang, Yufeng Zhou, Mingdi Xu, Tingting Zhang, Xuehan Xiong, Tianheng Cheng, Zanbo Wang, Heng Zhang, Yanghua Peng, Faming Wu for their contributions to the BAGEL project. 23 Figure 14 Examples of BAGEL in navigation, rotation, and multi-image generation."
        },
        {
            "title": "References",
            "content": "[1] Armen Aghajanyan, Lili Yu, Alexis Conneau, Wei-Ning Hsu, Karen Hambardzumyan, Susan Zhang, Stephen Roller, Naman Goyal, Omer Levy, and Luke Zettlemoyer. Scaling laws for generative mixed-modal language models. In ICML, 2023. [2] Joshua Ainslie, James Lee-Thorp, Michiel De Jong, Yury Zemlyanskiy, Federico Lebrón, and Sumit Sanghai. Gqa: Training generalized multi-query transformer models from multi-head checkpoints. arXiv preprint arXiv:2305.13245, 2023. [3] Jinbin Bai, Wei Chow, Ling Yang, Xiangtai Li, Juncheng Li, Hanwang Zhang, and Shuicheng Yan. Humanedit: high-quality human-rewarded dataset for instruction-based image editing. arXiv preprint arXiv:2412.04280, 2024. [4] Shuai Bai, Keqin Chen, Xuejing Liu, Jialin Wang, Wenbin Ge, Sibo Song, Kai Dang, Peng Wang, Shijie Wang, Jun Tang, Humen Zhong, Yuanzhi Zhu, Mingkun Yang, Zhaohai Li, Jianqiang Wan, Pengfei Wang, Wei Ding, Zheren Fu, Yiheng Xu, Jiabo Ye, Xi Zhang, Tianbao Xie, Zesen Cheng, Hang Zhang, Zhibo Yang, Haiyang Xu, and Junyang Lin. Qwen2.5-vl technical report. arXiv preprint arXiv:2502.13923, 2025. [5] James Betker, Gabriel Goh, Li Jing, Tim Brooks, Jianfeng Wang, Linjie Li, Long Ouyang, Juntang Zhuang, Joyce Lee, Yufei Guo, et al. Improving image generation with better captions. OpenAI blog, 2023. [6] Tim Brooks, Aleksander Holynski, and Alexei A. Efros. Instructpix2pix: Learning to follow image editing instructions. In CVPR, 2023. [7] Mathilde Caron, Hugo Touvron, Ishan Misra, Hervé Jégou, Julien Mairal, Piotr Bojanowski, and Armand Joulin. Emerging properties in self-supervised vision transformers. In ICCV, 2021. [8] Boyuan Chen, Diego Martí Monsó, Yilun Du, Max Simchowitz, Russ Tedrake, and Vincent Sitzmann. Diffusion forcing: Next-token prediction meets full-sequence diffusion. In NeurIPS, 2024. [9] Junsong Chen, Chongjian Ge, Enze Xie, Yue Wu, Lewei Yao, Xiaozhe Ren, Zhongdao Wang, Ping Luo, Huchuan Lu, and Zhenguo Li. Pixart-sigma: Weak-to-strong training of diffusion transformer for 4k text-to-image generation. In ECCV, 2024. [10] Sixiang Chen, Jinbin Bai, Zhuoran Zhao, Tian Ye, Qingyu Shi, Donghao Zhou, Wenhao Chai, Xin Lin, Jianzong Wu, Chao Tang, Shilin Xu, Tao Zhang, Haobo Yuan, Yikang Zhou, Wei Chow, Linfeng Li, Xiangtai Li, Lei Zhu, and Lu Qi. An empirical study of gpt-4o image generation capabilities. arXiv preprint arXiv:2504.05979, 2025. [11] Xiaokang Chen, Chengyue Wu, Zhiyu Wu, Yiyang Ma, Xingchao Liu, Zizheng Pan, Wen Liu, Zhenda Xie, Xingkai Yu, Chong Ruan, and Ping Luo. Janus-pro: Unified multimodal understanding and generation with data and model scaling. arXiv preprint arXiv:2501.17811, 2025. [12] Zhe Chen, Weiyun Wang, Yue Cao, Yangzhou Liu, Zhangwei Gao, Erfei Cui, Jinguo Zhu, Shenglong Ye, Hao Tian, Zhaoyang Liu, Lixin Gu, Xuehui Wang, Qingyun Li, Yimin Ren, Zixuan Chen, Jiapeng Luo, Jiahao Wang, Tan Jiang, Bo Wang, Conghui He, Botian Shi, Xingcheng Zhang, Han Lv, Yi Wang, Wenqi Shao, Pei Chu, Zhongying Tu, Tong He, Zhiyong Wu, Huipeng Deng, Jiaye Ge, Kai Chen, Kaipeng Zhang, Limin Wang, Min Dou, Lewei Lu, Xizhou Zhu, Tong Lu, Dahua Lin, Yu Qiao, Jifeng Dai, and Wenhai Wang. Expanding performance boundaries of open-source multimodal models with model, data, and test-time scaling. arXiv preprint arXiv:2412.05271, 2024. [13] Zhe Chen, Weiyun Wang, Hao Tian, Shenglong Ye, Zhangwei Gao, Erfei Cui, Wenwen Tong, Kongzhi Hu, Jiapeng Luo, Zheng Ma, et al. How far are we to gpt-4v? closing the gap to commercial multimodal models with open-source suites. Science China Information Sciences, 2024. [14] Common Crawl. Common crawl - open repository of web crawl data., 2007. URL https://commoncrawl.org/. [15] Mostafa Dehghani, Josip Djolonga, Basil Mustafa, Piotr Padlewski, Jonathan Heek, Justin Gilmer, Andreas Peter Steiner, Mathilde Caron, Robert Geirhos, Ibrahim Alabdulmohsin, et al. Scaling vision transformers to 22 billion parameters. In ICML, 2023. [16] Mostafa Dehghani, Basil Mustafa, Josip Djolonga, Jonathan Heek, Matthias Minderer, Mathilde Caron, Andreas Steiner, Joan Puigcerver, Robert Geirhos, Ibrahim Alabdulmohsin, et al. Patch npack: Navit, vision transformer for any aspect ratio and resolution. In NeurIPS, 2023. 25 [17] Chaorui Deng, Deyao Zhu, Kunchang Li, Shi Guang, and Haoqi Fan. Causal diffusion transformers for generative modeling. arXiv preprint arXiv:2412.12095, 2024. [18] Runpei Dong, Chunrui Han, Yuang Peng, Zekun Qi, Zheng Ge, Jinrong Yang, Liang Zhao, Jianjian Sun, Hongyu Zhou, Haoran Wei, et al. Dreamllm: Synergistic multimodal comprehension and creation. In ICLR, 2024. [19] Patrick Esser, Sumith Kulal, Andreas Blattmann, Rahim Entezari, Jonas Müller, Harry Saini, Yam Levi, Dominik Lorenz, Axel Sauer, Frederic Boesel, et al. Scaling rectified flow transformers for high-resolution image synthesis. In ICML, 2024. [20] Chaoyou Fu, Peixian Chen, Yunhang Shen, Yulei Qin, Mengdan Zhang, Xu Lin, Jinrui Yang, Xiawu Zheng, Ke Li, Xing Sun, et al. Mme: comprehensive evaluation benchmark for multimodal large language models. arXiv preprint arXiv:2306.13394, 2023. [21] Kanishk Gandhi, Ayush Chakravarthy, Anikait Singh, Nathan Lile, and Noah Goodman. Cognitive behaviors that enable self-improving reasoners, or, four habits of highly effective stars. arXiv preprint arXiv:2503.01307, 2025. [22] Yuying Ge, Sijie Zhao, Chen Li, Yixiao Ge, and Ying Shan. Seed-data-edit technical report: hybrid dataset for instructional image editing. arXiv preprint arXiv:2405.04007, 2024. [23] Yuying Ge, Sijie Zhao, Jinguo Zhu, Yixiao Ge, Kun Yi, Lin Song, Chen Li, Xiaohan Ding, and Ying Shan. Seed-x: Multimodal models with unified multi-granularity comprehension and generation. arXiv preprint arxiv:2404.14396, 2024. [24] Google Gemini2. Experiment with gemini 2.0 flash native image generation, 2025. URL https://developers. googleblog.com/en/experiment-with-gemini-20-flash-native-image-generation/. [25] Dhruba Ghosh, Hannaneh Hajishirzi, and Ludwig Schmidt. Geneval: An object-focused framework for evaluating text-to-image alignment. In NeurIPS, 2023. [26] Daya Guo, Dejian Yang, Haowei Zhang, Junxiao Song, Ruoyu Zhang, Runxin Xu, Qihao Zhu, Shirong Ma, Peiyi Wang, Xiao Bi, et al. Deepseek-r1: Incentivizing reasoning capability in llms via reinforcement learning. arXiv preprint arXiv:2501.12948, 2025. [27] Jarvis Guo, Tuney Zheng, Yuelin Bai, Bo Li, Yubo Wang, King Zhu, Yizhi Li, Graham Neubig, Wenhu Chen, and Xiang Yue. Mammoth-vl: Eliciting multimodal reasoning with instruction tuning at scale. arXiv preprint arXiv:2412.05237, 2024. [28] Xiaoguang Han, Yushuang Wu, Luyue Shi, Haolin Liu, Hongjie Liao, Lingteng Qiu, Weihao Yuan, Xiaodong Gu, Zilong Dong, and Shuguang Cui. Mvimgnet2. 0: larger-scale dataset of multi-view images. arXiv preprint arXiv:2412.01430, 2024. [29] Jonathan Ho and Tim Salimans. Classifier-free diffusion guidance. In NeurIPS Workshop on Deep Generative Models and Downstream Applications, 2021. [30] Shengding Hu, Yuge Tu, Xu Han, Ganqu Cui, Chaoqun He, Weilin Zhao, Xiang Long, Zhi Zheng, Yewei Fang, Yuxiang Huang, Xinrong Zhang, Zhen Leng Thai, Chongyi Wang, Yuan Yao, Chenyang Zhao, Jie Zhou, Jie Cai, Zhongwu Zhai, Ning Ding, Chao Jia, Guoyang Zeng, dahai li, Zhiyuan Liu, and Maosong Sun. Minicpm: Unveiling the potential of small language models with scalable training strategies. In COLM, 2024. [31] Minyoung Huh, Brian Cheung, Pulkit Agrawal, and Phillip Isola. Straightening out the straight-through estimator: Overcoming optimization challenges in vector quantized networks. In ICML, 2023. [32] Mude Hui, Siwei Yang, Bingchen Zhao, Yichun Shi, Heng Wang, Peng Wang, Yuyin Zhou, and Cihang Xie. Hq-edit: high-quality dataset for instruction-based image editing. arXiv preprint arXiv:2404.09990, 2024. [33] Aaron Jaech, Adam Kalai, Adam Lerer, Adam Richardson, Ahmed El-Kishky, Aiden Low, Alec Helyar, Aleksander Madry, Alex Beutel, Alex Carney, et al. Openai o1 system card. arXiv preprint arXiv:2412.16720, 2024. [34] Armand Joulin, Edouard Grave, Piotr Bojanowski, Matthijs Douze, Hérve Jégou, and Tomas Mikolov. Fasttext.zip: Compressing text classification models. arXiv preprint arXiv:1612.03651, 2016. [35] Black Forest Labs. Flux, 2024. URL https://github.com/black-forest-labs/flux. [36] Doyup Lee, Chiheon Kim, Saehoon Kim, Minsu Cho, and Wook-Shin Han. Autoregressive image generation using residual quantization. In CVPR, 2022. 26 [37] Bo Li, Yuanhan Zhang, Dong Guo, Renrui Zhang, Feng Li, Hao Zhang, Kaichen Zhang, Peiyuan Zhang, Yanwei Li, Ziwei Liu, and Chunyuan Li. LLaVA-onevision: Easy visual task transfer. TMLR, 2025. [38] Daiqing Li, Aleks Kamko, Ehsan Akhgari, Ali Sabet, Linmiao Xu, and Suhail Doshi. Playground v2. 5: Three insights towards enhancing aesthetic quality in text-to-image generation. arXiv preprint arXiv:2402.17245, 2024. [39] Qingyun Li, Zhe Chen, Weiyun Wang, Wenhai Wang, Shenglong Ye, Zhenjiang Jin, Guanzhou Chen, Yinan He, Zhangwei Gao, Erfei Cui, et al. Omnicorpus: unified multimodal corpus of 10 billion-level images interleaved with text. arXiv preprint arXiv:2406.08418, 2024. [40] Yaron Lipman, Ricky TQ Chen, Heli Ben-Hamu, Maximilian Nickel, and Matt Le. Flow matching for generative modeling. In ICLR, 2023. [41] Hao Liu, Wilson Yan, Matei Zaharia, and Pieter Abbeel. World model on million-length video and language with ringattention. arXiv preprint arxiv:2402.08268, 2024. [42] Shiyu Liu, Yucheng Han, Peng Xing, Fukun Yin, Rui Wang, Wei Cheng, Jiaqi Liao, Yingming Wang, Honghao Fu, Chunrui Han, Guopeng Li, Yuang Peng, Quan Sun, Jingwei Wu, Yan Cai, Zheng Ge, Ranchen Ming, Lei Xia, Xianfang Zeng, Yibo Zhu, Binxing Jiao, Xiangyu Zhang, Gang Yu, and Daxin Jiang. Step1x-edit: practical framework for general image editing. arXiv preprint arXiv:2504.17761, 2025. [43] Shiyu Liu, Yucheng Han, Peng Xing, Fukun Yin, Rui Wang, Wei Cheng, Jiaqi Liao, Yingming Wang, Honghao Fu, Chunrui Han, et al. Step1x-edit: practical framework for general image editing. arXiv preprint arXiv:2504.17761, 2025. [44] Xingchao Liu, Chengyue Gong, et al. Flow straight and fast: Learning to generate and transfer data with rectified flow. In ICLR, 2023. [45] Yuan Liu, Haodong Duan, Yuanhan Zhang, Bo Li, Songyang Zhang, Wangbo Zhao, Yike Yuan, Jiaqi Wang, Conghui He, Ziwei Liu, et al. Mmbench: Is your multi-modal model an all-around player? In ECCV, 2024. [46] Loshchilov. Decoupled weight decay regularization. arXiv preprint arXiv:1711.05101, 2017. [47] Jiasen Lu, Christopher Clark, Sangho Lee, Zichen Zhang, Savya Khosla, Ryan Marten, Derek Hoiem, and Aniruddha Kembhavi. Unified-io 2: Scaling autoregressive multimodal models with vision language audio and action. In CVPR, pages 2643926455, 2024. [48] Pan Lu, Hritik Bansal, Tony Xia, Jiacheng Liu, Chunyuan Li, Hannaneh Hajishirzi, Hao Cheng, Kai-Wei Chang, Michel Galley, and Jianfeng Gao. Mathvista: Evaluating mathematical reasoning of foundation models in visual contexts. In NeurIPS Workshop on Mathematical Reasoning and AI, 2023. [49] Yiyang Ma, Xingchao Liu, Xiaokang Chen, Wen Liu, Chengyue Wu, Zhiyu Wu, Zizheng Pan, Zhenda Xie, Haowei Zhang, Xingkai Yu, Liang Zhao, Yisong Wang, Jiaying Liu, and Chong Ruan. Janusflow: Harmonizing autoregression and rectified flow for unified multimodal understanding and generation. arXiv preprint arXiv:2411.07975, 2024. [50] Fabian Mentzer, David Minnen, Eirikur Agustsson, and Michael Tschannen. Finite scalar quantization: Vq-vae made simple. arXiv preprint arXiv:2309.15505, 2023. [51] Igor Molybog, Peter Albert, Moya Chen, Zachary DeVito, David Esiobu, Naman Goyal, Punit Singh Koura, Sharan Narang, Andrew Poulton, Ruan Silva, et al. theory on adam instability in large-scale machine learning. arXiv preprint arXiv:2304.09871, 2023. [52] Yuwei Niu, Munan Ning, Mengren Zheng, Bin Lin, Peng Jin, Jiaqi Liao, Kunpeng Ning, Bin Zhu, and Li Yuan. Wise: world knowledge-informed semantic evaluation for text-to-image generation. arXiv preprint arXiv:2503.07265, 2025. [53] OpenAI. Introducing gpt-4.1 in the api. OpenAI Blog, 2025. URL https://openai.com/index/gpt-4-1/. [54] OpenAI."
        },
        {
            "title": "Introducing",
            "content": "4o image generation, 2025."
        },
        {
            "title": "URL",
            "content": "https://openai.com/index/ introducing-4o-image-generation/. [55] Long Ouyang, Jeff Wu, Xu Jiang, Diogo Almeida, Carroll L. Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, John Schulman, Jacob Hilton, Fraser Kelton, Luke E. Miller, Maddie Simens, Amanda Askell, Peter Welinder, Paul Christiano, Jan Leike, and Ryan Lowe. Training language models to follow instructions with human feedback. ArXiv, abs/2203.02155, 2022. URL https://arxiv.org/abs/2203.02155. 27 [56] Xichen Pan, Satya Narayan Shukla, Aashu Singh, Zhuokai Zhao, Shlok Kumar Mishra, Jialiang Wang, Zhiyang Xu, Jiuhai Chen, Kunpeng Li, Felix Juefei-Xu, Ji Hou, and Saining Xie. Transfer between modalities with metaqueries. arXiv preprint arXiv:2504.06256, 2025. [57] Dustin Podell, Zion English, Kyle Lacey, Andreas Blattmann, Tim Dockhorn, Jonas Müller, Joe Penna, and Robin Rombach. Sdxl: Improving latent diffusion models for high-resolution image synthesis. In ICLR, 2024. [58] Liao Qu, Huichao Zhang, Yiheng Liu, Xu Wang, Yi Jiang, Yiming Gao, Hu Ye, Daniel Du, Zehuan Yuan, and Xinglong Wu. Tokenflow: Unified image tokenizer for multimodal understanding and generation. arXiv preprint arXiv:2412.03069, 2024. [59] Aditya Ramesh, Prafulla Dhariwal, Alex Nichol, Casey Chu, and Mark Chen. Hierarchical text-conditional image generation with clip latents. arXiv preprint arxiv:2204.06125, 2022. [60] Robin Rombach, Andreas Blattmann, Dominik Lorenz, Patrick Esser, and Björn Ommer. High-resolution image synthesis with latent diffusion models. In CVPR, pages 1068410695, 2022. [61] Chitwan Saharia, William Chan, Saurabh Saxena, Lala Li, Jay Whang, Emily Denton, Kamyar Ghasemipour, Raphael Gontijo Lopes, Burcu Karagol Ayan, Tim Salimans, et al. Photorealistic text-to-image diffusion models with deep language understanding. In NeurIPS, 2022. [62] Team Seawead, Ceyuan Yang, Zhijie Lin, Yang Zhao, Shanchuan Lin, Zhibei Ma, Haoyuan Guo, Hao Chen, Lu Qi, Sen Wang, et al. Seaweed-7b: Cost-effective training of video generation foundation model. arXiv preprint arXiv:2504.08685, 2025. [63] Zhihong Shao, Peiyi Wang, Qihao Zhu, Runxin Xu, Junxiao Song, Xiao Bi, Haowei Zhang, Mingchuan Zhang, YK Li, Wu, et al. Deepseekmath: Pushing the limits of mathematical reasoning in open language models. arXiv preprint arXiv:2402.03300, 2024. [64] Noam Shazeer. Glu variants improve transformer. arXiv preprint arXiv:2002.05202, 2020. [65] Weijia Shi, Xiaochuang Han, Chunting Zhou, Weixin Liang, Xi Victoria Lin, Luke Zettlemoyer, and Lili Yu. Llamafusion: Adapting pretrained language models for multimodal generation. arXiv preprint arXiv:2412.15188, 2024. [66] Jianlin Su, Murtadha Ahmed, Yu Lu, Shengfeng Pan, Wen Bo, and Yunfeng Liu. Roformer: Enhanced transformer with rotary position embedding. Neurocomputing, 568:127063, 2024. [67] Quan Sun, Qiying Yu, Yufeng Cui, Fan Zhang, Xiaosong Zhang, Yueze Wang, Hongcheng Gao, Jingjing Liu, Tiejun Huang, and Xinlong Wang. Emu: Generative pretraining in multimodality. arXiv preprint arXiv:2307.05222, 2023. [68] Quan Sun, Yufeng Cui, Xiaosong Zhang, Fan Zhang, Qiying Yu, Yueze Wang, Yongming Rao, Jingjing Liu, Tiejun Huang, and Xinlong Wang. Generative multimodal models are in-context learners. In CVPR, 2024. [69] Chameleon Team. Chameleon: Mixed-modal early-fusion foundation models. arXiv preprint arXiv:2405.09818, 2024. [70] Kimi Team, Angang Du, Bohong Yin, Bowei Xing, Bowen Qu, Bowen Wang, Cheng Chen, Chenlin Zhang, Chenzhuang Du, Chu Wei, Congcong Wang, Dehao Zhang, Dikang Du, Dongliang Wang, Enming Yuan, Enzhe Lu, Fang Li, Flood Sung, Guangda Wei, Guokun Lai, Han Zhu, Hao Ding, Hao Hu, Hao Yang, Hao Zhang, Haoning Wu, Haotian Yao, Haoyu Lu, Heng Wang, Hongcheng Gao, Huabin Zheng, Jiaming Li, Jianlin Su, Jianzhou Wang, Jiaqi Deng, Jiezhong Qiu, Jin Xie, Jinhong Wang, Jingyuan Liu, Junjie Yan, Kun Ouyang, Liang Chen, Lin Sui, Longhui Yu, Mengfan Dong, Mengnan Dong, Nuo Xu, Pengyu Cheng, Qizheng Gu, Runjie Zhou, Shaowei Liu, Sihan Cao, Tao Yu, Tianhui Song, Tongtong Bai, Wei Song, Weiran He, Weixiao Huang, Weixin Xu, Xiaokun Yuan, Xingcheng Yao, Xingzhe Wu, Xinxing Zu, Xinyu Zhou, Xinyuan Wang, Y. Charles, Yan Zhong, Yang Li, Yangyang Hu, Yanru Chen, Yejie Wang, Yibo Liu, Yibo Miao, Yidao Qin, Yimin Chen, Yiping Bao, Yiqin Wang, Yongsheng Kang, Yuanxin Liu, Yulun Du, Yuxin Wu, Yuzhi Wang, Yuzi Yan, Zaida Zhou, Zhaowei Li, Zhejun Jiang, Zheng Zhang, Zhilin Yang, Zhiqi Huang, Zihao Huang, Zijia Zhao, Ziwei Chen, and Zongyu Lin. Kimi-vl technical report. arXiv preprint arXiv:2504.07491, 2025. [71] Pytorch Team. Flexattention: The flexibility of pytorch with the performance of flashattention. Pytorch Blog, 2024. URL https://pytorch.org/blog/flexattention/. 28 [72] Shengbang Tong, David Fan, Jiachen Zhu, Yunyang Xiong, Xinlei Chen, Koustuv Sinha, Michael Rabbat, Yann LeCun, Saining Xie, and Zhuang Liu. Metamorph: Multimodal understanding and generation via instruction tuning. arXiv preprint arXiv:2412.14164, 2024. [73] Shengbang Tong, Zhuang Liu, Yuexiang Zhai, Yi Ma, Yann LeCun, and Saining Xie. Eyes wide shut? exploring the visual shortcomings of multimodal llms. In CVPR, pages 95689578, 2024. [74] Michael Tschannen, Alexey Gritsenko, Xiao Wang, Muhammad Ferjad Naeem, Ibrahim Alabdulmohsin, Nikhil Parthasarathy, Talfan Evans, Lucas Beyer, Ye Xia, Basil Mustafa, et al. Siglip 2: Multilingual vision-language encoders with improved semantic understanding, localization, and dense features. arXiv preprint arXiv:2502.14786, 2025. [75] Chunwei Wang, Guansong Lu, Junwei Yang, Runhui Huang, Jianhua Han, Lu Hou, Wei Zhang, and Hang Xu. Illume: Illuminating your llms to see, draw, and self-enhance. arXiv preprint arXiv:2412.06673, 2024. [76] Peng Wang, Shuai Bai, Sinan Tan, Shijie Wang, Zhihao Fan, Jinze Bai, Keqin Chen, Xuejing Liu, Jialin Wang, Wenbin Ge, Yang Fan, Kai Dang, Mengfei Du, Xuancheng Ren, Rui Men, Dayiheng Liu, Chang Zhou, Jingren Zhou, and Junyang Lin. Qwen2-vl: Enhancing vision-language models perception of the world at any resolution. arXiv preprint arXiv:2409.12191, 2024. [77] Qiuheng Wang, Yukai Shi, Jiarong Ou, Rui Chen, Ke Lin, Jiahao Wang, Boyuan Jiang, Haotian Yang, Mingwu Zheng, Xin Tao, et al. Koala-36m: large-scale video dataset improving consistency between fine-grained conditions and video content. arXiv preprint arXiv:2410.08260, 2024. [78] Xinlong Wang, Xiaosong Zhang, Zhengxiong Luo, Quan Sun, Yufeng Cui, Jinsheng Wang, Fan Zhang, Yueze Wang, Zhen Li, Qiying Yu, et al. Emu3: Next-token prediction is all you need. arXiv preprint arxiv:2409.18869, 2024. [79] Cong Wei, Zheyang Xiong, Weiming Ren, Xeron Du, Ge Zhang, and Wenhu Chen. Omniedit: Building image editing generalist models through specialist supervision. In ICLR, 2024. [80] Jason Wei, Yi Tay, Rishi Bommasani, Colin Raffel, Barret Zoph, Sebastian Borgeaud, Dani Yogatama, Maarten Bosma, Denny Zhou, Donald Metzler, Ed H. Chi, Tatsunori Hashimoto, Oriol Vinyals, Percy Liang, Jeff Dean, and William Fedus. Emergent abilities of large language models. arXiv preprint arXiv:2206.07682, 2022. [81] Peebles William and Saining Xie. Scalable diffusion models with transformers. In ICCV, 2023. [82] Chengyue Wu, Xiaokang Chen, Zhiyu Wu, Yiyang Ma, Xingchao Liu, Zizheng Pan, Wen Liu, Zhenda Xie, Xingkai Yu, Chong Ruan, and Ping Luo. Janus: Decoupling visual encoding for unified multimodal understanding and generation. arXiv preprint arXiv:2410.13848, 2024. [83] Junfeng Wu, Yi Jiang, Chuofan Ma, Yuliang Liu, Hengshuang Zhao, Zehuan Yuan, Song Bai, and Xiang Bai. Liquid: Language models are scalable multi-modal generators. arXiv preprint arXiv:2412.04332, 2024. [84] Yecheng Wu, Zhuoyang Zhang, Junyu Chen, Haotian Tang, Dacheng Li, Yunhao Fang, Ligeng Zhu, Enze Xie, Hongxu Yin, Li Yi, et al. Vila-u: unified foundation model integrating visual understanding and generation. arXiv preprint arXiv:2409.04429, 2024. [85] Zhiyu Wu, Xiaokang Chen, Zizheng Pan, Xingchao Liu, Wen Liu, Damai Dai, Huazuo Gao, Yiyang Ma, Chengyue Wu, Bingxuan Wang, et al. Deepseek-vl2: Mixture-of-experts vision-language models for advanced multimodal understanding. arXiv preprint arXiv:2412.10302, 2024. [86] Shitao Xiao, Yueze Wang, Junjie Zhou, Huaying Yuan, Xingrun Xing, Ruiran Yan, Chaofan Li, Shuting Wang, Tiejun Huang, and Zheng Liu. Omnigen: Unified image generation. arXiv preprint arXiv:2409.11340, 2024. [87] Jinheng Xie, Weijia Mao, Zechen Bai, David Junhao Zhang, Weihao Wang, Kevin Qinghong Lin, Yuchao Gu, Zhijie Chen, Zhenheng Yang, and Mike Zheng Shou. Show-o: One single transformer to unify multimodal understanding and generation. arXiv preprint arxiv:2408.12528, 2024. [88] Rongchang Xie, Chen Du, Ping Song, and Chang Liu. Muse-vl: Modeling unified vlm through semantic discrete encoding. arXiv preprint arXiv:2411.17762, 2024. [89] Le Xue, Manli Shu, Anas Awadalla, Jun Wang, An Yan, Senthil Purushwalkam, Honglu Zhou, Viraj Prabhu, Yutong Dai, Michael Ryoo, Shrikant Kendre, Jieyu Zhang, Can Qin, Shu Zhang, Chia-Chih Chen, Ning Yu, Juntao Tan, Tulika Manoj Awalgaonkar, Shelby Heinecke, Huan Wang, Yejin Choi, Ludwig Schmidt, Zeyuan 29 Chen, Silvio Savarese, Juan Carlos Niebles, Caiming Xiong, and Ran Xu. xgen-mm (blip-3): family of open large multimodal models. arXiv preprint arXiv:2408.08872, 2024. [90] Zhiyuan Yan, Junyan Ye, Weijia Li, Zilong Huang, Shenghai Yuan, Xiangyang He, Kaiqing Lin, Jun He, Conghui He, and Li Yuan. Gpt-imgeval: comprehensive benchmark for diagnosing gpt4o in image generation. arXiv preprint arXiv:2504.02782, 2025. [91] An Yang, Baosong Yang, Beichen Zhang, Binyuan Hui, Bo Zheng, Bowen Yu, Chengyuan Li, Dayiheng Liu, Fei Huang, Haoran Wei, Huan Lin, Jian Yang, Jianhong Tu, Jianwei Zhang, Jianxin Yang, Jiaxi Yang, Jingren Zhou, Junyang Lin, Kai Dang, Keming Lu, Keqin Bao, Kexin Yang, Le Yu, Mei Li, Mingfeng Xue, Pei Zhang, Qin Zhu, Rui Men, Runji Lin, Tianhao Li, Tingyu Xia, Xingzhang Ren, Xuancheng Ren, Yang Fan, Yang Su, Yichang Zhang, Yu Wan, Yuqiong Liu, Zeyu Cui, Zhenru Zhang, and Zihan Qiu. Qwen2.5 technical report. arXiv preprint arXiv:2412.15115, 2024. [92] Jiahui Yu, Xin Li, Jing Yu Koh, Han Zhang, Ruoming Pang, James Qin, Alexander Ku, Yuanzhong Xu, Jason Baldridge, and Yonghui Wu. Vector-quantized image modeling with improved VQGAN. In ICLR, 2022. [93] Qifan Yu, Wei Chow, Zhongqi Yue, Kaihang Pan, Yang Wu, Xiaoyang Wan, Juncheng Li, Siliang Tang, Hanwang Zhang, and Yueting Zhuang. Anyedit: Mastering unified high-quality image editing for any idea. arXiv preprint arXiv:2411.15738, 2024. [94] Weihao Yu, Zhengyuan Yang, Linjie Li, Jianfeng Wang, Kevin Lin, Zicheng Liu, Xinchao Wang, and Lijuan Wang. Mm-vet: Evaluating large multimodal models for integrated capabilities. In ICML, 2024. [95] Xiang Yue, Yuansheng Ni, Kai Zhang, Tianyu Zheng, Ruoqi Liu, Ge Zhang, Samuel Stevens, Dongfu Jiang, Weiming Ren, Yuxuan Sun, et al. Mmmu: massive multi-discipline multimodal understanding and reasoning benchmark for expert agi. In CVPR, 2024. [96] Biao Zhang and Rico Sennrich. Root mean square layer normalization. In NeurIPS, 2019. [97] Kai Zhang, Lingbo Mo, Wenhu Chen, Huan Sun, and Yu Su. Magicbrush: manually annotated dataset for instruction-guided image editing. In NeurIPS, 2023. [98] Zechuan Zhang, Ji Xie, Yu Lu, Zongxin Yang, and Yi Yang. In-context edit: Enabling instructional image editing with in-context generation in large scale diffusion transformer. arXiv preprint arXiv:2504.20690, 2025. [99] Haozhe Zhao, Xiaojian Shawn Ma, Liang Chen, Shuzheng Si, Rujie Wu, Kaikai An, Peiyu Yu, Minjia Zhang, Qing Li, and Baobao Chang. Ultraedit: Instruction-based fine-grained image editing at scale. In NeurIPS, 2024. [100] Wang Zhao, Shaohui Liu, Hengkai Guo, Wenping Wang, and Yong-Jin Liu. Particlesfm: Exploiting dense point trajectories for localizing moving cameras in the wild. In ECCV, 2022. [101] Chunting Zhou, Lili Yu, Arun Babu, Kushal Tirumala, Michihiro Yasunaga, Leonid Shamis, Jacob Kahn, Xuezhe Ma, Luke Zettlemoyer, and Omer Levy. Transfusion: Predict the next token and diffuse images with one multi-modal model. arXiv preprint arxiv:2408.11039, 2024."
        },
        {
            "title": "Appendix",
            "content": "Figure 15 Causal mask in BAGEL during training. VAE and ViT denote VAE features and ViT features, respectively. is the noise timestep and t=0 means no noise. For each individual image, we apply full attention within its own VAE and ViT features. (a) During interleaved image-text generation, each image attends exclusively to the clean (noise-free) VAE and ViT tokens of preceding images (if present). (b) For interleaved multi-image or video clip generation, we adopt the diffusion forcing strategy [8], conditioning each image on noisy representations of preceding images. Additionally, to enhance generation consistency, we randomly group consecutive images and apply full attention within each group. 31 Figure 16 Effect of model scaling: larger models demonstrate better prompt adherence and produce higher-quality images. 32 Figure 17 Failure cases. Tasks involving certain IP, complicated text, counterfactual scenes, object swapping, and deblurring pose challenges for BAGEL and other models. In contrast, GPT-4o demonstrates more consistent success in these scenarios. ###[System Role Instruction] You have the following information: 1. question image: [Place or reference the question image here] 2. question text: [Place the text of the question here] 3. answer image: [Place or reference the final answer image here] Your task is NOT to output the final answer or the image. must: - Generate thinking or chain-of-thought process that explains how you reason about the question. - Provide the reasoning/analysis that leads to the answer image. - The reasoning/analysis should include what should be changed in the answer image compared to the question image and what should be kept the same. - The reasoning should highlight that the input image structure and layout should be kept the same. Instead, you Below is an example of how your output should look. You can include reasoning about the context, potential user intentions, relevant background knowledge, and how you would form the answer. The length of outputs should be **around or shorter than 60 tokens**. Example Output: The user wants to change the background from sunny garden to snowy setting. The structure and layout of the pink unicorn with bubble details and sunglasses should remain unchanged. Only the environment needs modification: replacing green grass with snow and surrounding greenery with frosted, snow-covered plants while maintaining lighting coherence. Table 9 The prompt to generate reasoning trace for Free-form image manipulation from edit data. 34 ###[System Role Instruction] You have the following information: 1. question image: [Place or reference the question image here] 2. question text: [Place the text of the question here] 3. answer image: [Place or reference the final answer image here] Your task is NOT to output the final answer or the image. must: - Generate thinking or chain-of-thought process that explains how you reason about the question. - Provide the reasoning/analysis that leads to the answer image. - The reasoning/analysis should include what should be changed in the answer image compared to the question image and what should be kept the same. Instead, you Below is an example of how your output should look. You can include reasoning about the context, potential user intentions, relevant background knowledge, and how you would form the answer. The length of outputs should be **around or shorter than 60 tokens**. Example Output: First, notice the cats determined action in pressing button. To adjust for the answer, the focus shifts to expressing excitement or eagerness. The cats hand should remain reaching the buttons, but its facial expression should change to wide eyes and large smile reflecting anticipation or enthusiasm. Table 10 The prompt to generate reasoning trace for Free-form image manipulation from video interleaved data. 35 ###[System Role Instruction] You have the following information: 1. question image: [Place or reference the question image here] 2. question text: [Place the text of the question here] 3. answer text: [Place the final answer text here] 4. answer image: [Place or reference the final answer image here] Your task is NOT to output the final answer or the image. must: - Generate detailed thinking or chain-of-thought process that explains how you reason about the question. - Do NOT include the final answer text in your output. - Provide only the reasoning/analysis that leads to the final answer and the answer image (even though you will not reveal the final answer itself). - The reasoning/analysis should include some description of the answer image to help the answer-image-generation. Instead, you Below is an example of how your output should look. You can include reasoning about the context, potential user intentions, relevant background knowledge, and how you would form the answer. The length of outputs should be **around or shorter than 200 tokens** Example Output: First, notice the user wants to see vehicle displayed while its moving. check the question image, which seems to feature red sports car on racetrack. The question text, Can you display the vehicle while its moving?, suggests they want visual depiction of car in motion. Im considering details like the cars color, sponsor logos, and the environment around the carperhaps theres crowd in the background, or its racing circuit. should highlight the sense of motion, possibly leaning into turn or speeding down straight. When forming the final answer text, Id mention something about the vehicle speeding around circuit. also think about how Id describe the final imagemaybe note the brand, the sponsor logos, and the number on the windshield or dashboard. Including speed, the angle of the car, and another car chasing it might help convey dynamic sense of movement. Lastly, recall that the user specifically asked to display the vehicle while its moving, so Id ensure the image description references motion, leaning into turn, and the impression of high velocity. This approach should fulfill their request. Table 11 The prompt to generate reasoning trace for conceptual editing. 36 ###Human: You are given question, the corresponding question image, human answered image, and the model-generated (AS) answer image. Your task is to evaluate whether the AS answers the question based on the following criteria: Must Exact Fulfillment of Request: The answer image must fulfill the request made in the question. If the question requires imagination or creative transformation based on knowledge of natural scenes and physical laws, the AS is allowed to make reasonable and logical changes that follow these principles. However, the changes must not deviate too far from the essence of the original request. Must Satisfy Completeness: Every element requested in the question must be reasonably present and completed in the answer image. Missing elements should be noted, but some degree of creative interpretation is acceptable as long as the request is overall fulfilled. Must No Visual Errors: The answer image must not contain major visual errors such as proportion issues, blurriness, or logical inconsistencies. Minor imperfections that do not affect the overall quality or coherence are acceptable, but significant visual errors should be avoided. Can Allow Creative Changes Based on Knowledge: If the question requires imaginative thinking or knowledge of natural scenes and physical laws, minor changes or additions that help fulfill the request are allowed. These changes should align with the natural world, physical principles, or the context of the question. However, large or inconsistent changes that break the scenes logic or introduce factual inaccuracies are not acceptable. The human answered image is just an example answer for your reference to understand how to answer this question. The AS does not need to be the same as the human answered image. You should assign score based on how well the images meet these criteria: 0: The AS cant be used for answering this question based on previous criteria. Compared with the AS, the human answered image is significantly better. 1: The AS can answer the question, but is worse than the human answered image in terms of quality. 2: The AS can answer the question with similar or better quality than the human answered image. { score : int, reason_of_score : Detailed explanation of the reasoning for the score. } Now give me the accuracy score and reason strictly following the json format: \"\"\" ###Assistant: {reason: The AS correctly provides the interior image of BMW car, which matches the request based on the exterior shown in the question image. The interior features, including the steering wheel with the BMW logo, dashboard, and overall design, are excellently captured without significant visual errors or missing elements. Also, the AS answer image is comparable in quality to the human answered image and fulfills the request fully., score: 2} Table 12 Example of IntelligentBench Evaluation: Please note that the \"Human answered image\" is simply label for the GPT-4os reference to the ground truth (GT) image, rather than an actual image generated by human."
        }
    ],
    "affiliations": [
        "ByteDance Seed",
        "Hong Kong University of Science and Technology",
        "Monash University",
        "Shenzhen Institutes of Advanced Technology",
        "UC Santa Cruz"
    ]
}