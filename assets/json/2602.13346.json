{
    "paper_title": "CellMaster: Collaborative Cell Type Annotation in Single-Cell Analysis",
    "authors": [
        "Zhen Wang",
        "Yiming Gao",
        "Jieyuan Liu",
        "Enze Ma",
        "Jefferson Chen",
        "Mark Antkowiak",
        "Mengzhou Hu",
        "JungHo Kong",
        "Dexter Pratt",
        "Zhiting Hu",
        "Wei Wang",
        "Trey Ideker",
        "Eric P. Xing"
    ],
    "sections": [
        {
            "title": "Abstract",
            "content": "Single-cell RNA-seq (scRNA-seq) enables atlas-scale profiling of complex tissues, revealing rare lineages and transient states. Yet, assigning biologically valid cell identities remains a bottleneck because markers are tissue- and state-dependent, and novel states lack references. We present CellMaster, an AI agent that mimics expert practice for zero-shot cell-type annotation. Unlike existing automated tools, CellMaster leverages LLM-encoded knowledge (e.g., GPT-4o) to perform on-the-fly annotation with interpretable rationales, without pre-training or fixed marker databases. Across 9 datasets spanning 8 tissues, CellMaster improved accuracy by 7.1% over best-performing baselines (including CellTypist and scTab) in automatic mode. With human-in-the-loop refinement, this advantage increased to 18.6%, with a 22.1% gain on subtype populations. The system demonstrates particular strength in rare and novel cell states where baselines often fail. Source code and the web application are available at \\href{https://github.com/AnonymousGym/CellMaster}{https://github.com/AnonymousGym/CellMaster}."
        },
        {
            "title": "Start",
            "content": "6 2 0 2 2 1 ] . - [ 1 6 4 3 3 1 . 2 0 6 2 : r CELLMASTER: COLLABORATIVE CELL TYPE ANNOTATION IN SINGLE-CELL ANALYSIS"
        },
        {
            "title": "A PREPRINT",
            "content": "Zhen Wang1,,, Yiming Gao2,, Jieyuan Liu1,, Enze Ma1, Jefferson Chen1, Mark Antkowiak5, Mengzhou Hu3, JungHo Kong3, Dexter Pratt3, Zhiting Hu1, Wei Wang4, Trey Ideker3, Eric P. Xing6,7 1Halicioglu Data Science Institute, University of California, San Diego, CA, USA 2Department of Electrical & Computer Engineering, Texas A&M University, College Station, TX, USA 3Department of Medicine, University of California, San Diego, CA, USA 4Department of Chemistry and Biochemistry, University of California San Diego, La Jolla, CA, USA 5Moores Cancer Center, University of California, San Diego, La Jolla, CA, USA 6Mohamed bin Zayed University of AI, Abu Dhabi, UAE 7School of Computer Science, Carnegie Mellon University, Pittsburgh, PA, USA February 17,"
        },
        {
            "title": "ABSTRACT",
            "content": "Single-cell RNA-seq (scRNA-seq) enables atlas-scale profiling of complex tissues, revealing rare lineages and transient states. Yet, assigning biologically valid cell identities remains bottleneck because markers are tissueand state-dependent, and novel states lack references. We present CellMaster, an AI agent that mimics expert practice for zero-shot cell-type annotation. Unlike existing automated tools, CellMaster leverages LLM-encoded knowledge (e.g., GPT-4o) to perform on-the-fly annotation with interpretable rationales, without pre-training or fixed marker databases. Across 9 datasets spanning 8 tissues, CellMaster improved accuracy by 7.1% over best-performing baselines (including CellTypist and scTab) in automatic mode. With human-in-the-loop refinement, this advantage increased to 18.6%, with 22.1% gain on subtype populations. The system demonstrates particular strength in rare and novel cell states where baselines often fail. Source code and the web application are available at https://github.com/AnonymousGym/CellMaster. Keywords Cell-type annotation, Large Language Models, Autonomous Agent, Human-in-the-loop, Zero-shot annotation"
        },
        {
            "title": "Introduction",
            "content": "Single-cell RNA-seq (scRNA-seq) has transformed the study of complex tissues by resolving closely related lineages and transient cellular states within their native contexts. Tissues such as PBMC and developmental liver contain fine-grained subtypes (e.g., Classical vs Non-classical monocytes; Regulatory vs Memory cells) and short-lived intermediates (hepatoblasts; intermediate mature Neutrophils; pre-B cells) whose marker usage is highly contextdependent. For example, while Alb, Cd79a, and S100a8 serve as canonical markers for hepatocytes, cells, and neutrophils, respectively, their effectiveness is dataset-dependent and not uniformly transferable. As single-cell atlases now span tens of millions of cells and over one hundred tissues [25, 26], scalable and biologically faithful cell type annotation has become central bottleneck for downstream analysis, interpretation, and cross-study integration. The classic approach relies on unsupervised clustering by human experts, finding differentially expressed marker genes for each cluster, and assigning identities by analyzing canonical and tissue-specific markers within developmental or Corresponding author: zhw085@ucsd.edu These authors contributed equally to this work. arXiv Template PREPRINT perturbation context [19, 4, 6]. While this produces high-quality labels, it is time-consuming, scales poorly to datasets, and becomes especially challenging for rare populations and transitional or novel states that lack consensus markers. The definition of cellular identities ultimately relies on expert interpretation to connect molecular signatures with true biological insights. Automated approaches reduce this burden through marker-table matching (e.g., CellMarker 2.0 [11]), reference label transfer (e.g., Seurat), or supervised classification (e.g., CellTypist [3], scTab [7]). Despite strong performance on common types, these methods rely on reference coverage and nomenclature alignment, which are sensitive to batch-, perturbation-, and domain-shifts, and tend to abstain or mis-assign when confronted with rare or truly novel states, e.g., CellTypist shows especially low performance when annotating clusters with <100 cells [6]. Crucially, their decisions are often difficult to audit biologically, limiting trust in exploratory settings. Recently, large language models (LLMs) have shown promise in performing cell annotation tasks. It has been found that GPT-4 can accurately assign cell type labels given list of differential genes for each cell type [10]. Moreover, human feedback on LLM-based predictions can improve cell type prediction, especially for certain biological contexts (e.g. tissue type) where human expertise is required [8, 30]. Such human-in-the-loop architectures have been explored for annotation, labeling, and expert-guided model refinement tasks in both general AI and biological domains. For instance, agentic frameworks that combine LLM reasoning with human oversight have been proposed to distill expert knowledge into artificial intelligence models [8], while domain-specific implementations such as scExtract [30] integrate LLM-based retrieval and annotation workflows with expert-curated validation to enhance single-cell data interpretation. However, task-grounded system for scRNA-seq that (a) reasons over markers in situ, (b) explains its decisions in biologically interpretable terms, and (c) operates zero-shot, i.e., without pretraining on task-specific labels or reliance on fixed marker tables, has not been established for cell-type annotation. To address this gap, we introduce CellMaster, an LLM-driven agent that mirrors an experts reasoning loop to deliver zero-shot, explainable cell-type labels by interpreting cluster-level DE markers together with dataset context and producing natural-language rationales without pretraining or fixed marker tables. The system performs biology-aware refinement, iteratively proposing and testing hypotheses to resolve near-neighbor confusions (e.g., NK vs cells) and escalating uncertain clusters for review, while maintaining sensitivity to rare and candidate-novel states. In addition, collaborative user interface (UI) allows experts to co-pilot the process, reviewing rationales, suggesting corrections, adjusting granularity, and leaving provenance-tracked comments, so that human judgment directly shapes final labels. We evaluated CellMaster across 9 datasets spanning 8 tissues, comparing against CellTypist, scTab, CellMarker 2.0, GPTCelltype and Biomni using average CL score with expert adjudication. CellMaster operationalizes the design principle of emulating human expert workflows with transparent reasoning and structured uncertainty handling to accelerate biologically faithful annotation in evolving atlases (Figure 1)."
        },
        {
            "title": "2 Related Works",
            "content": "The application of LLMs in biomedicine has progressed rapidly, from domain-specific text encoders such as BioGPT [20] to general-purpose reasoning models like GPT-4o. In single-cell analysis, early efforts followed two largely separate directions. The first comprises foundation models, including scBERT [33], scGPT [5], and Geneformer [28], which model genes as tokens to learn latent representations for tasks such as imputation and perturbation prediction. The second focuses on language-based interfaces, such as Cell2Sentence [24] and scChat [18], which enable natural-language querying of datasets and metadata. Despite their promise, both paradigms exhibit key limitations. Embedding-based models operate in opaque latent spaces that hinder interpretability, while language interfaces often function as thin wrappers around predefined execution pipelines, offering limited reasoning or adaptability. To bridge this gap, recent work has shifted toward autonomous agents that combine LLM reasoning with tool use. General biomedical agents like Biomni [12] demonstrate broad problem-solving capabilities, while single-cellspecific systems such as scAgent [21] and scPilot [9] formalize end-toend analytic workflows. Within this landscape, CASSIA [31] introduces multi-agent assembly line (Annotator, Validator, Scorer) for automated cell type annotation, and scRAG [34] improves cross-tissue generalization by augmenting LLM reasoning with retrieved structured knowledge (e.g., celltissue relationships). However, these systems primarily emphasize automated accuracy and typically operate as closed pipelines, delivering finalized results with limited opportunity for user intervention. Similarly, scPilot emphasizes systematic automation, while Biomni functions as comprehensive but heavyweight solver. In contrast, CellMaster is designed as lightweight, collaborative assistant that prioritizes iterative human-in-the-loop interaction. Rather than producing fixed output, CellMaster allows users to intervene during analysis, adjusting annota2 arXiv Template PREPRINT tion granularity (e.g., subdividing broad cell types), critiquing intermediate reasoning, or refining visual interpretations. This open-loop design transforms the LLM from black-box automation engine into responsive research partner, aligning computational reasoning with expert biological intuition and hypothesis-driven explorationcapabilities that are increasingly essential for evaluating agents on the rediscovery of scientific insights, as benchmarked by FIRE-Bench [29]. Additional Related Works can be found in the Supplement."
        },
        {
            "title": "3 Methodology",
            "content": "3.1 Data Sources and Pre-processing For quality control and preprocessing, all datasets listed in Supplement Table 1 were either obtained directly as processed single-cell datasets (Seurat or AnnData h5ad format) or downloaded as raw count matrices and subsequently processed following the original papers detailed instructions. We normalized total counts per cell using scanpy.pp.normalize_total, and applied log-transformation with scanpy.pp.log1p. The unsupervised clusters and ground truth annotations were directly borrowed from the metadata information of original datasets. 3.2 Iterative Annotation Pipeline Let represent our input single-cell dataset with cells, where each cells gene expression is denoted as xi RM for genes. At each iteration t, clusters are represented as = {C1, . . . , CK}, with annotations αt : {} mapping clusters to cell types or remaining undefined. Our pipeline iteratively refines cell type annotations through four specialized stages. The detailed prompts are described in Supplement G. 3.2.1 (i) Hypothesis Generation. This stage formulates and refines hypotheses regarding cell type distributions by analyzing differential gene expression patterns and prior annotation outcomes. Differential expression analysis is performed using the Wilcoxon rank-sum test implemented in Scanpy. For each cluster k, we identify and select the top genes exhibiting the highest average log-fold change (avg_log2FC). These genes provide the foundation for hypothesis refinement at each iteration. 3.2.2 (ii) Marker Selection. Based on the hypotheses generated, this stage proposes marker genes that can effectively distinguish specific cell types. It dynamically maintains and updates list of successful and failed marker genes from previous iterations, enabling adaptive refinement of marker gene proposals. The system strategically selects markers to clarify uncertain or previously unresolved clusters. 3.2.3 (iii) Expression Analysis. The expression analysis stage evaluates proposed marker genes by generating dotplots that visualize gene expression distributions across clusters. This analysis allows for verification of marker gene relevance, ensuring that proposed markers effectively discriminate between cell types and highlight distinct expression patterns. 3.2.4 (iv) Result Evaluation. This stage provides comprehensive evaluation of the expression analysis results at multiple levels: it assesses gene-level specificity, cluster-level marker signatures, and identifies similar cluster pairs along with their distinguishing features. Confidence scores are generated to quantitatively support annotation assignments, pinpointing clusters requiring further analysis. The recommendation for subsequent zoom-in cluster regions is also attached in the evaluation output. The annotation result is dynamically saved in the environment, while annotated h5ad object and the UMAP visualization of annotation are automatically generated in the folder. The system also integrates several adaptive heuristics including marker memory, confidence stabilization, cluster relationship analysis, and contamination detection rules (see Supplementary Methods for details). 3.3 Benchmark Design and Baselines To rigorously assess cell type annotation methods, we develop comprehensive evaluation framework inspired by the ontology-based scoring methodology employed by GPTCelltype. This framework encompasses systematic procedures, 3 arXiv Template PREPRINT including marker gene name standardization, ontology-based cell type mapping, hierarchical annotation structure construction, and quantitative agreement scoring. Such an ontology-driven approach ensures biologically coherent and meaningful comparisons between predicted annotations and established reference standards. We intentionally excluded large biological language models requiring extensive fine-tuning, such as scBERT and xTrimoGENE, from our benchmark evaluation due to two primary limitations: Dataset Bias: These models are predominantly pre-trained on datasets from blood and brain tissues (e.g., 71% of cells in scGPTs training data). Consequently, they exhibit performance biases when applied to datasets derived from less represented tissues, such as liver, limiting their generalizability. Computational Constraints: Fine-tuning these models even on relatively small datasets (approximately 10,000 cells) demands substantial GPU resources (e.g., at least 8GB of GPU memory post-optimization). Such computational requirements surpass the capacities commonly available in standard biological laboratories, posing significant practical barriers to adoption. 3.3.1 Baseline Methods Included Our benchmark incorporates four widely used cell type annotation tools, each exemplifying distinct methodologies ranging from database-driven annotation to advanced machine learning approaches: GPTCelltype [10]: This approach leverages straightforward LLM-based agent that utilizes the GPT-4 model to annotate cell clusters based on their top 10 marker genes. The annotations produced align directly with the original clustering provided. CellTypist [3]: machine learning-based classifier employing an extensive reference database of curated cell types. CellTypist offers over 50 pre-trained models tailored to diverse tissue contexts and conditions, providing annotations at the individual cell level rather than relying solely on predefined clusters. CellMarker 2.0 [11]: comprehensive database compiling manually curated, tissue-specific marker genes. It enables annotations by matching the top marker genes from each cluster against this curated reference. Like GPTCelltype, its annotations adhere directly to the original clustering scheme. scTab [7]: deep learning model is trained on an augmented dataset comprising 22.2 million cells, is designed specifically to improve generalizability through novel data augmentation strategies. scTab provides cell-level annotations independent of initial clustering. Biomni [12]: Biomni is LLMdriven framework designed for general-purpose biological reasoning across diverse omics modalities. It integrates large language models with structured biological knowledge and orchestrator-driven tools to perform tasks such as cell type annotation, functional interpretation, and hypothesis generation. In contrast, CellMaster integrates multi-agent LLM structure to comprehensively evaluate marker gene expression patterns within cell clusters. Unlike the baselines, CellMasters annotations are based primarily on initial clustering but can be refined iteratively using its integrated \"zoom-in\" feature for enhanced granularity. 3.4 Web Application and UI Design The web interface for CellMaster is implemented using React, structured around modular component architecture to enhance usability and facilitate interconnected analytical workflows. The Figure 2 shows the Panels of the CellMaster UI. The HypothesisInput component serves as the primary entry point, enabling users to upload single-cell data (H5AD format) and associated metadata through direct file selection or file-path specification. This component incorporates selector for automated pre-annotations using CellTypist models, alongside an Explore Cluster button to initiate analysis upon successful input validation. Additionally, Get Other Method button opens an auxiliary window showcasing alternative annotation methods, including predictions generated by CellTypist and GPT-based annotations. Visualization of results is centralized within the UMAP Plot Panel, which provides several critical interactive controls: Iteration Navigation (Previous/Next): Navigate through sequential analysis iterations. Stabilize Result: Permanently saves the current cluster annotations to prevent subsequent modifications. Auto Fill In: Automatically annotates unclassified clusters using machine learning-driven predictions. Zoom In: Generates detailed sub-clustering analysis on selected clusters, offering adjustable resolution (0.12.0). 4 arXiv Template PREPRINT Zoom Out: Reverts to the comprehensive dataset view while retaining annotations from sub-cluster analyses. Cluster Selection Checkboxes: Facilitates multi-cluster operations, available only for the latest iteration. Swap Icon: Allows toggling between different UMAP representations within the same iteration when multiple views exist. The DotPlot Panel visualizes gene expression patterns through dot size (representing the proportion of expressing cells) and color intensity (indicating expression levels). Integrated navigation controls allow exploration of expression data across iterations. The AnalysisResults Panel organizes findings into three specialized tabs: Hypothesis Tab: Presents current biological hypotheses derived from analysis. Marker Genes Tab: Lists proposed marker genes alongside their statistical significance. Iteration Summary Tab: Offers comprehensive conclusions and insights from each analytical iteration. The ExploreInput Component dynamically adjusts to each pipeline stage, providing tailored input fields to facilitate hypothesis refinement, experimental design formulation, contamination detection, and feedback-driven evaluation. Header controls include: Reset Button: Clears all progress and resets the analysis pipeline. Export Button: Creates and downloads ZIP archive containing annotated data (H5AD), the complete analysis history, and generated visualizations. Robust state management via React Context ensures seamless synchronization between components. Additionally, workflow orchestration is managed by the PipelineManager class, systematically guiding users through distinct analytical stages, hypothesis formulation, experiment design, environment analysis, rule specification, and evaluation, while providing real-time feedback and comprehensive error handling throughout the annotation process."
        },
        {
            "title": "4 Results",
            "content": "4.1 CellMaster architecture and workflow CellMaster is an advanced framework for single-cell RNA sequencing analysis, designed to harmonize automated efficiency with researcher-guided precision. Built upon the widely adopted Scanpy pipeline, the system transcends conventional manual annotation by integrating multi-agent large language model (LLM) architecture. This innovative approach supports two distinct modes: fully automated annotation pipeline and human-in-the-loop interactive workflow. By accommodating both strategies, CellMaster empowers researchers to align annotations with specific experimental hypotheses, bridging the gap between standardized computational methods and domain-specific biological insights. Given Scanpy object, the system runs an iterative loop: hypothesis generation marker gene proposal evidence synthesis label/abstain; and returns per-cluster labels, natural-language rationales, dotplots, and confidence score with recommended next steps (e.g., split/merge, add fine-grained markers, run downstream analysis tools). Each step prioritizes biological plausibility and interpretability, synthesizing marker gene expression within the broader experimental context to ensure annotations are both accurate and scientifically meaningful. defining strength of CellMaster lies in its accessibility and adaptability. Unlike traditional methods requiring computational expertise or reliance on pre-trained reference datasets, this framework democratizes single-cell analysis by eliminating technical barriers. Researchers can freely explore novel datasets without constraints imposed by existing atlases, while dynamically adjusting annotation granularity to suit specific investigative needs, from broad cellular categories to finely resolved subtypes. This flexibility is paired with significant efficiency gains, reducing the time and labor traditionally associated with manual annotation. CellMaster supports two modes. In automatic mode, the system iterates 3 loops as default, yielding complete label set with confidence scores. In human-in-the-loop mode, experts act as co-pilots via the collaborative UI, reviewing rationales, adding/removing markers, adjusting label granularity, and accepting or revising tentative calls. The UI preserves provenance for all edits and integrates seamlessly with downstream workflows by exporting an annotated Scanpy object. By merging transparency, customization, and computational power, CellMaster advances single-cell research toward more reproducible, hypothesis-driven discovery. arXiv Template PREPRINT 4.2 Benchmarking against state-of-the-art tools We benchmarked CellMaster on nine datasets (Liver, PBMC3k, BCL, Myeloid, Large PBMC, Brain, Large Intestine, Limb Muscle, and Retina) against four baseline tools: GPTCelltype, CellTypist, Cell Marker 2.0, and scTab. Clusterlevel labels were evaluated using GO-aware similarity rubric (full=1, partial=0.5, mismatch=0), averaged per dataset (macro) following GPTCelltype. Ground truth labels were taken from the original datasets and their corresponding publications. 4.2.1 Automatic Annotation Benchmarking Performances In CellMaster automatic mode evaluation, we ran CellMasters UI for three iterations with only the h5ad dataset and initial hypothesis as input (see Supplementary Information for an example). Unsolved clusters after three iterations were addressed using the auto fill in function. Pretrained models such as scTab and CellTypist showed brittleness under Seurat2/SCT preprocessing, requiring 10kcount normalization in several datasets and failing to match all genes in the Liver dataset. These failure issues illustrated the brittleness of fixed models to out-of-scope data, whereas our LLM-based approach adaptively circumvented such constraints. As shown in Figure 3a, across 9 datasets, CellMaster achieved an average performance of 0.602 0.058, outperforming best baseline performance of each dataset by 0.071 on average ( 13% relative improvement). Notably, Retina (0.705 vs 0.300 - 0.632) and Liver (0.55 vs 0.304 - 0.429) marked the largest gains, while performance remained robust when pretrained baselines failed. Across five runs per dataset, LLM-based methods showed modest variability (avg. s.d. 0.058 for CellMaster), with CellMaster outperforming GPTCelltype on 8/9 datasets, indicating reliable performance across tissues. We also compared CellMaster against Biomni (Base Model Gemini-2.5 Pro), another LLM agent based general biology solver. Across representative datasets, CellMaster consistently outperformed Biomni both in accuracy and stability. On PBMC3k, Retina, and Liver, CellMaster achieved scores of 0.725, 0.705, and 0.550, whereas Biomni obtained 0.646, 0.570, and 0.464, respectively. Variability was also lower for CellMaster (s.d. 0.086) compared to Biomni (s.d. up to 0.135). These results highlight that while both systems employ large language models, CellMaster design, integrating structured multi-agent reasoning and iterative feedback, yields more reliable and biologically valid annotations. 4.2.2 CellMaster successfully handles challenging edge cases and rare cell groups To further elucidate the strengths of CellMaster, we performed fine-grained analysis comparing its performance with GPTCelltype and CellTypist. Our analysis focused on three key aspects: annotation granularity (major cell types versus subtypes), performance across broader cell type categories, and the impact of cell and cluster number distinctions. CellMaster demonstrated significant improvement in sub cell types and small cell groups. Major cell types and subtypes. Biologists often annotate datasets with coarse labels for less emphasized cell types and finer subtypes for those of particular interest. For example, in the Liver dataset, cells are labeled generically as cell, whereas in immune cell datasets such as PBMC3k and Zheng68k, cells are subdivided into CD4 and CD8 cells, among others. This has been proved important in the recent large-scale atlases of diverse cell states [13]. As shown in Figure 3e, CellMaster significantly outperformed both GPTCelltype and CellTypist in annotating both major cell types and their subtypes. Broader cell type. We also evaluated representative broad cell types common in single-cell RNA sequencing datasets (e.g., cells, cells, NK cells, and dendritic cells). As shown in Figure 3e, CellMaster matched baseline performance for cells and NK cells while substantially outperforming them for cells and neural populations. Overall, CellMaster consistently exceeded GPTCelltype and CellTypist across most broad cell types. Cell and cluster number distinctions. We further analyzed the relationship between dataset composition and annotation performance, specifically examining the number of clusters per dataset, the number of cells in the entire dataset, and the number of cells per cluster. As shown in Figure 3e, CellMaster consistently outperformed baseline tools across various conditions: when datasets contained more or fewer than 10 cell types, when clusters had fewer than 100, between 100 and 1,000, or more than 1,000 cells, and when the total dataset size exceeded or fell below 45,000 cells. In contrast, CellTypist, when annotating clusters with <100 cells, had especially low performance compared with annotating larger clusters. 6 arXiv Template PREPRINT CellMaster Annotation Workflow Example Input (Liver Development Dataset) Dataset: 41,000 mouse liver cells, 2,000 genes, spanning five developmental stages. Objective: Characterize hepatocytes, cells, cells, and endothelial cells to study liver development. Structured Workflow in CellMaster 1. Initial Hypothesis: Provide project background and expected cell types. 2. Refined Hypothesis: Elaborate on annotation goals (e.g., highlight specific lineages). 3. Marker Gene List: Add or adjust marker genes to tailor reference panels. 4. Dot Plot Review: Inspect expression patterns across clusters and flag uncertainties. 5. Iteration Feedback: Evaluate and refine annotations until satisfactory solution is reached. Box 1: Overview of the CellMaster annotation workflow. 4.3 Human-AI collaboration significantly enhances annotation accuracy We evaluated human-in-the-loop CellMaster under 3 interaction budget ( 3 human inputs each iteration, 1 sentence max for one-time input), where an expert reviewed rationales, supplied brief textual guidance, and acted on uncertainty escalations. Compared to no-feedback (automatic) CellMaster, accuracy improved by 0.115 0.085. The collaborative UI exposes rationales, intermediate step dotplots, confidence scores, \"recommend next step\" actions, and the result UMAP annotation plot for each iteration. It also records all human inputs / interventions with provenance so accepted and revised labels are fully reviewable in downstream analyses. 4.3.1 Integration of Manual Annotation Workflow with CellMaster UI Manual annotation of single-cell data typically requires experts to assemble marker gene lists, examine dot plots, and assign cell-type identities based on domain knowledge. We implemented this workflow directly into the CellMaster web-based interface, enabling experts to formalize their reasoning, provide iterative feedback, and refine computational predictions without departing from familiar practices. The interface operates locally with private model API keys, ensuring data confidentiality, while guiding users through structured cycle of hypothesis formulation, marker selection, visualization, and iterative refinement. This design preserves expert control while enhancing reproducibility and interpretability. To illustrate the process, an example use case was shown in Box 1, where researchers studying liver development iteratively combined marker-based reasoning with computational outputs. By embedding these steps into an interactive interface, CellMaster lowered the barrier for adoption and promoted deeper engagement with annotation customization, bridging expert biological insight with scalable computational analysis. 4.3.2 Human-in-the-loop CellMaster Consistently Outperforms No-feedback CellMaster In Figure 3b, we demonstrate that CellMasters performance steadily improves with human feedback, achieving an average score margin of 0.115 over the automatic CellMaster, thus surpassing all the benchmark baselines. In human-inthe-loop mode, the tester utilized the CellMaster UI to review intermediate step outputs and provided concise feedback, typically in single sentence. For benchmarking, we opted for general suggestions as input rather than specific requirements for single cluster or cell type. Additionally, we did not use the zoom-in function in the CellMaster UI to maintain consistent granularity across the benchmark. Typical human input was brief (e.g., Explore additional immune subtypes\"), yet sufficient to redirect analysis toward ambiguous regions flagged by the system. CellMaster reacted with this reasoning: In this iteration, we identified immune cells such as cells. Lets explore the presence of other immune cell types.\" Such feedback avoided inflation of false positives, showing that minimal human input could substantially boost annotation quality. Furthermore, in Figure 3c, we compared the standard deviations of CellMasters performance across five experimental runs on the liver dataset in both automatic and human-in-the-loop modes. With three annotation iterations and the auto-fill-in functionality enabled, the human-in-the-loop feedback consistently outperformed the automated approach, demonstrating greater stability and reliability in cell type annotation. 7 arXiv Template PREPRINT 4.4 Interpreting CellMasters decision-making process Inspection of rationales across 9 datasets revealed recurring patterns: marker-conflict resolution (e.g., Cd3d vs Nkg7), developmental context usage (e.g., Afp for hepatoblast vs Alb for hepatocyte), and regulon-supported decisions (IRF8 for pDC). In the following case study, we demonstrated how the model continued to improve through iterations without human feedback and traced back the rationale for this enhancement. 4.4.1 Case Study: Leveraging CellMaster for Biological Insights To demonstrate CellMasters ability to generate actionable biological insights, we simulated beginner user analyzing developmental mouse Liver dataset (41,000 cells) without prior tissue knowledge. Starting from coarse hypothesis, CellMaster iteratively proposed labels, flagged uncertain clusters, and suggested zoom-ins on Neutrophils and cells based on evidence summaries. The workflow reproduced key findings from the original study and generated additional hypotheses, including novel subsets within neutrophils/B cells supported by marker sets and developmental patterns. These insights were elaborated in the collaborative UI and exported for downstream validation in Figure 4. 4.4.2 Annotation Process Simulation Dataset description and hypothesis were entered as: 41,000 cells across five developmental stages. . . likely cell types include T, B, hepatocytes, endothelial. . . . Two automatic iterations with one brief instruction, Look for complicated clusters and identify their types, yielded major cell types upleft UMAP in Figure 4. In iteration 2, CellMaster recommended subgrouping Neutrophils, prompting the user to zoom in and generate six subclusters. Leveraging the developmental context, CellMaster proposed immature, intermediate, and mature neutrophil states supported by marker genes (Lcn2, Ltf, Camp, Mmp9). Sub-clusters were annotated based on marker strength and developmental stage (Lcn2/Ltf/Camp for immature, partial Ltf for intermediate, and Mmp9 for mature). The user accepted the rationale, merged the subsets, and obtained an updated UMAP automatically. CellMasters subset annotations aligned with the datasets developmental context and were supported by rationales, dot plots, and UMAPs. The biologically plausible labels matched the original publication, highlighting CellMaster ability to deliver actionable insights with minimal user input. 4.4.3 Comparison with baseline and broader implications Unlike manual or static marker-based approaches, CellMaster employs iterative feedback and context-aware reasoning to deliver more nuanced subtype annotations. Compared to GPTCelltype, which occasionally proposed contextinconsistent neutrophil subtypes, CellMaster reduced off-target labels by grounding decisions in marker evidence and dataset-specific context. Additional lineage vignette parallel analysis of the B-cell compartment reached similar granularity: after two automated iterations, CellMaster flagged clusters rich in canonical B-cell markers and guided zoom-in that resolved pro-B, large/small pre-B, and naive states (Supplementary Figure 7). This illustrates cross-lineage generalization of the insight-generation module. 4.5 Ablation study of CellMaster 4.5.1 CellMaster base model vs performance To study the difference between large backbone models in CellMaster, we conducted the ablation study on three datasets: PBMC3k, Liver, and Retina. We selected 4 OpenAI API models: gpt-4o (original CellMaster), gpt-4o-mini, o1, o1-mini along with 2 Gemini API models: gemini-2.0-flash, gemini-2.5-pro. For each model, we run the standard CellMaster in automatic mode 3 times on each dataset. These experiments were inherited from scPilot [9], our prior work that established the foundation for CellMasters agentic architecture. While GPT-4o provided balanced baseline across all datasets (Supp. Fig. 6g), the o1 model improved accuracy in PBMC3k and Retina but declined in the Liver dataset, suggesting potential over-reasoning on complex data. Lightweight variants (gpt-4o-mini, o1-mini) were less consistent, with occasional competitive results but generally higher variability. The Gemini series showed sufficient performance but did not surpass o1. Overall, gpt-4o remains reliable default, while o1 demonstrates potential for stronger performance at the cost of robustness. 8 arXiv Template PREPRINT 4.5.2 Iterational performance shift in automatic CellMaster Supplement Figure 6 illustrates the iterative improvement of CellMaster on the Liver dataset, which consists of 28 clusters (labeled 0 to 27) containing diverse range of hepatocytes and non-parenchymal cells (NPCs). We ran CellMaster in automatic mode, same as benchmarking. The performance improved monotonically from 0.179 (2 correct, 6 partial out of 28) at iteration 1, 0.446 (major cell types identified) at iteration 2, to 0.607 by iteration 4 as the plateau. However, in iteration 5, the score dropped to 0.482 and CellMaster abstained on the previously annotated clusters. Early iteration improvement. CellMaster exhibits clear improvement trajectory across multiple iterations, in both automatic and human-in-the-loop modes. By surfacing intermediate step outputs in the user interface, the system enables transparent, white-box annotation process where users can track refinements as they unfold. This iterative setup not only corrects earlier misclassifications but also sharpens cluster-level accuracy. For instance, in cluster 6, the second iteration corrected an initial mislabeling of Kupffer cells/resident macrophages\" to the more precise Kupffer cells.\" Similarly, the same cell type may vary in annotation accuracy across clusters: clusters 1, 18, and 23 were all identified as Endothelial Cells,\" yet only cluster 1 achieved full accuracy (> 95%), whereas clusters 18 and 23 were only partially correct. Together, these patterns highlight how iterative refinement improves both label precision and interpretability. Decreased CellMaster performance in additional iterations. We observed performance drop at Iteration 5 in Supplement Figure 5 and conducted an ablation study on three datasets (PBMC3k, BCL, Liver), each annotated three times. Without human feedback, CellMaster typically peaked within three to five iterations, after which accuracy stabilized or declined. Early iterations (14) progressively resolved unsolved clusters, but once all clusters were labeled, further gains required human input. In automatic mode, however, CellMaster reconsidered already solved clusters, generated new marker gene lists that sometimes replaced key markers with weaker alternatives. This reduced dot plot interpretability and increases annotation errors. For instance, in the Liver dataset at iteration 5, the omission of Afp, critical hepatoblast marker, caused cluster 16 to be mislabeled as Hepatocyte\" rather than Hepatoblast\". Similarly, cluster 14, mixture of dendritic subtypes, was not definitively resolved. As result, performance fell to 0.482, below CellMaster peak accuracy. These findings motivate conservative early-stop in automatic mode (3 iterations in benchmarking) and reliance on uncertainty escalation to focus expert effort where it adds the most value."
        },
        {
            "title": "5 Discussions",
            "content": "CellMasters state-of-the-art performance across diverse datasets demonstrates the transformative potential of LLMdriven adaptive reasoning for cell type annotation. Unlike static models such as CellTypist and CellMarker 2.0, CellMaster leverages LLMs reasoning to dynamically adapts to novel contexts without retraining, while providing interpretable rationales. Tracing reasoning steps such as Neutrophil subtype differentiation in the Liver case study shows CellMaster capability to address the trust deficit common in AI tools. The iterative refinement mechanism, improving scores from 0.196 to 0.643 in the Liver dataset, demonstrates how LLMs can simulate expert-like hypothesis testing, marked advance over deterministic tools The 0.115 average performance gain with human feedback highlights the critical role of expert intuition in guiding AI. CellMasters UI design, which embeds biologist workflows, enables seamless collaboration, contrasting with black-box tools. However, ablation studies reveal performance plateaus and drops in no-feedback mode after 35 iterations (Supplementary Figure 6f), underscoring AIs current reliance on human oversight for nuanced decisions and to prevent model overconfidence, challenge observed in other LLM applications."
        },
        {
            "title": "6 Limitations",
            "content": "While CellMaster is effective, several limitations remain. First, the probabilistic nature of LLMs introduces stochasticity, resulting in slightly higher run-to-run variability (mean s.d. 0.058) than simpler baselines such as GPTCelltype (0.053), despite stabilization mechanisms. Second, dependence on commercial model APIs raises cost and privacy concerns for regulated settings. Third, evaluation based on Cell Ontology mapping may bias assessment against genuinely novel cell states absent from existing hierarchies. Finally, the current framework is limited to unimodal transcriptomics, with multi-omics integration left for future work. 9 arXiv Template PREPRINT"
        },
        {
            "title": "7 Conclusion",
            "content": "CellMaster redefines cell annotation by synergizing LLMs adaptive reasoning with biologist expertise through an intuitive, iterative interface. Its out performance of existing tools (Figure 3a) across major tissues and subtypes, coupled with robust handling of edge cases, positions it as versatile solution for diverse single-cell studies. The frameworks emphasis on interpretability and human collaboration addresses critical barriers in AI adoption for life sciences. Future work should focus on reducing stochasticity via constrained decoding and expanding ontology coverage to emerging cell types. Future work will focus on reducing stochasticity via constrained decoding, expanding ontology coverage, and integrating multi-modal data including scATAC-seq and spatial transcriptomics. By democratizing expert-level annotation, CellMaster accelerates the transition from data generation to biological insight."
        },
        {
            "title": "8 Ethics and Data Use",
            "content": "This study relies exclusively on publicly available, anonymized datasets derived from prior publications (see Supplement Table 1). No new human subjects data were generated, collected, or processed for this work. Consequently, this study constitutes secondary analysis of de-identified data and is exempt from Institutional Review Board (IRB) oversight."
        },
        {
            "title": "9 Data and Code Availability",
            "content": "All of the processed scRNA-seq datasets used in CellMaster benchmarking are publicly sourced collections. The datasets are detailed in Table 1. For each dataset, we release the processed objects (H5AD format for scRNA datasets, and csv format for DEG data), along with cell-type labels. The complete source code for CellMaster itself, dataset preprocessing, evaluation metrics, and benchmark drivers is released under the MIT license and available at https://github.com/AnonymousGym/CellMaster."
        },
        {
            "title": "References",
            "content": "[1] 10x Genomics. 10x genomics 3k pbmcs dataset. https://support.10xgenomics.com/ single-cell-gene-expression/datasets/1.1.0/pbmc3k, 2017. Accessed: 2025-05-15. [2] Dvir Aran, Agnieszka P. Looney, Leqian Liu, Esther Wu, Valerie Fong, Austin Hsu, Suzanna Chak, Ram P. Naikawadi, Paul J. Wolters, Adam R. Abate, Atul J. Butte, and Mallar Bhattacharya. Reference-based analysis of lung single-cell sequencing reveals transitional profibrotic macrophage. Nature Immunology, 20(2):163172, 2019. [3] C. Domínguez Conde, C. Xu, L. B. Jarvis, D. B. Rainbow, S. B. Wells, T. Gomes, S. K. Howlett, O. Suchanek, K. Polanski, H. W. King, L. Mamanova, N. Huang, P. A. Szabo, L. Richardson, L. Bolt, E. S. Fasouli, K. T. Mahbubani, M. Prete, L. Tuck, N. Richoz, Z. K. Tuong, L. Campos, H. S. Mousa, E. J. Needham, S. Pritchard, T. Li, R. Elmentaite, J. Park, E. Rahmani, D. Chen, D. K. Menon, O. A. Bayraktar, L. K. James, K. B. Meyer, N. Yosef, M. R. Clatworthy, P. A. Sims, D. L. Farber, K. Saeb-Parsy, J. L. Jones, and S. A. Teichmann. Cross-tissue immune cell analysis reveals tissue-specific features in humans. Science, 376(6594):eabl5197, 2022. [4] The Tabula Muris Consortium. single-cell transcriptomic atlas characterizes ageing tissues in the mouse. Nature, 583(7817):590595, 2020. [5] Haotian Cui, Chloe Wang, Hassaan Maan, Kuan Pang, Fengning Luo, and Bo Wang. scgpt: Towards building foundation model for single-cell multi-omics using generative ai. bioRxiv, 2023. [6] Domínguez Conde, Xu, LB Jarvis, DB Rainbow, SB Wells, Gomes, SK Howlett, Suchanek, Polanski, HW King, et al. Cross-tissue immune cell analysis reveals tissue-specific features in humans. Science, 376(6594):eabl5197, 2022. [7] Felix Fischer, David S. Fischer, Roman Mukhin, Andrey Isaev, Evan Biederstedt, Alexandra-Chloé Villani, and Fabian J. Theis. sctab: Scaling cross-tissue single-cell annotation models. Nature Communications, 15(1), 2024. [8] Jiayuan Gao, Yingwei Zhang, Yiqiang Chen, Yihan Dong, Yuanzhe Chen, Shuchao Song, Boshi Tang, and Yang Gu. Agent-in-the-loop to distill expert knowledge into artificial intelligence models: survey. Artificial Intelligence Review, 2025. [9] Yiming Gao, Zhen Wang, Jefferson Chen, Mark Antkowiak, Mengzhou Hu, JungHo Kong, Dexter Pratt, Jieyuan Liu, Enze Ma, Zhiting Hu, and Eric P. Xing. scpilot: Large language model reasoning toward automated single-cell analysis and discovery. In The Thirty-ninth Annual Conference on Neural Information Processing Systems, 2025. 10 arXiv Template PREPRINT [10] Wenpin Hou and Zhicheng Ji. Assessing gpt-4 for cell type annotation in single-cell rna-seq analysis. Nature Methods, 21(8):14621465, 2024. [11] Congxue Hu, Tengyue Li, Yingqi Xu, Xinxin Zhang, Feng Li, Jing Bai, Jing Chen, Wenqi Jiang, Kaiyue Yang, Qi Ou, Xia Li, Peng Wang, and Yunpeng Zhang. Cellmarker 2.0: an updated database of manually curated cell markers in human/mouse and web tools based on scrna-seq data. Nucleic Acids Research, 51(D1):D870D876, 10 2022. [12] Kexin Huang, Serena Zhang, Hanchen Wang, Yuanhao Qu, Yingzhou Lu, Yusuf Roohani, Ryan Li, Lin Qiu, Junze Zhang, Yin Di, et al. Biomni: general-purpose biomedical ai agent. bioRxiv, pages 202505, 2025. [13] H. Kay Chung, Cong Liu, Anamika Battu, Alexander N. Jambor, Brandon M. Pratt, Fucong Xie, Brian P. Riesenberg, Eduardo Casillas, Ming Sun, Elisa Landoni, Yanpei Li, Qidang Ye, Daniel Joo, Jarred Green, Zaid Syed, Nolan J. Brown, Mattew Smith, Shixin Ma, Shirong Tan, Brent Chick, Victoria Tripple, Z. Audrey Wang, Jun Wang, Bryan Mcdonald, Peixiang He, Qiyuan Yang, Timothy Chen, Siva Karthik Varanasi, Michael LaPorte, Thomas H. Mann, Dan Chen, Filipe Hoffmann, Josephine Ho, Jennifer Modliszewski, April Williams, Yusha Liu, Zhen Wang, Jieyuan Liu, Yiming Gao, Zhiting Hu, Ukrae H. Cho, Longwei Liu, Yingxiao Wang, Diana C. Hargreaves, Gianpietro Dotti, Barbara Savoldo, Jessica E. Thaxton, J. Justin Milner, Susan M. Kaech, and Wei Wang. Atlas-guided discovery of transcription factors for cell programming. bioRxiv, 2025. [14] Ilya Korsunsky, Nghia Millard, Jean Fan, Kamil Slowikowski, Fan Zhang, Kevin Wei, Yuriy Baglaenko, Michael Brenner, Po-ru Loh, and Soumya Raychaudhuri. Fast, sensitive and accurate integration of single-cell data with harmony. Nature Methods, 16(12):12891296, 2019. [15] Yan Liang, Kota Kaneko, Bing Xin, Jin Lee, Xin Sun, Kun Zhang, and Gen-Sheng Feng. Temporal analyses of postnatal liver development and maturation by single-cell transcriptomics. Developmental Cell, 57(3):398414.e5, 2022. [16] Nianping Liu, Chen Jiang, Xinfeng Yao, Minghao Fang, Xiaolong Qiao, Lin Zhu, Zongcheng Yang, Xuyuan Gao, Ying Ji, Chaoshi Niu, Chuandong Cheng, Kun Qu, and Jun Lin. Single-cell landscape of primary central nervous system diffuse large b-cell lymphoma. Cell Discovery, 9(1):55, 2023. [17] Romain Lopez, Jeffrey Regier, Michael B. Cole, Michael I. Jordan, and Nir Yosef. Deep generative modeling for single-cell transcriptomics. Nature Methods, 15(12):10531058, 2018. [18] Yen-Chun Lu, Ashley Varghese, Rahul Nahar, Hao Chen, Kunming Shao, Xiaoping Bao, and Can Li. scchat: large language model-powered co-pilot for contextualized single-cell rna sequencing analysis. bioRxiv, 2024. [19] Malte Luecken and Fabian Theis. Current best practices in single-cell rna-seq analysis: tutorial. Molecular systems biology, 15(6):e8746, 2019. [20] Renqian Luo, Liai Sun, Yingce Xia, Tao Qin, Sheng Zhang, Hoifung Poon, and Tie-Yan Liu. Biogpt: generative pre-trained transformer for biomedical text generation and mining. Briefings in Bioinformatics, 23(6):bbac409, 09 2022. [21] Yuren Mao, Yu Mi, Peigen Liu, Mengfei Zhang, Hanqing Liu, and Yunjun Gao. scagent: Universal single-cell annotation via llm agent, 2025. [22] Madhvi Menon, Shahin Mohammadi, Jose Davila-Velderrain, Brittany A. Goods, Tanina D. Cadwell, Yu Xing, Anat Stemmer-Rachamimov, Alex K. Shalek, John Christopher Love, Manolis Kellis, and Brian P. Hafler. Singlecell transcriptomic atlas of the human retina identifies cell types associated with age-related macular degeneration. Nature Communications, 10:4902, 2019. [23] Aviv Regev, Sarah Teichmann, Eric Lander, Ido Amit, Christophe Benoist, Ewan Birney, Bernd Bodenmiller, Peter Campbell, Piero Carninci, Menna Clatworthy, Hans Clevers, Bart Deplancke, Ian Dunham, James Eberwine, Roland Eils, Wolfgang Enard, Andrew Farmer, Lars Fugger, Berthold Göttgens, Nir Hacohen, Muzlifah Haniffa, Martin Hemberg, Seung Kim, Paul Klenerman, Arnold Kriegstein, Ed Lein, Sten Linnarsson, Emma Lundberg, Joakim Lundeberg, Partha Majumder, John Marioni, Miriam Merad, Musa Mhlanga, Martijn Nawijn, Mihai Netea, Garry Nolan, Dana Peer, Anthony Phillipakis, Chris Ponting, Stephen Quake, Wolf Reik, Orit RozenblattRosen, Joshua Sanes, Rahul Satija, Ton Schumacher, Alex Shalek, Ehud Shapiro, Padmanee Sharma, Jay Shin, Oliver Stegle, Michael Stratton, Michael Stubbington, Fabian Theis, Matthias Uhlen, Alexander van Oudenaarden, Allon Wagner, Fiona Watt, Jonathan Weissman, Barbara Wold, Ramnik Xavier, Nir Yosef, and Human Cell Atlas Meeting Participants. Science forum: The human cell atlas. eLife, 6:e27041, dec 2017. [24] Syed Asad Rizvi, Daniel Levine, Aakash Patel, Shiyang Zhang, Eric Wang, Curtis Jamison Perry, Nicole Mayerli Constante, Sizhuang He, David Zhang, Cerise Tang, et al. Scaling large language models for next-generation single-cell analysis. BioRxiv, pages 202504, 2025. 11 arXiv Template PREPRINT [25] Mengnan Shi, Loren Méar, Max Karlsson, María Álvez Bueno, Andreas Digre, Rutger Schutten, Borbala Katona, Jimmy Vuu, Emil Lindström, Feria Hikmet, Han Jin, Meng Yuan, Xiangyu Li, Hong Yang, Xiya Song, Evelina Sjöstedt, Fredrik Edfors, Per Oksvold, Kalle von Feilitzen, Martin Zwahlen, Mattias Forsberg, Fredric Johansson, Jan Mulder, Tomas Hökfelt, Yonglun Luo, Lynn Butler, Wen Zhong, Adil Mardinoglu, Åsa Sivertsson, Fredrik Ponten, Linn Fagerberg, Cecilia Lindskog, Mathias Uhlén, and Cheng Zhang. resource for whole-body gene expression map of human tissues based on integration of single cell and bulk transcriptomics. Genome Biology, 26:152, 2025. [26] Xiaoying Shi, Yu Zhiguang, Pengfei Ren, Xin Dong, Xuanxin Ding, Jiaming Song, Jing Zhang, Taiwen Li, and Chenfei Wang. Husch: an integrated single-cell transcriptome atlas for human tissue gene expression visualization and analyses. Nucleic Acids Research, 51(D1):D1029D1038, 2024. [27] Tabula Muris Consortium. Single-cell transcriptomics of 20 mouse organs creates tabula muris. Nature, 562:367372, 2018. [28] Christina V. Theodoris, Ling Xiao, Anant Chopra, Mark D. Chaffin, Zeina R. Al Sayed, Matthew C. Hill, Helene Mantineo, Elizabeth M. Brydon, Zexian Zeng, X. Shirley Liu, and Patrick T. Ellinor. Transfer learning enables predictions in network biology. Nature, 618(7965):616624, 2023. [29] Zhen Wang, Fan Bai, Zhongyan Luo, Jinyan Su, Kaiser Sun, Xinle Yu, Jieyuan Liu, Kun Zhou, Claire Cardie, Mark Dredze, Eric P. Xing, and Zhiting Hu. Fire-bench: Evaluating agents on the rediscovery of scientific insights, 2026. [30] Yuxuan Wu and Fuchou Tang. scextract: leveraging large language models for fully automated single-cell rna-seq data annotation and prior-informed multi-dataset integration. Genome Biology, 26:174, 2025. [31] Elliot Xie, Lingxin Cheng, Jack Shireman, Yujia Cai, Jihua Liu, Chitrasen Mohanty, Mahua Dey, and Christina Kendziorski. Cassia: multi-agent large language model for automated and interpretable cell annotation. Nature Communications, 17(1):389, 2025. [32] Chuan Xu, Martin Prete, Simone Webb, Laura Jardine, Benjamin J. Stewart, Regina Hoo, Peng He, Kerstin B. Meyer, and Sarah A. Teichmann. Automatic cell-type harmonization and integration across human cell atlas datasets. Cell, 186(26):58765891.e20, 2023. [33] Fan Yang, Wenchuan Wang, Fang Wang, Yuan Fang, Duyu Tang, Junzhou Huang, Hui Lu, and Jianhua Yao. scbert as large-scale pretrained deep language model for cell type annotation of single-cell rna-seq data. Nature Machine Intelligence, 4(10):852866, 2022. [34] Zhiyin Yu, Chao Zheng, Chong Chen, Xian-Sheng Hua, and Xiao Luo. scRAG: Hybrid retrieval-augmented generation for LLM-based cross-tissue single-cell annotation. In Wanxiang Che, Joyce Nabende, Ekaterina Shutova, and Mohammad Taher Pilehvar, editors, Findings of the Association for Computational Linguistics: ACL 2025, pages 954970, Vienna, Austria, July 2025. Association for Computational Linguistics. [35] Grace X. Y. Zheng, Jessica M. Terry, Phillip Belgrader, Paul Ryvkin, Zachary W. Bent, Ryan Wilson, Solongo B. Ziraldo, Tobias D. Wheeler, Geoff P. McDermott, Junjie Zhu, Mark T. Gregory, Joe Shuga, Luz Montesclaros, Jason G. Underwood, Donald A. Masquelier, Stefanie Y. Nishimura, Michael Schnall-Levin, Paul W. Wyatt, Christopher M. Hindson, Rajiv Bharadwaj, Alexander Wong, Kevin D. Ness, Lan W. Beppu, H. Joachim Deeg, Christopher McFarland, Keith R. Loeb, William J. Valente, Nolan G. Ericson, Emily A. Stevens, Jerald P. Radich, Tarjei S. Mikkelsen, Benjamin J. Hindson, and Jason H. Bielas. Massively parallel digital transcriptional profiling of single cells. Nature Communications, 8:14049, 2017. 12 arXiv Template PREPRINT (a) System pipeline: three specialized agents Figure 1: Overview of CellMaster architecture and workflow. (Hypothesis, Proposal, Annotation) coordinate to iteratively refine cell type annotations from user-provided data and context. (b) Example human-AI dialogue showing iterative annotation refinement on PBMC dataset. 13 arXiv Template PREPRINT Figure 2: CellMaster web interface. (a) Main annotation view with input, dotplot, chatbot, and analysis panels. (b) Zoom-in/out functionality for sub-clustering selected cell populations. (c) Analysis panel showing hypothesis and marker gene lists. (d) Annotation panel with interactive UMAP and cluster controls. 14 arXiv Template PREPRINT Figure 3: Benchmarking results. (a) Performance heatmap (CL score) comparing CellMaster against four baselines across 9 datasets; white indicates method failure. (b) Head-to-head comparison with Biomni on three representative datasets. (c) Iterative improvement: automatic vs. human-in-the-loop mode on Liver dataset across iterations. (d) Dot plot showing per-dataset performance for automatic (red) and human-in-the-loop (green) modes. (e) Stratified bar chart analysis by cell type category, annotation granularity, dataset size, and cluster size. 15 arXiv Template PREPRINT Figure 4: Case study: Neutrophil subtype resolution in developmental liver. CellMaster recommends sub-clustering Neutrophils, proposes developmental stage markers (LCN2, LTF, MMP9), and provides rationales for immature, intermediate, and mature neutrophil assignments. Final annotations are merged back into the full dataset. 16 arXiv Template PREPRINT"
        },
        {
            "title": "A Additional Related Works",
            "content": "Trends in Single-cell Analysis. The scale of single-cell RNA sequencing (scRNA-seq) has grown exponentially, propelled by large consortia. such as the Human Cell Atlas (HCA) [23]. As datasets reach millions of cells, analysis has shifted beyond coarse clustering toward resolving fine-grained and continuous cellular heterogeneity. Cell identity is now understood as dynamic spectrum shaped by developmental trajectories, microenvironments, and disease states [19]. However, capturing such subtle structure remains computationally difficult. Although integration methods such as Harmony [14] and scVI [17] effectively mitigate batch effects, they often over-smooth data in latent space, obscuring rare or transient biological states. Preserving biologically meaningful variation while controlling technical noise thus remains central challenge in large-scale single-cell analysis. Advancements in Cell Type Annotation. Cell type annotation underpins most downstream single-cell analyses. Traditional manual annotation, based on expert inspection of marker genes, is interpretable and accurate but inherently unscalable. To address this, reference-based automated methods such as SingleR [2] and CellTypist [3] have been widely adopted. While efficient, these approaches are constrained by reference bias: they can only assign labels present in the training atlas, forcing novel or contextspecific cell states into existing categories. Moreover, biological cell identities are hierarchical and context-dependent, whereas most automated tools produce flat, fixed labels. This mismatch limits their ability to support hypothesis-driven exploration and nuanced biological interpretation, highlighting the need for more flexible annotation frameworks."
        },
        {
            "title": "B Dataset Information Details",
            "content": "The benchmark evaluation of CellMaster utilizes nine diverse scRNA-seq datasets spanning eight different tissues to ensure comprehensive assessment of the systems cross-tissue generalization and performance. These datasets include human and mouse samples such as Liver (mouse liver), PBMC and Large PBMC (human peripheral blood), BCL (human lymphoma), Myeloid (human bone marrow), and Brain, Large Intestine, and Limb Muscle from the Tabula Muris collection. Each dataset was selected to represent varying levels of biological complexity, ranging from the well-defined populations in the 10x PBMC dataset to the intricate developmental stages and fine-grained subtypes found in the mouse liver and human retina datasets. Detailed metadata, including the original source publications and the total cell counts, which range from approximately 2,600 cells to over 65,000 cells, are consolidated in Supplementary Table 1 to provide clear reference for the benchmarks scope. Dataset name Tissue Source Table 1: Benchmark dataset metadata and sizes Liver PBMC BCL Myeloid Large PBMC Brain Large Intestine mouse intestine Limb Muscle Retina mouse muscle human retina Developmental Cell Paper [15] 10x Demonstration Dataset [1] Cell Discovery Paper [16] mouse liver human PBMC human lymphoma human bone marrow CellTypist Demonstration Dataset [32] human PBMC mouse brain Nature Communications Paper [35] Tabular Muris [27] Tabular Muris [27] Tabular Muris [27] Nature Communications Paper [22] Dataset size 41,000 cells 2,000 genes 2,638 cells 13,714 genes 49,910 cells 25,780 genes 51,552 cells 36,601 genes 65,943 cells 17,732 genes 7,856 cells 23,341 genes 3,938 cells 23,341 genes 3,900 cells 23,341 genes 20,091 cells 19,719 genes"
        },
        {
            "title": "C Supplementary Methods",
            "content": "C.1 Adaptive Heuristics Our system integrates several adaptive mechanisms to enhance annotation accuracy and robustness: Marker Memory. To optimize marker gene selection across iterations, the system maintains record of successful and unsuccessful marker genes. For gene g, its status is determined by: statusg = (cid:26)success, fail, if : scorek,g 0.7 maxj(scorej,g) otherwise (1) 17 arXiv Template PREPRINT where scorek,g is combined measure of expression level and fraction of expressing cells in cluster k. gene is considered successful if its combined expression score meets or exceeds numeric threshold, specifically success_threshold = 0.7. Genes failing to meet this criterion are flagged accordingly, guiding future marker proposals. Confidence Stabilization. To ensure stable annotations, the system employs z-score-based confidence assessment. Annotations are preserved if their corresponding z-scores, computed as normalized expression values, surpass defined threshold (Z 2.0). Clusters that do not meet this confidence criterion are flagged for further refinement in subsequent iterations. Cluster Relationship Analysis. The pipeline identifies clusters with similar expression profiles to guide targeted refinement through sub-clustering. For clusters and j, similarity is assessed through: sim(i, j) = {g : log2(Ei,g) log2(Ej,g) > τ or Fi,g Fj,g > δ} (2) where Ek,g is expression level, Fk,g is fraction of expressing cells, τ and δ are expression and fraction thresholds respectively, and is the maximum allowed number of distinguishing genes. Similarity between clusters is assessed based on differential expression and fraction thresholds, highlighting pairs of clusters with limited distinguishing genes. This analysis aids in clarifying ambiguous annotations and refining cell type assignments. Contamination Rules. The pipeline integrates contamination detection to identify and manage data quality concerns, such as potential doublets and mitochondrial contamination. Specifically, clusters exceeding predetermined doublet ratio threshold or flagged due to elevated mitochondrial fractions are reviewed, ensuring annotation reliability and dataset integrity."
        },
        {
            "title": "D Evaluation Metrics",
            "content": "D.1 Cleaning and Standardizing Cell Type Names Raw cell type names often exhibit inconsistencies such as mixed casing, redundant suffixes, or ambiguous abbreviations. To address this, cleaning and standardization process was applied: Automatic Cleaning: Plural forms (e.g., cells) were singularized, redundant whitespace and punctuation removed, and biologically relevant symbols (e.g., slashes /) retained. Standardized Mapping: Cleaned names were first matched to predefined dictionary of standard cell type nomenclature. For unmatched names, language model dynamically generated standardized mappings to handle uncommon or ambiguous terms. This process harmonized all cell type names, enabling consistent downstream analysis. D.2 Mapping to Cell Ontology Identifiers Standardized names were mapped to terms in the Cell Ontology (CL) to integrate annotations with structured biological knowledge: Ontology Querying: Standardized names were queried against the Cell Ontology via an automated search, retrieving corresponding ontology identifiers (CLIDs) and their higher-level categories. Handling Unmapped Names: Unmapped names were retained for manual review or further processing. This mapping ensured systematic alignment between predicted and reference annotations. D.3 Construction of the Ontology Tree The hierarchical relationships within the Cell Ontology were leveraged to evaluate lineage-based relationships between predicted and reference annotations: 18 arXiv Template PREPRINT Ontology Hierarchy Parsing: The Cell Ontology was retrieved in OWL format, from which parent-child relationships were extracted. Graph Construction: directed acyclic graph (DAG) was constructed with nodes representing CLIDs and edges denoting parent-child relationships. This hierarchical structure enabled evaluation beyond direct matches, incorporating extended lineage-based relationships. D.4 Ontology-Based Scoring Framework Following the ontology-based scoring methodology established by GPTCelltype, scoring framework incorporating both exact and hierarchical matches was developed: Exact Match: score of 1.0 was assigned for identical predicted and reference CLIDs. Partial Match: score of 0.5 was assigned when predicted CLIDs matched parent or child terms of reference CLIDs. No Match: score of 0.0 was assigned for no ontology overlap. This scoring framework allowed biologically meaningful comparisons while accounting for the hierarchical structure of the Cell Ontology. D.5 Biological Context Validation To ensure biological relevance, predictions underwent an additional validation step: Relative Identification: Predictions were validated by cross-checking against parent and child terms related to the reference CLIDs within the ontology graph. Broad Type Consistency: Predictions were compared at higher-level ontology categories (e.g., immune cells, stromal cells) to ensure broad biological consistency. D.6 Summary The evaluation methodology systematically integrates name cleaning, dynamic ontology mapping, and hierarchical scoring for biologically accurate assessment. Leveraging both exact and hierarchical ontology matches, the framework enables robust and biologically meaningful evaluation of cell type annotations."
        },
        {
            "title": "E Statistical Analysis",
            "content": "All statistics were performed in Python 3.11 using Scanpy 1.10, Scipy 1.13, Numpy 1.26 and statsmodels 0.14. Differential gene-expression was computed with the two-sided Wilcoxon rank-sum test as implemented in scanpy.tl.rank_genes_groups(method=\"wilcoxon\"). Raw P-values were adjusted for multiple testing with the BenjaminiHochberg FDR procedure; genes with adjusted value <0.05 and log2 fold change > 1 were considered significant. Cluster-level confidence scores are z-scores of log-normalized expression (In Expression Analysis of Iterative Annotation). Benchmark performance was evaluated with the ontology metric of GPTCelltype. Agreement scores (exact = 1.0, parent/child = 0.5, no match = 0) were averaged across clusters; Differences between methods were tested using paired Wilcoxon signed-rank test across the nine datasets; FDR was controlled at 5%. All tests were two-sided unless noted."
        },
        {
            "title": "F Comprehensive Feature Comparison with Existing Paradigms",
            "content": "To rigorously position CellMaster within the current annotation landscape, we evaluated it against three established workflows: (1) Standard Automated Tools (e.g., CellTypist), which offer speed but are limited by fixed references; (2) Generic GPT-based approaches, which provide zero-shot capabilities but lack domain-specific grounding; and (3) Manual Annotation, which remains the gold standard for accuracy but is labor-intensive. As detailed in Supplementary Table 2, traditional automated tools excel in efficiency but lack the flexibility to handle novel cell states or user-defined granularity without retraining. Conversely, while manual annotation allows for high 19 arXiv Template PREPRINT Feature CellMaster GPT-based Manual Annot. Automated Tools Ease of Use (No specialized biological knowledge required) User-Friendliness (No coding/scripting required) Efficiency (Low time and effort overhead) Data Flexibility (No pre-training dataset limit) Out-of-the-Box Availability (No external reference construction) Flexible Granularity (Adjustable resolution of annotation) Personalization Options (Supports user-defined hypothesis) Table 2: Detailed feature comparison of annotation paradigms. We contrast CellMaster with GPT-based prompts (e.g., GPTCelltype), Manual Annotation (standard Seurat/Scanpy workflow), and Automated Tools (e.g., SingleR, CellTypist). denotes native support; denotes lack of support or requirement for significant workaround. personalization and depth, it scales poorly with dataset size. CellMaster bridges this gap by combining the out-of-thebox\" availability of Large Language Models with the user-defined granularity typically reserved for manual curation. Unlike static classifiers, CellMaster allows users to guide the resolution of annotation (e.g., Immature Neutrophil\" vs. \"Neutrophil\") through natural language, feature absent in both standard automated tools and rigid GPT scripts."
        },
        {
            "title": "G Detailed workflow of CellMaster agents",
            "content": "Below are the detailed prompts and functions used in the multi-agent framework for CellMaster cell type annotation. CellMaster Prompt for Cell-type Annotation Hypothesis Generation stage: CellMaster integrates the top marker genes per cluster, dataset context, and (optionally) information from previous iterations to create hypothesis about the dataset. content = f\"Top {len(self.top_genes)} differentially expressed genes: {self.top_genes}\" if self.reference_dict: content += f\"You can refer to the possible cell types of these top genes in this dictionaryself.reference_dict\" content += f\"Current Hypothesis:self.hypothesis\" if annotation_dict: content += f\"The cell type annotation from previous iterations annotation_dict\" if no_gene_cluster: content += f\"Clusters without need to be focused on: {no_gene_cluster}\" if iteration_summary: content += f\"This is summary of previous iteration annotation, with information of next steps to take. iteration_summary\" system_role = \"You are research assistant specializing in cell biology. Based on top differentially expressed genes, previous cell type annotation (if provided), Clusters without need to be focused on (if provided), summary of previous iteration annotation (if provided), and failed genes (if provided), refine the given hypothesis to be more accurate and specific.\" CellMaster Prompt for Cell type annotation - marker gene proposal Marker Selection stage: CellMaster specifically proposes marker gene list for the cell types of interest. 20 arXiv Template PREPRINT prompt = You are bioinformatics expert specializing in liver cell annotation. Your task is to propose an experiment for cell type annotation based on the following information: Refined hypothesis: self.hypothesis Instructions: 0. We have already labeled some of clusters, the information is in annotation_dict 1. a) The most important unsolved clusters are no_gene_cluster. b) Other cell types in annotation_dict is cell types we labeled with high or low confidence. We first need to decide whether we should annotate them again. 2. For the cell types we have already successfully used, the gene marker list is successful_genes. For large cell types like hepatocyte or cell, the remaining clusters might still contain them, but for smaller cell types you dont need to think about them again. For the marker genes we already used but did not detect any expression, the list is failed_genes. So you dont need to try these gene and related cell type again. 3. Do not specify the cluster with cell type here. You can just output cell type and related marker genes. 4. Only provide proposal of unlabeled clusters, consider potential overlaps in marker gene expression between cell types: a) Name of the cell type b) 3-5 marker genes Output format: 1. List of cell types with their markers: [Cell Type 1]: Gene A; Gene B; Gene [Cell Type 2] ... 2. Python list of all marker genes: MARKER_GENES = [GeneA, GeneB, GeneC, ...] Remember: - Be specific and concise in your descriptions. - Ensure all cell types have at least 3 marker genes. - Include the Python list of all marker genes at the end of your response, dont use any backtick. system_role = \"You are an AI trained to design scientific experiments based on hypotheses and background information.\" CellMaster Functions - Expression Analysis Expression Analysis stage: CellMaster quantifies and contrasts gene expression programs across identified clusters to derive both broad markers and nuanced distinctions. First, average expression and detection fraction matrices are computed for each genecluster pair. High-confidence markers are nominated by threshold filtering (identify_marker_genes), ensuring each candidate meets user-defined minima for mean expression and prevalence. To harmonize gene-wise dynamic ranges, CellMaster supports either Z-score normalization (zscore_normalize_expression) or minmax scaling (min_max_scale_expression). For clustercluster comparisons, log2fold changes are calculated (compute_logfc), and genes that satisfy combined criteria on expression, detection fraction, and absolute fold change (identify_distinguishing_markers) are flagged as distinguishing markers. Finally, by surveying all cluster pairs with relaxable gene-difference tolerance (find_similar_cluster_pairs), the module reveals pairs of clusters that share overall transcriptional landscapes but diverge by only small set of signature genes, facilitating downstream analyses such as targeted sub-clustering or lineage trajectory inference based on these key transcriptional shifts. identify_marker_genes Iterates over each cluster (rows of dotplot_data) and each gene (columns) to select those with mean expression exp_thresh and fraction expressing frac_thresh. Returns marker_genes dictionary mapping clusters to lists of candidate markers. zscore_normalize_expression Applies per-gene Z-score (zero mean, unit variance) transformation across clusters: normalizedg,c = exprg,c µg σg , where µg, σg are the mean and standard deviation of gene g. min_max_scale_expression Scales each genes expression into [0,1]: exprg,c minc(exprg,c) maxc(exprg,c) minc(exprg,c) . 21 arXiv Template PREPRINT compute_logfc Computes log2 fold-change between two clusters with pseudocount 1: log2 (cid:0)exprg, cluster1 + 1(cid:1) log2 (cid:0)exprg, cluster2 + 1(cid:1). identify_distinguishing_markers First computes log-fold change via compute_logfc, then selects genes satisfying: at least one clusters expression exp_thresh, fraction frac_thresh, and absolute log-fold change logfc_thresh. Returns list of genes distinguishing the two clusters. find_similar_cluster_pairs Examines every unordered pair of clusters, applies identify_distinguishing_markers with relaxed thresholds (exp_diff_thresh, frac_diff_thresh, logfc_thresh), and retains pairs whose number of differing genes is max_diff_genes. Outputs list of (cluster1, cluster2, diff_genes) tuples. CellMaster Prompt for Cell type annotation - evaluation Result Evaluation stage: CellMaster analyzes the dotplot expression data, and makes comprehensive evaluation about the expression and thus perform prediction. content = Context: You are working on single-cell RNA sequencing cell type annotation task. The goal is to identify distinct cell types based on gene expression patterns. You have created dotplot using set of marker genes to visualize gene expression across different clusters. MUST remember: you should list the cell types here. All cell types you refer to, should be in here. possible_cell_types Data: For each cluster, the top genes are in this dictionary: marker_genes The clusters cannot find top genes are: empty_keys These are the genes that are successfully (highly) expressed in some clusters: success_list These are the genes that are failed to express in any clusters: fail_list There are some clusters that have similar expression, so we did differential expression analysis for these cluster pairs. The pairs and top differential genes are in: similar_clusters_dict Add-on: Duplet and Contamination in dotplot: duplet_rule Any other important instructions: contamination_rule Please give greatest attention to the Add-on part, if they are provided. Make sure to use them in your analysis. Instructions: Please analyze the provided data and answer the following questions: 1. Gene-level analysis: a) Which genes are highly expressed in specific clusters? Provide detailed description. b) Are there any genes that show differential expression across clusters (high in some, low in others)? c) Are there any genes that are not informative for cell type annotation (low expression across all clusters)? You should answer this question based on negation of 1b. 2. Cluster-level analysis: a) Are there any clusters that lack high expression of any marker gene? If so, list the cluster numbers. There are in total cluster_size clusters, index from 0. 3. Overall assessment: a) Based on the gene expression patterns, are there distinct clusters that potentially represent different cell types? b) Can you assign specific cell type identities to any of the clusters based on the marker gene expression? If so, provide your cell type annotations. You should only assign one cell type to each cluster. No doublet or contamination here. c) To refine the cell type annotation, recommend possible additional cell types. d) To refine the cell type annotation, recommend any particular cluster to perform subgrouping. 4. Confidence assessment: a) What are confidence levels of your annotation? Please also assign confidence score to the process name you selected. This score should follow the name in parentheses and range from 0.00 to 1.00. score of 0.00 indicates the lowest confidence, while 1.00 reflects the highest confidence. This score helps gauge how accurately the annotation is. Your choices of confidence score should be normal distribution (average = 0.5) You should consider if the annotation is widely seen, using deterministic wording and following background of dataset. For instance, if you label doublet, or using word \"probable\", the score should be lower. b) Based on confidence levels, what are the annotation results that you want to \"stabilize\", that is not change in next steps? if iteration is 1, you should choose top 1/3 confident clusters. if iteration is 2 and beyond, you should choose top 2/3 or more clusters. You can choose this threshold. Please provide your answers in structured JSON format, addressing each question separately using \"1a\" \"2a\" etc. 22 arXiv Template PREPRINT Remember, this is one iteration cell type annotation for liver scRNA-seq dataset. Your insights will guide further refinement of the analysis. system_role = \"You are an expert bioinformatician specializing in single-cell RNA sequencing data analysis and cell type annotation.\" Details of UI Inputs and Outputs: Example Figure 5 presents the complete CellMaster web interface during an annotation session on the Liver dataset. The interface is organized into five main components: Navigation and Controls. The top bar displays the pipeline progress through six stages (Hypothesis, Marker Genes, Environment, Optional Rules, Contamination, and Evaluation), with the current stage highlighted. Header controls include font size adjustment, Reset button to restart the analysis, and an Export button to download results. Input Data Panel. Located in the upper left, this panel accepts user inputs including: iteration number, clustering method selection (e.g., seurat_clusters), optional CellTypist model for reference annotations, H5AD file path (liver_sample.h5ad), metadata file, and free-text project description. In this example, the user describes developmental liver study spanning five timepoints (Day 1, 3, 7, 21, and 56) with expected cell types including hepatocytes, NK cells, and cells. The Explore Cluster button initiates the annotation pipeline. Analysis Results Panel. The upper right panel displays CellMaster outputs organized into three tabs: Hypothesis (showing the refined hypothesis with predicted cell types and their marker genes), Marker Genes (listing proposed markers), and Iteration Summary (comprehensive conclusions). The example shows CellMaster hypothesizing that Hepatocytes will be identified in clusters 3, 10, 21, and 27 based on Apoa2, Apoc1, Apoc3, and Alb expression. Visualization Panels. The lower section contains two visualization panels. The Gene Expression Dot Plot (left) displays marker gene expression across clusters, with dot size indicating fraction of expressing cells and color intensity indicating expression level. The UMAP Plot (right) shows the annotated dataset with 28 clusters labeled by cell type (e.g., Cells, Endothelial Cells, Hepatocytes, Kupffer Cells). Checkboxes allow users to select clusters for zoom-in analysis, with resolution slider (0.12.0) controlling sub-clustering granularity. Action buttons include Stabilize Result, Auto Fill In, Subsetting, and Merge Back. Feedback Interface. The bottom panel provides chat-style interface for human-in-the-loop interaction. Users can provide feedback such as use Nkg7 for NK cell to guide subsequent iterations. The system prompts users to review evaluation results and either provide feedback or press Enter to proceed to the next iteration. I"
        },
        {
            "title": "Iterative Annotation Performance Dynamics",
            "content": "Subfigures ae: singledataset evolution. The first five panels in Figure6 tracked CellMasters fullyautomated performance over five successive annotation cycles on the Liver dataset. Accuracy rose monotonically from iteration 1 to iteration 4. This confirmed the agents iterative feedback-driven refinements continually annotate blank clusters and correct early mis-labels, incorporating new marker evidence. noticeable decline occurred at iteration 5, suggesting that, beyond certain point, the marginal benefit of further automated updates is outweighed by error propagation (e.g. compounding low-confidence predictions) and by the diminishing pool of yet-unrefined clusters. Subfigure f: threedataset ablation. To verify that this pattern is not datasetspecific, we repeated the analysis on PBMC, BCL, and Liver data (8 iterations each run, 3 runs each dataset). All three curves displayed the same qualitative trend: peak accuracy was reached between the third and fifth iteration, with the exact optimum shifting slightly according to dataset complexity. Prolonged unattended cycling beyond this point produced mild but consistent drop, mirroring the singledataset findings. Interpretation and recommended practice. The transient downturn is best understood as form of over-iteration: once high-confidence clusters have stabilized, the agent is left to re-interrogate shrinking subset of ambiguous cells. Iterative self-correction without fresh external cues can then amplify spurious signals, eroding global accuracy. In practice we therefore (i) limit unattended runs to 3 iterations by default in automatic version, (ii) present Stabilize Result option in the UI version to lock converged labels, and (iii) encourage brief manual review before authorizing additional cycles. These safeguards preserve the demonstrable gains of iterative refinement while preventing the late-cycle regressions observed in Figure 6. 23 arXiv Template PREPRINT Biological insight example of B-Cell subgrouping To demonstrate cross-lineage generalization of CellMasters insight-generation module, we performed parallel analysis on the B-cell compartment in the developmental liver dataset. After initial annotation iterations, the Evaluation module flagged cells as candidates for further exploration, noting that additional cell types to explore could include subtypes of cells based on the developmental stages of liver (pre-B, pro-B, etc) (Figure 7, top-right, Evaluation panel). Following user input (Lets look at cell subtypes based on context!), CellMaster zoomed into B-cell clusters 0, 7, and 20 from the original UMAP (Figure 7, top-left) and generated 6 sub-clusters at resolution 0.3 (Figure 7, middle-left, Subclustering panel). The Hypothesis module framed the task around developmental B-cell biology, proposing four canonical stages appropriate for neonatal liver: pro-B, large pre-B, small pre-B, and naive cells (Figure 7, right, Hypothesis panel). Corresponding marker genes were selected: Cd19/Ebf1/Vpreb1 for pro-B cells, Cd79a/Igll1 for large pre-B cells, Rag1/Pax5 for small pre-B cells, and Ms4a1/Cd22 for naive cells (Figure 7, right, Marker genes panel). The dotplot visualization (Figure 7, middle-center) confirmed distinct expression patterns across sub-clusters, with Ebf1 and Vpreb1 enriched in clusters 0 and 5, Cd79a/Cd79b/Igll1 in cluster 1, Rag1 in cluster 2, and Ms4a1 in clusters 34. Based on these patterns, the Annotation module assigned subtypes with marker-based rationales (Figure 7, right, Evaluation panel): clusters 0 and 5 as Pro-B Cells (Cd19, Ebf1, Il7r, Vpreb1); cluster 1 as Large Pre-B Cells (Cd79a, Cd79b, Igll1); cluster 2 as Small Pre-B Cells (Rag1, Rag2, Pax5); and clusters 3 and 4 as Naive Cells (Cd19, Cd22, Igk, Ms4a1). Upon user confirmation, the resolved subtypes were merged back into the original dataset (Figure 7, bottom-left), showing distinct Pro-B, Large Pre-B, Small Pre-B, and Naive populations integrated alongside other liver cell types. This analysis recapitulates the established B-cell developmental trajectory in fetal and neonatal liver, demonstrating that CellMasters reasoning framework generalizes across immune lineages without requiring lineage-specific retraining or marker databases."
        },
        {
            "title": "K Author contributions statement",
            "content": "Z.W., Y.G., and J.L. conceived the study and designed the core methodology. Z.W. and Y.G. implemented the computational models and performed the primary experiments. J.L. led construction of the UI. J.L. and E.M. processed the datasets and conducted the evaluation analysis. J.C. assisted with software engineering and data visualization. M.A, M.H., J.K., and D.P. provided biological data resources and domain expertise. Z.H. and W.W. contributed to the theoretical framework and provided critical feedback on the machine learning approach. T.I. and E.P.X. supervised the research, and provided overall project guidance. Z.W., Y.G., and J.L. wrote the initial manuscript. All authors reviewed and approved the final manuscript. 24 arXiv Template PREPRINT Figure 5: Complete CellMaster web interface example. Screenshot showing an annotation session on the developmental Liver dataset. The interface includes: (top) pipeline progress indicator and controls; (upper left) input panel for data upload and project description; (upper right) analysis results with hypothesis, marker genes, and iteration summary tabs; (lower left) gene expression dot plot; (lower right) interactive UMAP with cluster selection and sub-clustering controls; (bottom) chat interface for human-in-the-loop feedback. arXiv Template PREPRINT Figure 6: Ablation studies: iteration dynamics and backbone model comparison. (ae) UMAP visualizations showing CellMaster annotation progression across five iterations on the Liver dataset, with CL scores improving from 0.179 to 0.607 before declining at iteration 5. (f) Performance trajectories across iterations for PBMC, BCL, and Liver datasets, demonstrating peak accuracy at iterations 35. (g) Comparison of six LLM backbone models (gpt-4o, gpt-4o-mini, o1, o1-mini, Gemini-2.0 Pro, Gemini-2.5 Pro) across three datasets. Error bars indicate standard deviation over three runs. Results inherited from scPilot [9]. 26 arXiv Template PREPRINT Figure 7: B-cell subtype resolution in developmental liver. Top-left: initial UMAP with B-cell clusters (0, 7, 20) prior to subgrouping. Middle-left: sub-clustered cells (6 clusters at resolution 0.3). Middle-center: dotplot showing developmental marker expression (Ebf1, Il7r, Vpreb1, Cd79a, Cd79b, Igll1, Rag1, Ms4a1) across sub-clusters. Right panels: CellMaster workflow including Evaluation recommendation, Hypothesis generation, Marker gene selection, and Annotation rationales. Bottom-left: final merged UMAP with resolved B-cell subtypes (Pro-B, Large Pre-B, Small Pre-B, Naive B) integrated into the full dataset."
        }
    ],
    "affiliations": [
        "Department of Chemistry and Biochemistry, University of California San Diego",
        "Department of Electrical & Computer Engineering, Texas A&M University",
        "Department of Medicine, University of California, San Diego",
        "Halicioglu Data Science Institute, University of California, San Diego",
        "Mohamed bin Zayed University of AI",
        "Moores Cancer Center, University of California, San Diego",
        "School of Computer Science, Carnegie Mellon University"
    ]
}