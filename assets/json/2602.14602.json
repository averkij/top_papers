{
    "paper_title": "OPBench: A Graph Benchmark to Combat the Opioid Crisis",
    "authors": [
        "Tianyi Ma",
        "Yiyang Li",
        "Yiyue Qian",
        "Zheyuan Zhang",
        "Zehong Wang",
        "Chuxu Zhang",
        "Yanfang Ye"
    ],
    "sections": [
        {
            "title": "Abstract",
            "content": "The opioid epidemic continues to ravage communities worldwide, straining healthcare systems, disrupting families, and demanding urgent computational solutions. To combat this lethal opioid crisis, graph learning methods have emerged as a promising paradigm for modeling complex drug-related phenomena. However, a significant gap remains: there is no comprehensive benchmark for systematically evaluating these methods across real-world opioid crisis scenarios. To bridge this gap, we introduce OPBench, the first comprehensive opioid benchmark comprising five datasets across three critical application domains: opioid overdose detection from healthcare claims, illicit drug trafficking detection from digital platforms, and drug misuse prediction from dietary patterns. Specifically, OPBench incorporates diverse graph structures, including heterogeneous graphs and hypergraphs, to preserve the rich and complex relational information among drug-related data. To address data scarcity, we collaborate with domain experts and authoritative institutions to curate and annotate datasets while adhering to privacy and ethical guidelines. Furthermore, we establish a unified evaluation framework with standardized protocols, predefined data splits, and reproducible baselines to facilitate fair and systematic comparison among graph learning methods. Through extensive experiments, we analyze the strengths and limitations of existing graph learning methods, thereby providing actionable insights for future research in combating the opioid crisis. Our source code and datasets are available at https://github.com/Tianyi-Billy-Ma/OPBench."
        },
        {
            "title": "Start",
            "content": "Opbench: Graph Benchmark to Combat the Opioid Crisis Tianyi Ma1, Yiyang Li1, Yiyue Qian3, Zheyuan Zhang1, Zehong Wang1, Chuxu Zhang2, and Yanfang Ye1 1University of Notre Dame, 2University of Connecticut, 3Amazon {tma2, yli62}@nd.edu, yyqian5@gmail.com, {zzhang42, zwang43}@nd.edu, chuxu.zhang@uconn.edu, yye7@nd.edu"
        },
        {
            "title": "1 Introduction",
            "content": "6 2 0 2 6 1 ] . [ 1 2 0 6 4 1 . 2 0 6 2 : r The opioid epidemic continues to ravage communities worldwide, straining healthcare systems, disrupting families, and demanding urgent computational solutions. To combat this lethal opioid crisis, graph learning methods have emerged as promising paradigm for modeling complex drug-related phenomena. However, significant gap remains: there is no comprehensive benchmark for systematically evaluating these methods across real-world opioid crisis scenarios. This gap persists due to three key challenges: (i) the multidimensional nature of the crisis spanning the supply and demand sides of the drug ecosystem, (ii) the structural complexity of drugrelated data involving heterogeneous and higher-order interactions, and (iii) the scarcity of publicly available annotated datasets due to privacy constraints and labor-intensive expert labeling. To bridge this gap, we introduce Opbench, the first comprehensive opioid benchmark comprising five datasets across three critical application domains: opioid overdose detection from healthcare claims, illicit drug trafficking detection from digital platforms, and drug misuse prediction from dietary patterns. Specifically, Opbench incorporates diverse graph structures, including heterogeneous graphs and hypergraphs, to preserve the rich and complex relational information among drug-related data. To address data scarcity, we collaborate with domain experts and authoritative institutions to curate and annotate datasets while adhering to privacy and ethical guidelines. Furthermore, we establish unified evaluation framework with standardized protocols, predefined data splits, and reproducible baselines to facilitate fair and systematic comparison among graph learning methods. Through extensive experiments, we analyze the strengths and limitations of existing graph learning methods, thereby providing actionable insights for future research in combating the opioid crisis. Our source code and datasets are available at https://github.com/Tianyi-Billy-Ma/OPBench."
        },
        {
            "title": "Keywords",
            "content": "Benchmark, Opioid Crisis, Graph Learning The work is not related to the position at the corresponding institution. Corresponding Author. Permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page. Copyrights for third-party components of this work must be honored. For all other uses, contact the owner/author(s). KDD 26, August 913, 2026, Jeju, Korea 2026 Copyright held by the owner/author(s). ACM ISBN 978-x-xxxx-xxxx-x/YY/MM https://doi.org/10.1145/nnnnnnn.nnnnnnn The global opioid crisis has become one of the most devastating public health emergencies, exacting an immense toll on human lives, healthcare systems, and socioeconomic stability [82]. The epidemic imposes substantial economic burden, costing an estimated $1.5 trillion per year in healthcare spending, lost productivity, and criminal justice expenses [23, 53]. Beyond economic costs, the crisis profoundly disrupts families and communities, with nearly 105,000 individuals dying from opioid overdoses in 2023, representing staggering tenfold increase from 1999 [5, 8], which calls for imminent actions to address this issue. To combat the devastating and lethal opioid crisis, graph learning methods [19, 20, 38, 50, 73, 86] have emerged as compelling paradigm, owing to their capacity in learning latent structural patterns and rich relational information inherent in complex real-world systems [79]. For example, DDHGNN [81] proposes dynamic heterogeneous graph neural network that models interactions among patients, drugs, physicians, and pharmacies over time to identify patients at risk of overprescription and potential overdose, demonstrating the strong capabilities of graph learning methods for combating the opioid crisis. Although graph learning methods have shown promising progress in combating the opioid crisis, no comprehensive benchmark exists to systematically evaluate and compare these methods across realworld scenarios. This gap persists due to three key challenges. (i) The opioid crisis is inherently multidimensional, spanning both the supply and demand sides of the drug ecosystem, requiring benchmarks that cover diverse application scenarios. On the supply side, opioid over-prescription in healthcare systems places patients at heightened risk of addiction and fatal overdose [64, 68, 81], and illicit drug traffickers increasingly exploit digital platforms to evade detection and reach consumers directly [3, 41, 42]. On the demand side, individuals susceptible to substance dependency often remain unidentified until addiction has taken hold, particularly in selfmedication scenarios where individuals may not recognize their own misuse [9, 54, 88]. (ii) Real-world drug-related data exhibits structural complexity with heterogeneous and higher-order interactions that simple homogeneous graphs may fail to model adequately. For example, in social networks, illicit drug trafficking activities often involve group-wise interactions among multiple users, playing various roles including sellers, buyers, and discussants [3, 33, 49]. (iii) The publicly available, annotated datasets remain scarce due to privacy regulations and the need for domain expertise in labeling. Annotation of drug-related data is particularly labor-intensive, as it requires clinical experts to identify complex medical phenomena [25, 80] or legal expertise to distinguish illicit activities that vary across jurisdictions [28, 29]. KDD 26, August 913, 2026, Jeju, Korea Tianyi Ma et al. To this end, we introduce Opbench, the first comprehensive OPioid Benchmark that covers five datasets to evaluate graph learning methods on real-world scenarios to combat the opioid crisis systematically. Specifically, to tackle the first challenge, Opbench covers three critical application domains in both supply and demand sides of the drug ecosystem, namely (1) Opioid Overdose Detection, which identifies patients at risk of opioid overdose from healthcare claims data; (2) Online Illicit Drug Trafficking Detection that uncover illicit drug-related activities on digital platforms; and (3) Drug Misuse Prediction to leverage nutritional patterns as novel biomarkers for substance dependency. To address the second challenge, Opbench incorporates diverse graph structures, including heterogeneous graphs, multi-relation graphs, and hypergraphs to capture the intricate dependencies and rich semantic information characterizing the opioid crisis. To address the third challenge, we collaborate with domain experts and authoritative institutions to curate and annotate datasets while adhering to strict privacy and ethical guidelines. We release Opbench following standardized protocols with predefined data splits, evaluation metrics, and reproducible baselines to facilitate fair and systematic comparison. Through comprehensive experiments, we analyze the strengths and limitations of existing graph learning methods, providing actionable insights for future research in combating the opioid crisis. Our main contributions are summarized as follows: First Comprehensive Benchmark. Opbench is the first comprehensive graph benchmark that enables fair and systematic comparison among graph learning methods by standardized experiment settings across five benchmark datasets that mimic the real-world scenarios to combat the severe opioid crisis. Systematic Empirical Analysis. We conduct comprehensive experiments across heterogeneous graphs, multi-relational graphs, and hypergraphs, revealing actionable insights into the strengths and limitations of existing graph learning methods for combating the opioid crisis. Open-Sourced Benchmark Library. We release Opbench as an easy-to-use open-sourced benchmark library to support further research and evaluation for drug-related downstream tasks. With our library, researchers and practitioners can seamlessly evaluate their algorithms on datasets, including but not limited to graphs, heterogeneous graphs, and hypergraphs."
        },
        {
            "title": "2 Backgrounds\n2.1 Preliminary",
            "content": "In this section, we provide preliminary definitions for graph, heterogeneous graph, and hypergraph, which are the fundamental data structures in our benchmark. Definition 2.1. (Graph.) graph is denoted as = {V, E, X}, comprising set of nodes and edges E. Here, represents set of node (and edge) attribute features. Definition 2.2. (Heterogeneous Graph.) heterogeneous graph (HG) is defined as Ghg = (V, E, X, A, R), where is node set with node type set and is the edge set with relation type set R. Here, = {Xùê¥ ùê¥ A} represents set of the node attribute feature matrix Xùê¥ RùëÅùê¥ ùëëùê¥ with size ùëÅùê¥ and dimension ùëëùê¥. Definition 2.3. (Hypergraph.) Given hypergraph = (V, E, X), is the set of nodes with size ùëÅ , is the set of hyperedges with size ùëÄ, and is the attribute feature set. Each hyperedge represents higher-order interaction among set of nodes, i.e., ùëí 2, ùëí E."
        },
        {
            "title": "2.2 Related Works",
            "content": "With the excellent capability of modeling inherent relationships among entities, graph learning techniques [35, 36, 61, 75, 76, 78, 90, 91] have been widely adopted in various applications including combating the opioid crisis [14, 48, 50, 62, 66, 81]. Early works have explored graph-based methods for opioid overdose prediction, leveraging the relational structure among patients, healthcare providers, and prescription records to identify individuals at elevated risk. For example, LIGHTED [14] introduces deep learning framework that integrates Long Short-Term Memory networks and Graph Neural Networks to predict patients overdose risk by jointly modeling temporal patterns in prescription histories and spatial dependencies in patient-provider networks. Similarly, DDHGNN [81] proposes disentangled dynamic heterogeneous graph neural network for opioid overdose prediction, which explicitly separates medical history, social environment, and provider behavior factors within temporal graph structure to disentangle the complex interplay of clinical and socio-behavioral determinants. NPHGS [66] develops non-parametric heterogeneous graph scan method to detect anomalous pill mill networks of prescribers and dispensers engaging in suspicious coordinated activity, enabling public health authorities to identify fraudulent prescription patterns at scale. More recently, HyGCL-DC [50] presents hypergraph contrastive learning framework designed to capture high-order interactions among drug sellers and drug buyers for online drug community detection, where hyperedges naturally represent group-wise co-occurrence patterns that pairwise graphs fail to adequately model. With the advancement of large language models [44, 47, 52, 83, 84, 87], LLMHetGDT [48] designs heterogeneous graph neural network framework that leverages large language models to oversample positive samples for online drug trafficking detection, effectively addressing the inherent class imbalance that characterizes real-world opioid crisis datasets. Despite the significant progress in graph learning approaches to address the opioid epidemic, there remains lack of comprehensive benchmarks tailored to systematically evaluate and analyze graph-based methods in opioid crisis scenarios. This gap motivates our work to introduce Opbench, the first benchmark specifically designed to evaluate and analyze graph-based methods in opioid crisis applications, featuring heterogeneous graphs and hypergraphs that capture the complex relational structures inherent in public health data."
        },
        {
            "title": "3 Overview of Opbench",
            "content": "Opbench fills critical gap by aligning graph learning evaluation with the real-world challenges at the heart of combating the opioid crisis. In this section, we provide an overview of the design and features of Opbench. Opbench : Graph Benchmark to Combat the Opioid Crisis KDD 26, August 913, 2026, Jeju, Korea Figure 1: Dataset construction process for applications in Opbench. (a) Opioid Overdose Detection: We leverage the PDMP dataset from the State of Ohio to construct heterogeneous graph with four node types to detect patients at risk of opioid overdose. (b) Illicit Online Drug Trafficking: We collect metadata from X/Twitter and construct hypergraph and multi-relation graph to capture group-wise interactions and diverse relation types among users for community detection and role classification tasks. (c) Opioid Misuse Detection: We employ the NHANES data to construct heterogeneous graph over five node types to predict opioid misuse through dietary patterns."
        },
        {
            "title": "3.1 Core Principles",
            "content": "Our benchmark is designed following four core principles, ensuring both alignment with public health challenges and rigor in graphbased method evaluation. 3.1.1 Alignment with Real-World Opioid Crisis Scenarios. Unlike existing graph benchmarks that mainly rely on bibliographic or molecular datasets [17, 30, 45], Opbench is rooted in the urgent societal challenge of the opioid crisis, and the curated datasets mimic the complexity of real-world opioid-related environments. Our benchmark covers three drivers in the crisis lifecycle. (i) Prescription Opioid Supply, where we detect and alert patients for opioid overdoses at risk from healthcare claims data, (ii) Illicit Opioid Supply that identifies illicit drug trafficking communities and roles to disrupt digital illegal supply chains, and (iii) Individual Risk Indicators leveraging nutritional patterns as latent biomarkers for early warning of opioid misuse. This principle ensures that models evaluated on Opbench are directly relevant to high-stakes applications with tangible public health impact. 3.1.2 High-Order and Heterogeneous Structural Modeling. Realworld opioid crisis data inherently involves complex, non-pairwise interactions and diverse entity types that standard homogeneous graphs fail to capture effectively [50, 51, 62, 77, 85]. To address this limitation, Opbench explicitly focuses on high-order and heterogeneous structures. (i) Hypergraphs. We use hyperedges to represent higher-order and group-wise interactions, yielding hypergraphs that capture complex relational information beyond pairwise interactions. For instance, in social networks, an illicit drug trafficking community may involve multiple users collaborating, which can be naturally modeled as hyperedges. (ii) Heterogeneous Graphs. We utilize heterogeneous graphs to represent the complex opioidrelated systems, which is crucial for modeling the informative interactions among different types of entities and interactions. For example, in clinical data, the interactions among patients, drugs, physician and pharmacies are inherently heterogeneous, and we define different types of nodes and edges to capture the rich semantics of these relationships to ensure comprehensive representation of the ecosystem for modeling and analysis. By introducing high-order and heterogeneous structures, Opbench challenges graph learning methods to handle the intricate, complex relationships and rich semantic information characterizing the opioid crisis. 3.1.3 Data Domain Coverage. Recognizing that combating the opioid crisis is multidimensional problem, Opbench spans three distinct data domains to evaluate its capabilities across diverse contexts. (i) Healthcare. We use Prescription Drug Monitoring Program (PDMP) data, which captures structured healthcare claims, including patient demographics, prescription records, and provider information. (ii) Social Network. We leverage X/Twitter data, which contains unstructured text, user profiles, and complex user interactions, to model illicit drug trafficking networks. (iii) Nutrition. We use data from the National Health and Nutrition Examination Survey (NHANES) [7], which captures lifestyle and dietary habits, to KDD 26, August 913, 2026, Jeju, Korea Tianyi Ma et al. model the correlations between dietary patterns and risk of opioid misuse. This multi-domain coverage challenges models to adapt to varying data distributions, feature types, and structural properties. Runtime Environment. All experiments are conducted using Nvidia A40 GPUs with 48 GB GDDR6 memories with PyTorch 2.9.1 and PyG 2.7.0 to ensure consistent performance measurements. 3.1.4 Usability and Reproducibility. To foster broad adoption and fair comparison, Opbench adheres to rigorous evaluation standards. We provide standard data splits to prevent data leakage and ensure realistic evaluation. Furthermore, Opbench is integrated with unified codebase that supports standard metrics, e.g., Accuracy, F1, GMeans, and AUC, and seamless compatibility with popular graph learning libraries, facilitating reproducible research and rapid benchmarking of new methods. Moreover, this benchmark will be actively maintained and updated to incorporate emerging datasets and tasks relevant to the evolving opioid crisis."
        },
        {
            "title": "3.2 Baseline Methods",
            "content": "Our benchmark framework supports all graph learning methods seamlessly. We implement classic baseline methods in the literature, which can be categorized as (i) Feature-based methods: Multilayer Perceptrons (MLPs), Oversampling [93], and SMOTE [10]; (ii) Graph Neural Networks (GNNs): GCN [40], GAT [70], Sage [27], and GraphSMOTE [92]; (iii) Heterogeneous Graph Neural Networks (HetGNNs): HGMAE [69], HAN [72], and HGT [31]; (iv) Multi-Relation Graph Neural Networks (MRGNNs): R-GCN [67], GraphENS [58], and AD-GSMOTE [60]; (v) Hypergraph Neural Networks (HyGNNs): HGNN [21], HNHN [15], HCHA [2], AllSet [12], and ED-HNN [71]. Implementation details for each method are provided in Appendix A."
        },
        {
            "title": "3.3 Evaluation Protocols",
            "content": "To ensure rigorous and fair evaluation, we carefully design the evaluation protocols in Opbench as follows. Evaluation Metrics. We adopt standard evaluation metrics to comprehensively assess model performance across different aspects, such as overall correctness (Accuracy), balance between precision and recall (F1-score), area under the correctness curve (AUC), and imbalanced performance (GMeans). Data Splits. To prevent data leakage and ensure reproducible evaluation, we provide standard data splits for training, validation, and testing, with multiple ratios, i.e., 10%, 20%, 50% training data, 10% for validation, and the rest for testing to assess model robustness under varying data availability scenarios. For each data split ratio, we provide five different random splits and report the average performance with standard deviation across the 5 splits to ensure robust and reliable evaluation of model performance. Hyperparameter Tuning. To find the optimal hyperparameters for each baseline method, we perform grid search over predefined hyperparameter space, including learning rate {0.1, 0.01, 0.001, 0.0001}, hidden dimension {64, 128, 256, 512}, dropout rate {0.0, 0.3, 0.5}, and weight decay {0, 0.0001, 0.0005}. Note that for fair comparison, we fix the number of layers to 2 for all baseline methods, and we tune the hyperparameters based on the validation set performance. Moreover, each method is attached with two-layer MLP as classifier for downstream tasks. We report the best hyperparameters for each method and dataset in Appendix Table 10."
        },
        {
            "title": "4 Opbench Datasets",
            "content": "In this section, we present the details of Opbench, which consists of three critical domains in the opioid crisis lifecycle with five datasets curated from real-world data sources. For each domain, we describe its real-world significance in combating the opioid crisis, our contributions, data construction methods, and experiment results. The data statistics are summarized in Table 1."
        },
        {
            "title": "4.1 Healthcare: Opioid Overdose\nWhy this matters. The opioid crisis represents one of the deadliest\npublic health emergencies in modern history, claiming over 80,000\nlives annually in the United States alone [6]. As opioids remain\namong the most widely prescribed medications for pain manage-\nment, their addictive properties place patients at significant risk of\ndependency and fatal overdose [55, 56]. Although opioids require\nphysician prescriptions, overdose deaths continue to rise, suggest-\ning that certain prescribing patterns may inadvertently contribute\nto patient harm [11, 37]. Critically, opioid risk is not determined\nby patient characteristics alone. It emerges from complex interac-\ntions among patients, prescribers, pharmacies, and medications. A\npatient receiving prescriptions from multiple providers, or a phar-\nmacy dispensing unusually high volumes of controlled substances,\nmay signal an elevated risk that isolated patient records cannot\nreveal. Identifying such high-risk patterns before adverse outcomes\noccur is essential to effective prevention, yet manual evaluation\nby healthcare professionals proves inadequate at scale due to lim-\nited bandwidth and the sheer volume of prescription data. Graph\nlearning methods are uniquely suited to this challenge, as they can\nmodel the relational structure among patients, medications, and\nproviders embedded in healthcare claims data to detect risk signals\ninvisible to traditional approaches.\nOur Contribution. We frame this as a node classification task\nthat aims to predict whether the patient in a healthcare network\nis at high risk for opioid overdose. To evaluate graph learning\nmethods on this task, we release Pdmp-OD-Det, a heterogeneous\ngraph dataset built from Ohio‚Äôs PDMP data. PDMPs are state-run\ndatabases that track every controlled substance prescription filled\nin the state, providing a comprehensive view of prescribing and\ndispensing patterns.",
            "content": "4.1.1 Dataset Construction and Annotation. We obtain the PDMP data from the State of Ohio Board of Pharmacy spanning the year 2016, which contains 1,395,958 medical prescribing and dispensing records throughout the year. We first remove incomplete records, e.g., missing demographic information, etc., leading to total of 1,395,434 records over 61,479 patients. Afterward, we construct heterogeneous graph Ghet that contains four node types and five edge types, as illustrated in Figure 1(a). We follow existing works [1, 46] to annotate the patients with binary labels, where the positive class represents patients facing high opioid overdose risk, and the negative class represents patients at low risk. Particularly, we employ the Morphine Milligram Equivalent (MME) [46] stressed Opbench : Graph Benchmark to Combat the Opioid Crisis KDD 26, August 913, 2026, Jeju, Korea Table 1: Statistics of benchmark Opbench. BC, ML, and MC denote binary, multi-label, and multi-class classification, respectively. Het., MR. and Hp. denote heterogeneous graph, multi-relation graph, and hypergraph, respectively."
        },
        {
            "title": "Type",
            "content": "V E"
        },
        {
            "title": "Task",
            "content": "Y"
        },
        {
            "title": "Class Ratio",
            "content": "Pdmp-OD-Det X-HyDrug-Comm X-HyDrug-Role X-MRDrug-Role NHANES-Diet"
        },
        {
            "title": "Healthcare\nSocial Network\nSocial Network\nSocial Network\nDietary",
            "content": "Het. Hp. Hp. MR. Het. 54,318 2,936 2,936 27,945 13,742 321,437 33,893 33,893 436,385 445,"
        },
        {
            "title": "BC\nML\nMC\nMC\nBC",
            "content": "2 6 4 4 2 1.0 / 1.0 1.0/1.4/2.1/1.1/0.3/4.1 1.0 / 0.8 / 4.0 / 1.2 1.0 / 1.2 / 4.4 / 56.3 1.0/1.0 Table 2: The performance comparison among Pdmp-OD-Det. The best performance is bolded and runner-ups are underlined."
        },
        {
            "title": "Model",
            "content": "Train-10% Valid-10% Test-80% Train-20% Valid-10% Test-70% Train-50% Valid-10% Test-40%"
        },
        {
            "title": "AUC",
            "content": "F1-Macro F1-Micro"
        },
        {
            "title": "AUC",
            "content": "F1-Macro F1-Micro"
        },
        {
            "title": "AUC",
            "content": "F1-Macro F1-Micro MLP GCN [40] GAT [70] R-GCN [67] HAN [72] HGT [31] HGMAE [69] 72.576.86 60.960.35 61.764.48 63.373.95 79.140.45 79.810.88 62.893.38 68.774.97 52.956.58 53.94 7.67 55.8510.78 75.784.92 70.977.91 51.5310.02 67.066.54 57.860.27 56.703.11 58.994.51 74.824.73 72.674.54 56.932. 77.020.69 68.580.26 70.752.49 70.543.99 84.114.82 83.216.67 66.770.53 71.126.32 57.588.47 59.1010.36 59.7912.91 76.4511.09 74.2213.05 62.740.62 72.405.79 60.204.35 61.775.60 63.146.37 79.443.05 77.666.55 64.030.62 75.412.67 70.910.55 75.782.85 73.940.25 87.064.11 85.216.67 70.430.68 60.528.59 66.998.01 69.646.43 67.93 0.33 78.029.22 79.2213.05 67.580.51 66.188.59 67.133.35 70.822.20 68.030.34 82.412.54 81.666.55 69.700. Table 3: The performance comparison among X-HyDrug-Comm. The best performance is bolded, and runner-ups are underlined."
        },
        {
            "title": "Model",
            "content": "Train-10% Valid-10% Test-80% Train-20% Valid-10% Test-70% Train-50% Valid-10% Test-40% Acc. F1-Macro F1-Micro Acc. F1-Macro F1-Micro Acc. F1-Macro F1-Micro MLP GCN [40] GAT [70] HGNN [21] HNHN [15] HCHA [2] AllSet [12] ED-HNN [71] 82.630.68 78.680.23 79.420.51 80.700.16 82.550.65 82.200.31 80.691.35 83.770.36 47.554.27 39.090.97 42.212.28 45.401.40 54.641.78 53.721.58 41.706.98 57.622.79 70.552.11 63.580.76 64.720.78 65.840.20 71.801.37 70.710.74 66.683.76 74.570.37 84.050.43 80.140.24 80.440.59 82.310.32 83.890.48 83.120.27 83.060.52 85.290.32 58.484.29 41.371.84 47.542.75 49.961.66 57.604.97 57.941.52 52.401.92 65.104. 74.601.07 65.360.28 66.681.75 69.960.93 74.261.02 72.410.56 72.160.79 76.660.60 84.590.38 80.660.33 82.100.54 82.492.88 85.050.86 84.280.48 85.350.46 86.590.42 56.133.44 45.392.32 55.121.68 50.972.88 58.073.28 64.101.67 63.942.33 73.391.24 74.960.97 66.671.19 71.081.19 69.770.77 76.011.71 74.821.04 77.001.05 79.080.76 by the CDC as standard indicator for opioid overdose risk. Following the CDC-recommended daily MME threshold [16], patients with an average daily MME above 90 are labeled as high-risk patients, while patients falling below this threshold are identified as low-risk patients. As result, we obtain Pdmp-OD-Det dataset with 54,318 nodes and 321,437 edges. More details about data construction and annotation are provided in Appendix B, and data statistics are summarized in Appendix Table 8. 4.1.2 Performance Comparison for Opioid Overdose Detection. Table 2 reports the performance comparison among baseline methods on the Pdmp-OD-Det dataset. According to the table, we observe that: (i) Feature-based method, i.e., MLPs, outperform GNNs, including GCN and GAT, in several settings, indicating that message passing on projected homogeneous graphs fails to capture the rich heterogeneous semantics and may even introduce noise. (ii) HetGNNs, including HAN and HGT, significantly outperform GNNs and MLPs across all training ratios and evaluation metrics, demonstrating that explicitly modeling the heterogeneous relationships among patients, physicians, pharmacies, and drugs is essential for accurate opioid overdose risk prediction. (iii) HAN and HGT exhibit competitive performance, with HAN achieving the best results in most metrics while HGT leads in AUC at 10% training ratio and F1-Macro at 50% training ratio. This suggests that both hierarchical attention and heterogeneous graph transformers effectively capture the complex semantics of healthcare networks, though their relative strengths vary with data availability."
        },
        {
            "title": "4.2 Social Network: Illicit Drug Trafficking\nWhy this matters. As the market of illicit drugs remains im-\nmensely profitable, the crime of drug trafficking has continually\nevolved with modern technologies, such as social media platforms.",
            "content": "KDD 26, August 913, 2026, Jeju, Korea Tianyi Ma et al. Table 4: The performance comparison among X-HyDrug-Role. The best performance is bolded and runner-ups are underlined."
        },
        {
            "title": "Model",
            "content": "Train-10% Valid-10% Test-80% Train-20% Valid-10% Test-70% Train-50% Valid-10% Test-40% Acc. F1-Macro F1-Micro Acc. F1-Macro F1-Micro Acc. F1-Macro F1-Micro MLP GCN [40] GAT [70] HGNN [21] HNHN [15] HCHA [2] AllSet [12] ED-HNN [71] 67.460.53 64.870.51 65.570.81 67.690.21 66.890.63 67.280.53 67.090.49 68.550.62 45.252.37 40.550.66 40.371.44 43.452.00 40.831.43 45.912.22 42.712.90 45.583.99 67.460.53 64.870.51 65.570.81 67.690.21 66.890.63 67.280.53 67.090.49 68.550.62 68.351.03 65.200.78 66.421.28 68.640.90 67.900.86 68.090.85 68.090.71 69.401.08 47.601.40 39.360.76 41.261.55 46.061.86 41.111.49 48.341.96 43.202.49 45.123. 68.351.03 65.200.78 66.421.28 68.640.90 67.900.86 68.090.85 68.090.71 69.401.08 69.581.75 66.081.12 67.352.04 69.380.92 68.941.55 68.831.21 69.920.40 70.661.84 48.892.25 44.492.06 41.491.65 49.022.78 45.403.88 48.981.24 52.233.95 49.084.52 69.581.75 66.081.12 67.352.04 69.380.92 68.941.55 68.831.21 69.920.40 70.661.84 Table 5: The performance comparison among X-MrDrug-Role. The best performance is bolded and runner-ups are underlined."
        },
        {
            "title": "Model",
            "content": "Train-10% Valid-10% Test-80% Train-20% Valid-10% Test-70% Train-50% Valid-10% Test-40%"
        },
        {
            "title": "GMean",
            "content": "F1-Macro F1-Micro"
        },
        {
            "title": "GMean",
            "content": "F1-Macro F1-Micro"
        },
        {
            "title": "GMean",
            "content": "F1-Macro F1-Micro MLP Oversampling [93] SMOTE [10] GCN [40] GAT [70] GraphSage [27] GraphENS [58] GraphSMOTE [92] AD-GSMOTE [60] 40.5312.80 57.612.11 57.983.68 33.8420.01 26.8716.89 50.9715.62 38.8413.83 38.1521.85 61.681.59 62.382.40 62.660.77 62.681.69 60.313.59 53.433.39 67.284.02 60.613.18 64.934.04 70.580.99 94.430.11 92.400.49 92.501.09 94.480.10 91.350.41 95.320.16 94.560.06 95.320.13 95.510. 52.602.61 60.831.35 60.920.99 52.034.45 44.798.41 60.936.34 49.714.36 55.3310.34 67.000.91 66.431.20 64.330.67 65.520.63 64.381.64 58.633.33 70.732.13 63.401.45 69.612.99 75.020.33 94.940.17 92.590.52 93.490.09 94.750.18 92.780.52 95.870.06 94.780.13 95.870.07 96.280.05 59.741.57 65.532.53 65.522.78 53.553.69 55.673.44 63.972.10 49.397.71 61.713.94 69.101.02 70.301.09 68.451.95 69.101.53 66.081.38 65.551.73 72.821.05 64.982.51 72.661.80 77.700.64 95.560.29 94.100.41 94.310.22 95.220.26 94.400.37 96.300.16 95.190.21 96.300.20 96.710. Recent works [50, 62] have shown that the major social media platforms, e.g., X/Twitter, Instagram, and Facebook, have become the direct-to-customer intermediaries for illicit drug trafficking, especially for opioid substances. As illustrated in Fig. 1(b), illicit drug sellers leverage social media to advertise their products through posts containing street names and drug-related hashtags, which attract potential buyers and facilitate direct or indirect drug trade on digital platforms. Consequently, these drug-related illicit behaviors among users naturally form drug trafficking networks on social media platforms, and these illegal drug-related activities have turned into societal concern due to their catastrophic consequences, from violent crimes to public health. Our Contribution. To evaluate the performance of graph learning methods, we present three benchmark datasets for online drug trafficking detection, i.e., X-HyDrug-Role, X-HyDrug-Comm, and X-MRDrug-Role, where each dataset aims to tackle specific challenge in illicit online drug trafficking detection. (i) Online drug trafficking community. Recent works [4, 24] have demonstrated that drug-related users operate in tightly-knit communities to facilitate their illicit activities. To this end, we introduce X-HyDrugComm, hypergraph benchmark that mimics the multi-community nature of illicit drug trafficking networks for the community detection task. Moreover, we formulate the problem as an overlapping community detection task, as individuals involved in online drug trafficking may belong to multiple communities. (ii) Roles in online illicit drug trafficking. In addition to community detection, we construct X-HyDrug-Role to capture higher-order interactions among users: drug-relevant users collaborate in groups to conduct their illicit activities, and these group-level interactions can be modeled as hyperedges in hypergraph. We formulate this problem as drug trafficking role detection task to identify the specific roles of users in illicit online drug trafficking activities, i.e., drug sellers, drug buyers, drug users, and discussion. (iii) Minority issue in illicit online drug trafficking. Illicit drug-relevant users remain small portion of users compared to the normal users in the real-world digital platform, and this poses significant challenges for model training and detecting illicit drug-related users effectively [60]. In response, we propose multi-relation graph, called X-MRDrug-Role, that mimics the imbalanced label distribution in real-world scenarios. Moreover, X-MRDrug-Role models pairwise interactions among users, as drug-relevant users also interact with one another through various types of relations, e.g., follow, mention. These multi-relation types can be effectively captured by multi-relation graphs, in which different edge types represent distinct interactions among users. These three datasets provide comprehensive benchmark for evaluating graph learning methods for drug trafficking detection across various settings, including community and role detection, and different graph structures, i.e., hypergraphs and multi-relational graphs. 4.2.1 Dataset Construction and Annotation. We choose (formerly Twitter) as the social media platform to study the drug trafficking detection tasks, and leveraged the official APIs to collect posts and Opbench : Graph Benchmark to Combat the Opioid Crisis KDD 26, August 913, 2026, Jeju, Korea Table 6: The performance comparison among NHANES-Diet. The best performance is bolded and runner-ups are underlined."
        },
        {
            "title": "Model",
            "content": "Train-10% Valid-10% Test-80% Train-20% Valid-10% Test-70% Train-50% Valid-10% Test-40% Acc. F1-Macro F1-Micro Acc. F1-Macro F1-Micro Acc. F1-Macro F1-Micro MLP GCN [40] GAT [70] R-GCN [67] HAN [72] HGT [31] HGMAE [69] 68.87 1.27 71.51 1.20 73.74 0.74 72.74 1.06 74.06 0.82 70.58 1.89 63.17 0.61 69.27 2.30 73.01 1.48 76.12 1.01 74.73 1.25 76.27 1.07 71.27 2.53 63.10 0.86 68.87 1.27 71.51 1.20 73.74 0.74 72.74 1.06 74.06 0.82 70.58 1.89 63.17 0.61 70.62 0.62 73.46 0.85 74.97 0.64 74.26 0.70 75.10 0.55 72.38 1.01 63.80 0.93 71.49 0.90 75.53 0.90 77.36 0.66 76.62 0.60 77.69 0.37 74.03 2.67 63.57 1. 70.62 0.62 73.46 0.85 74.97 0.64 74.26 0.70 75.10 0.55 72.38 1.01 63.80 0.93 72.76 0.89 74.90 0.60 75.32 0.90 75.42 0.66 75.90 0.89 75.41 1.58 64.83 0.82 73.90 0.97 77.15 0.67 77.80 0.90 77.96 0.58 78.46 0.84 73.33 1.11 64.80 0.73 72.76 0.89 74.90 0.60 75.32 0.90 75.42 0.66 75.90 0.89 75.41 1.58 64.83 0.82 user profiles. With the collected metadata, six experts are recruited to manually annotate the users based on their posts and profiles, following the annotation rules (Appendix C). With the annotated data, we construct the heterogeneous graph Ghet for X-MRDrug-Role and the hypergraph for X-HyDrug-Comm and X-HyDrug-Role following the schema as illustrated in Fig. 1(b). Specifically, for the heterogeneous graph Ghet, we define three edge types over user nodes, i.e., user-interact-user, user-follow-user, and user-keyworduser, where the first two edge types capture the interactions among users, and the last edge type captures the shared interests among users through their common keywords, e.g., hashtags and emojis. Following existing works [50, 74], we encode the rich text information of user nodes into SentenceBert [65] to obtain node attribute features. Detailed discussion about data construction is provided in Appendix C. 4.2.2 Performance Comparison for Community Detection. Table 3 reports the performance comparison among baseline methods on X-HyDrug-Comm dataset. According to the results, we have the following observations. (i) homogeneous GNNs, i.e., GCN and GAT, underperform HyGNNs on this dataset, which demonstrates the necessity of leveraging higher-order interactions among users for drug trafficking community detection. (ii) Attention-based HyGNNs, i.e., HCHA and AllSet, have better performance in higher training ratio (i.e., 50% training data) compared to convolution-based HyGNNs, i.e., HGNN and HNHN, while showing comparable or worse performance in lower training ratio (i.e., 10% and 20% training data). This indicates that the attention mechanism may require more training data to learn effective representations. (iii) ED-HNN consistently outperforms all baseline methods across all training ratios and evaluation metrics, which demonstrates the effectiveness of the equivariant and disentangled representation learning for drug trafficking community detection. 4.2.3 Performance Comparison for Role Detection. We conduct experiments on baseline methods over X-HyDrug-Role and report the results in Table 4. We find the following results. (i) MLPs demonstrate competitive performance, outperforming GNNs in both evaluation metrics across all training ratios, which indicates that message passing on naive clique-expansion graph may introduce redundant or noisy information for the role detection task. (ii) HyGNNs consistently outperform GNNs, which indicates the importance of modeling higher-order interactions among users for role detection in drug trafficking networks. (iii) ED-HNN consistently achieves the highest accuracy across all training ratios, reaching 68.55%, 69.40%, and 70.66% at 10%, 20%, and 50% training data, respectively. This demonstrates that the equivariant and disentangled design of ED-HNN effectively captures the structural patterns relevant to role classification in drug trafficking networks. For X-MRDrug-Role, we report the results in Table 5. The following observations emerge from the results. (i) Standard GNNs, including GCN and GAT, exhibit poor GMean performance, with GCN achieving only 33.84% and GAT 26.87% at 10% training ratio. This indicates that naive message passing without explicit imbalance handling fails to capture minority class patterns, as the majority class dominates the aggregation process. (ii) AD-GSMOTE consistently achieves the best performance across all settings and metrics, demonstrating that adaptive graph-based oversampling techniques are particularly effective for handling the severe class imbalance inherent in real-world drug trafficking role detection."
        },
        {
            "title": "4.3 Dietary: Opioid Misuse\nWhy this matters. Opioids are commonly used for pain relief,\nwhile opioids produce euphoria and therefore might be easily mis-\nused [59, 63]. To tackle this, a common treatment is medication-\nassisted treatment (MAT) [13, 32] that takes the opioid agonists\nsuch as methadone or buprenorphine in combination with coun-\nseling. While effective, the various induced side effects can often\ntrigger opioid relapse and require timely identification of at-risk\nindividuals to intervene. Emerging evidence has unveiled a com-\npelling nexus between dietary behaviors and substance depen-\ndency [32, 34, 39, 88, 89], where individuals with opioid misuse\noften exhibit distinctive nutritional signatures, i.e., pronounced de-\nficiencies in essential nutrients, compromised metabolic function,\nand aberrant eating behaviors. These dietary fingerprints offer a\npromising avenue for proactive identification of at-risk individuals,\nparticularly in latent cases where users remain unaware of their\ndependency or deliberately conceal their substance use.\nOur Contribution. To this end, we introduce the opioid misuse\ndetection task, which aims to predict users who face opioid mis-\nuse through their dietary behaviors, such as food and ingredients\ntaken, daily habits, etc. Afterward, we construct NHANES-Diet,\na heterogeneous graph that models the inherent relational struc-\nture of dietary data, i.e., the complex interactions among users,",
            "content": "KDD 26, August 913, 2026, Jeju, Korea Tianyi Ma et al. foods, ingredients, and dietary habits to effectively capture both individual consumption patterns and shared dietary behaviors across user populations, providing rich structural and semantic information. Crucially, NHANES-Diet enables the exploitation of advanced graph learning techniques to uncover subtle, complex correlations between dietary patterns and drug misuse, thereby unlocking novel predictive capabilities for early intervention. 4.3.1 Data Construction and Annotation. We utilize NHANES data from 2003 to 2020 to construct NHANES-Diet. As shown in Figure 1(c), it features five types of nodes, including user, food, habit, ingredient, category, and four types of relationships such as user-eatfood, user-have-habit, food-contain-ingredient, and food-belong_tocategory. Opioid misuse users are identified by (i) records of illicit opioid drug use and (ii) records of prescription opioid medication use, which is criterion commonly employed in the domain [26]. Detailed discussion about data construction and annotation is provided in Appendix D. 4.3.2 Performance Comparison for Opioid Misuse Detection. Table 6 reports the performance comparison among baseline methods on NHANES-Diet dataset. The following observations emerge from the results. (i) HAN consistently achieves the best performance across all training ratios and evaluation metrics, with accuracy scores of 74.06%, 75.10%, and 75.90% at 10%, 20%, and 50% training data, respectively. This demonstrates that hierarchical attention over heterogeneous graph structures effectively captures the complex relationships between dietary patterns and opioid misuse risk. (ii) GAT serves as strong runner-up at lower training ratios (10% and 20%), while R-GCN emerges as the second-best performer at 50% training ratio. This transition suggests that explicit relationtype modeling becomes increasingly beneficial as more labeled data becomes available, enabling the model to learn distinct aggregation patterns for different dietary relationships. (iii) HetGNNs, including HAN and R-GCN, consistently outperform homogeneous GNNs such as GCN and GAT, highlighting the importance of modeling the diverse node types and edge types inherent in dietary data for opioid misuse detection. (iv) HGMAE exhibits the lowest performance among all methods, with accuracy ranging from 63.17% to 64.83%, indicating that self-supervised pre-training objectives designed for general heterogeneous graphs may not align well with the downstream task of opioid misuse detection."
        },
        {
            "title": "5 Observations from Opbench",
            "content": "In this section, we highlight the key insights from our analysis throughout the Opbench. These observations are intended to guide both graph learning researchers in understanding method strengths and limitations, and public health practitioners in selecting appropriate approaches for opioid crisis applications. Obs. 1. Homogeneous Graph Projections Lose Critical Structural Information. natural question when working with complex relational data is whether simple homogeneous graph representations suffice for opioid crisis applications. Our experiments provide decisive answer. Projecting heterogeneous or hypergraph structures onto homogeneous graphs causes substantial information loss, leading to significantly degraded performance in detecting opioid-related risks. Specifically, GCN and GAT achieve 60.96% and 61.76% AUC, respectively, at 10% training ratio for the opioid overdose detection task, whereas HetGNNs, i.e., HAN and HGT, achieve 79.14% and 79.81%. Similarly, for the community detection task, GCN achieves only 39.09% F1-Macro on clique-expanded homogeneous projection, whereas ED-HNN achieves 57.62%. Moreover, MLPs also outperform GNNs in these settings, indicating that the issue lies not in the learning process over the graph structures but in the inappropriate structural representation for the opioid crisis domain. This finding validates our core principle in designing Opbench, which is to provide datasets with rich heterogeneous and higherorder structures that reflect the real-world complexities of opioid crisis data, rather than relying on simplified homogeneous graph representations that obscure critical relational information. For example, in healthcare settings, patient risk emerges from complex interactions among patients, prescribers, pharmacies, and medications, and collapsing these relationships into undifferentiated edges obscures the prescribing patterns indicative of potential overdose. In social network settings, drug trafficking communities operate through group-wise collaborations that pairwise clique expansions fail to model comprehensively. This observation highlights the importance of developing methods that explicitly model relation types and hyperedge structures rather than relying on homogeneous projections. Moreover, the key takeaway is that investing in proper heterogeneous or hypergraph data pipelines is essential for effective risk detection and intervention. Obs. 2. Higher-Order Modeling Provides Consistent but TaskDependent Gains. Our results demonstrate that HyGNNs consistently outperform GNNs across illicit drug trafficking detection tasks, with the magnitude of improvement varying by task, reflecting the nature of the underlying relational patterns across opioid crisis applications. For the community detection task, ED-HNN achieves 57.62% F1-Macro at 10% training ratio, substantial improvement over GCN (39.09%). On X-HyDrug-Role for role detection, HyGNNs maintain their advantage, with ED-HNN reaching 68.55% Accuracy compared to 64.87% for GCN. This finding reflects the nature of these opioid crisis intervention tasks. Community membership is defined by patterns of coparticipation in trafficking activities, which hypergraphs naturally capture, whereas distinguishing individual roles, such as sellers versus buyers, depends more on behavioral signals in which structural advantages are less pronounced. For practitioners combating online drug trafficking, hypergraph modeling should be adopted for both tasks; however, community disruption efforts will yield the greatest returns from higher-order structural modeling, while role identification task may also benefit from enriched user-level behavioral features. Obs. 3. Imbalance Handling Can Outweigh Architectural Sophistication. In opioid crisis applications, key challenge is that target populations often remain minorities among the overall samples, leading to severe class imbalance that can undermine model performance and real-world utility. Our experiments demonstrate that addressing this class imbalance at the data level can yield larger performance gains than adopting more sophisticated GNN architectures, with direct implications for the effectiveness of crisis response systems. For the drug trafficking role detection task, at 10% training ratio, AD-GSMOTE achieves 61.68% GMean and Opbench : Graph Benchmark to Combat the Opioid Crisis KDD 26, August 913, 2026, Jeju, Korea 70.58% F1-Macro, while standard GNNs collapse to 33.84% and 26.87% GMean, respectively. This approximately 28-35% GMean deficit means that standard methods would miss the majority of actual drug sellers and buyers, severely limiting the utility of such systems for law enforcement and platform moderation. We hope this finding motivates the graph learning community to prioritize developing graph learning methods that are robust to class imbalance while preserving relational semantics. For practitioners deploying systems to combat the opioid crisis, where missing single high-risk patient or trafficking network can have severe consequences, data-level interventions such as adaptive oversampling and class reweighting should be prioritized as essential components of any detection pipeline."
        },
        {
            "title": "6 Conclusion",
            "content": "In this paper, we introduce Opbench, the first comprehensive benchmark for evaluating graph learning methods in the context of the opioid crisis. Opbench provides five curated datasets spanning three critical application domains, namely opioid overdose detection from medical claims, illicit drug trafficking detection on digital platforms, and opioid misuse prediction from dietary patterns. Through extensive experiments, we reveal actionable insights into the strengths and limitations of existing graph learning methods for opioid crisis applications. Our benchmark contributes to the field in researchers and practitioners by providing standardized evaluation framework and rich set of datasets that mimic real-world scenarios, fostering the development of more effective graph-based methods to combat the opioid epidemic. We release Opbench as an open-source library to support future research in combating the opioid epidemic. References [1] Meredith CB Adams, Katherine Sward, Matthew Perkins, and Robert Hurley. 2025. Standardizing research methods for opioid dose comparison: the NIH HEAL morphine milligram equivalent calculator. Pain 166, 8 (2025), 1729 1737. [2] Song Bai, Feihu Zhang, and Philip HS Torr. 2021. Hypergraph convolution and hypergraph attention. Pattern Recognition 110 (2021), 107637. [3] Julian Bros√©us, Damien Rhumorbarbe, Caroline Mireault, Vincent Ouellette, Frank Crispino, and David D√©cary-H√©tu. 2016. Studying illicit drug trafficking on Darknet markets: structure and organisation from Canadian perspective. Forensic science international 264 (2016), 714. [4] Deborah Browne, Mark Mason, and Rachel Murphy. 2003. Drug supply and trafficking: An overview. How. J. Crim. Just. 42 (2003), 324. [5] Suzanne Brundage and Carol Levine. 2019. The ripple effect: The impact of the opioid epidemic on children and families. New York, NY: United Hospital Fund 46 (2019). [6] Rodrigo Carrillo-Larco, Wilmer Cristobal Guzm√°n-Vilca, Fabiola Le√≥n-Velarde, Antonio Bernabe-Ortiz, Michelle Jimenez, Mary Penny, Camila Gianella, Mariana Legu√≠a, Pablo Tsukayama, Stella Hartinger, et al. 2022. Lancet Regional Health Americas. [7] CDC. 2024. National Health and Nutrition Examination Survey. https://wwwn. cdc.gov/nchs/nhanes/default.aspx [8] Centers for Disease Control and Prevention. 2025. Understanding the Opioid Overdose Epidemic. Centers for Disease Control and Prevenhttps://www.cdc.gov/overdose-prevention/about/understanding-thetion. opioid-overdose-epidemic.html National Center for Injury Prevention and Control. [9] Melody Chavez and Khary Rigg. 2020. Nutritional implications of opioid use disorder: guide for drug treatment providers. Psychology of Addictive Behaviors 34, 6 (2020), 699. [10] Nitesh Chawla, Kevin Bowyer, Lawrence Hall, and Philip Kegelmeyer. 2002. SMOTE: synthetic minority over-sampling technique. Journal of artificial intelligence research 16 (2002), 321357. [11] Qiushi Chen, Marc Larochelle, Davis Weaver, Anna Lietz, Peter Mueller, Sarah Mercaldo, Sarah Wakeman, Kenneth Freedberg, Tiana Raphel, Amy Knudsen, et al. 2019. Prevention of prescription opioid misuse and projected overdose deaths in the United States. JAMA network open 2, 2 (2019), e187621 e187621. [12] Eli Chien, Chao Pan, Jianhao Peng, and Olgica Milenkovic. 2022. You are allset: multiset function framework for hypergraph neural networks. In ICLR. [13] Hilary Smith Connery. 2015. Medication-assisted treatment of opioid use disorder: review of the evidence and future directions. Harvard review of psychiatry 23, 2 (2015), 6375. [14] Xinyu Dong, Rachel Wong, Weimin Lyu, Kayley Abell-Hart, Jianyuan Deng, Yinan Liu, Janos Hajagos, Richard Rosenthal, Chao Chen, and Fusheng Wang. 2023. An integrated LSTM-HeteroRGNN model for interpretable opioid overdose risk prediction. Artificial intelligence in medicine 135 (2023), 102439. [15] Yihe Dong, Will Sawin, and Yoshua Bengio. 2020. Hnhn: Hypergraph networks with hyperedge neurons. arXiv preprint arXiv:2006.12278 (2020). [16] Deborah Dowell. 2022. CDC clinical practice guideline for prescribing opioids for painUnited States, 2022. MMWR. Recommendations and reports 71 (2022). [17] Vijay Prakash Dwivedi, Ladislav Ramp√°≈°ek, Michael Galkin, Ali Parviz, Guy Wolf, Anh Tuan Luu, and Dominique Beaini. 2022. Long range graph benchmark. In NeurIPS. [18] Johanna Dwyer, Mary Frances Picciano, Daniel Raiten, Steering Committee, et al. 2003. Estimation of usual intakes: what we eat in AmericaNHANES. The Journal of nutrition 133, 2 (2003), 609S623S. [19] Yujie Fan, Yiming Zhang, Yanfang Ye, and Xin Li. 2018. Automatic Opioid User Detection from Twitter: Transductive Ensemble Built on Different Meta-graph Based Similarities over Heterogeneous Information Network.. In IJCAI. [20] Yujie Fan, Yiming Zhang, Yanfang Ye, Xin Li, and Wanhong Zheng. 2017. Social media for opioid addiction epidemiology: Automatic detection of opioid addicts from twitter and case studies. In Proceedings of the 2017 ACM on Conference on Information and Knowledge Management. 12591267. [21] Yifan Feng, Haoxuan You, Zizhao Zhang, Rongrong Ji, and Yue Gao. 2019. Hypergraph neural networks. In AAAI. [22] Matthias Fey, Jinu Sunil, Akihiro Nitta, Rishi Puri, Manan Shah, Blaz Stojanovic, Ramona Bendias, Barghi Alexandria, Vid Kocijan, Zecheng Zhang, Xinwei He, Jan E. Lenssen, and Jure Leskovec. 2025. PyG 2.0: Scalable Learning on Real World Graphs. In Temporal Graph Learning Workshop at KDD. [23] Curtis Florence, Feijun Luo, and Ketra Rice. 2021. The economic burden of opioid use disorder and fatal opioid overdose in the United States, 2017. Drug and alcohol dependence 218 (2021), 108350. [24] Victor Garc√≠a and Laura Gonz√°lez. 2009. Labor migration, drug trafficking organizations, and drug use: major challenges for transnational communities in Mexico. Urban anthropology and studies of cultural systems and world economic development 38, 2-4 (2009), 303. KDD 26, August 913, 2026, Jeju, Korea Tianyi Ma et al. [25] Akshay Goel, Almog Gueta, Omry Gilon, Chang Liu, Sofia Erell, Lan Huong Nguyen, Xiaohong Hao, Bolous Jaber, Shashir Reddy, Rupesh Kartha, et al. 2023. Llms accelerate annotation for medical information extraction. In ML4H. [26] Ja Gu, Penelope Allison, Alexis Grimes Trotter, Luenda Charles, Claudia Ma, Matthew Groenewold, Michael Andrew, and Sara Luckhaupt. 2022. Prevalence of self-reported prescription opioid use and illicit drug use among US adults: NHANES 20052016. Journal of occupational and environmental medicine 64, 1 (2022), 3945. [27] Will Hamilton, Zhitao Ying, and Jure Leskovec. 2017. Inductive representation learning on large graphs. In NeurIPS. [28] Chuanbo Hu, Minglei Yin, Bin Liu, Xin Li, and Yanfang Ye. 2021. Detection of illicit drug trafficking events on instagram: deep multimodal multilabel learning approach. In CIKM. [29] Chuanbo Hu, Minglei Yin, Bin Liu, Xin Li, and Yanfang Ye. 2021. Identifying illicit drug dealers on instagram with large-scale multimodal data fusion. ACM Transactions on Intelligent Systems and Technology (TIST) (2021). [30] Weihua Hu, Matthias Fey, Marinka Zitnik, Yuxiao Dong, Hongyu Ren, Bowen Liu, Michele Catasta, and Jure Leskovec. 2020. Open graph benchmark: Datasets for machine learning on graphs. In NeurIPS. [31] Ziniu Hu, Yuxiao Dong, Kuansan Wang, and Yizhou Sun. 2020. Heterogeneous graph transformer. In WWW. [32] Jiatan Huang, Zheyuan Zhang, Tianyi Ma, Mingchen Li, Yaning Zheng, Yanfang Ye, and Chuxu Zhang. 2026. GLEN-Bench: Graph-Language based Benchmark for Nutritional Health. arXiv preprint arXiv:2601.18106 (2026). [33] Caitlin Hughes, David Bright, and Jenny Chalmers. 2017. Social network analysis of Australian poly-drug trafficking networks: How do drug traffickers manage multiple illicit drugs? Social Networks 51 (2017), 135147. [34] Kendall Jeynes and Leigh Gibson. 2017. The importance of nutrition in aiding recovery from substance use disorders: review. Drug and alcohol dependence 179 (2017), 229239. [35] Mingxuan Ju, Shifu Hou, Yujie Fan, Jianan Zhao, Yanfang Ye, and Liang Zhao. 2022. Adaptive kernel graph neural network. In Proceedings of the AAAI conference on artificial intelligence, Vol. 36. 70517058. [36] Mingxuan Ju, Wenhao Yu, Tong Zhao, Chuxu Zhang, and Yanfang Ye. 2022. Grape: Knowledge graph enhanced passage reader for open-domain question answering. arXiv preprint arXiv:2210.02933 (2022). [37] Dallin Judd, Connor King, Curtis Galke, Connor King, and Curtis Galke. 2023. The opioid epidemic: review of the contributing factors, negative consequences, and best practices. Cureus 15, 7 (2023). [38] Maulik Kamdar, Tymor Hamamsy, Shea Shelton, Ayin Vala, Tome Eftimov, James Zou, and Suzanne Tamang. 2019. knowledge graph-based approach for exploring the US opioid epidemic. arXiv preprint arXiv:1905.11513 (2019). [39] Ali Kheradmand and Azadeh Kheradmand. 2020. Nutritional status in patients under methadone maintenance treatment. Journal of Substance Use 25, 2 (2020), 173176. [40] Thomas N. Kipf and Max Welling. 2017. Semi-Supervised Classification with Graph Convolutional Networks. In ICLR. [41] Anita Lavorgna. 2014. Internet-mediated drug trafficking: towards better understanding of new criminal dynamics. Trends in organized crime 17, 4 (2014), 250270. [42] Anita Lavorgna. 2016. How the use of the internet is affecting drug trafficking practices. (2016). [43] Guillaume Lema√Ætre, Fernando Nogueira, and Christos K. Aridas. 2017. Imbalanced-learn: Python Toolbox to Tackle the Curse of Imbalanced Datasets in Machine Learning. Journal of Machine Learning Research 18, 17 (2017), 15. http://jmlr.org/papers/v18/16-365 [44] Yiyang Li, Zheyuan Zhang, Tianyi Ma, Zehong Wang, Keerthiram Murugesan, Chuxu Zhang, and Yanfang Ye. 2026. LongDA: Benchmarking LLM Agents for Long-Document Data Analysis. arXiv preprint arXiv:2601.02598 (2026). [45] Zhixun Li, Liang Wang, Xin Sun, Yifan Luo, Yanqiao Zhu, Dingshuo Chen, Yingtao Luo, Xiangxin Zhou, Qiang Liu, Shu Wu, et al. 2023. GSLB: the graph structure learning benchmark. In NeurIPS. [46] Juan Antonio Lossio-Ventura, Wenyu Song, Michael Sainlaire, Patricia Dykes, and Tina Hernandez-Boussard. 2022. Opioid2MME: standardizing opioid prescriptions to morphine milligram equivalents from electronic health records. International journal of medical informatics 162 (2022), 104739. [47] Shang Ma, Tianyi Ma, Jiahao Liu, Wei Song, Zhenkai Liang, Xusheng Xiao, and Yanfang Ye. 2025. PsyScam: benchmark for psychological techniques in realworld scams. arXiv preprint arXiv:2505.15017 (2025). [48] Tianyi Ma, Yiyue Qian, Zehong Wang, Zheyuan Zhang, Chuxu Zhang, and Yanfang Ye. 2025. Llm-empowered class imbalanced graph prompt learning for online drug trafficking detection. In Findings of ACL. [49] Tianyi Ma, Yiyue Qian, Zehong Wang, Zheyuan Zhang, Shinan Zhang, Chuxu Zhang, and Fanny Ye. 2025. Hypergraph Representation Learning with Adaptive Broadcasting and Receiving. In ICDM. [51] Tianyi Ma, Yiyue Qian, Shinan Zhang, Chuxu Zhang, and Yanfang Ye. 2025. Adaptive expansion for hypergraph learning. arXiv preprint arXiv:2502.15564 (2025). [52] Tianyi Ma, Yiyue Qian, Zheyuan Zhang, Zehong Wang, Xiaoye Qian, Feifan Bai, Yifan Ding, Xuwei Luo, Shinan Zhang, Keerthiram Murugesan, et al. 2025. Autodata: multi-agent system for open web data collection. In NeurIPS. [53] Johanna Catherine Maclean, Justine Mallatt, Christopher Ruhm, and Kosali Simon. 2020. Economic studies on the opioid crisis: review. (2020). [54] Adriana Matos, David Bankes, Kevin Bain, Tyler Ballinghoff, and Jacques Turgeon. 2020. Opioids, polypharmacy, and drug interactions: technological paradigm shift is needed to ameliorate the ongoing opioid epidemic. Pharmacy 8, 3 (2020), 154. [55] Henry McQuay. 1999. Opioids in pain management. The Lancet 353, 9171 (1999), 22292232. [56] Mehta and RM Langford. 2006. Acute pain management for opioid dependent patients. Anaesthesia 61, 3 (2006), 269276. [57] Janice Montville, Jaspreet KC Ahuja, Carrie Martin, Kaushalya Heendeniya, Grace Omolewa-Tomobi, Lois Steinfeldt, Jaswinder Anand, Meghan Adler, Randy LaComb, and Alanna Moshfegh. 2013. USDA food and nutrient database for dietary studies (FNDDS), 5.0. Procedia Food Science 2 (2013), 99112. [58] Joonhyung Park, Jaeyun Song, and Eunho Yang. 2021. Graphens: Neighbor-aware ego network synthesis for class-imbalanced node classification. In ICLR. [59] Gavril Pasternak. 2014. Opiate pharmacology and relief of pain. Journal of Clinical Oncology 32, 16 (2014), 16551661. [60] Yiyue Qian, Tianyi Ma, Chuxu Zhang, and Yanfang Ye. 2025. Adaptive graph enhancement for imbalanced multi-relation graph learning. In WSDM. [61] Yiyue Qian, Chunhui Zhang, Yiming Zhang, Qianlong Wen, Yanfang Ye, and Chuxu Zhang. 2022. Co-modality graph contrastive learning for imbalanced node classification. Advances in Neural Information Processing Systems 35 (2022), 1586215874. [62] Yiyue Qian, Yiming Zhang, Yanfang Ye, Chuxu Zhang, et al. 2021. Distilling meta knowledge on heterogeneous graph for illicit drug trafficker detection on social media. In NeurIPS. [63] Columba Quigley, Palliative Cochrane Pain, and Supportive Care Group. 1996. Opioid switching to improve pain relief and drug tolerability. Cochrane Database of Systematic Reviews 2010, 11 (1996). [64] Aysha Rana and Kavetha Ram. 2025. Beyond REMS & PDMPs: Proposed Framework for Next-Generation Opioid Regulation. Therapeutic Innovation & Regulatory Science (2025), 112. [65] Nils Reimers and Iryna Gurevych. 2019. Sentence-bert: Sentence embeddings using siamese bert-networks. arXiv preprint arXiv:1908.10084 (2019). [66] Katie Rosman and Daniel Neill. 2023. Detecting anomalous networks of opioid prescribers and dispensers in prescription drug data. In AAAI. [67] Michael Schlichtkrull, Thomas Kipf, Peter Bloem, Rianne Van Den Berg, Ivan Titov, and Max Welling. 2018. Modeling relational data with graph convolutional networks. In ESWC. [68] Rohanit Singh and Gary Pushkin. 2019. How should medical education better prepare physicians for opioid prescribing? AMA Journal of Ethics 21, 8 (2019), 636641. [69] Yijun Tian, Kaiwen Dong, Chunhui Zhang, Chuxu Zhang, and Nitesh Chawla. 2023. Heterogeneous graph masked autoencoders. In AAAI. [70] Petar Veliƒçkoviƒá, Guillem Cucurull, Arantxa Casanova, Adriana Romero, Pietro Lio, and Yoshua Bengio. 2018. Graph attention networks. In ICLR. [71] Peihao Wang, Shenghao Yang, Yunyu Liu, Zhangyang Wang, and Pan Li. 2023. Equivariant hypergraph diffusion neural operators. In ICLR. [72] Xiao Wang, Houye Ji, Chuan Shi, Bai Wang, Yanfang Ye, Peng Cui, and Philip Yu. 2019. Heterogeneous graph attention network. In WWW. [73] Zehong Wang, Xiaolong Han, Qi Yang, Xiangru Tang, Fang Wu, Xiaoguang Guo, Weixiang Sun, Tianyi Ma, Pietro Lio, Le Cong, et al. 2026. Molecular Representations in Implicit Functional Space via Hyper-Networks. arXiv preprint arXiv:2601.22327 (2026). [74] Zehong Wang, Sidney Liu, Zheyuan Zhang, Tianyi Ma, Chuxu Zhang, and Yanfang Ye. 2025. Can LLMs convert graphs to text-attributed graphs?. In NAACL. [75] Zehong Wang, Zheyuan Liu, Tianyi Ma, Jiazheng Li, Zheyuan Zhang, Xingbo Fu, Yiyang Li, Zhengqing Yuan, Wei Song, Yijun Ma, et al. 2025. Graph foundation models: comprehensive survey. arXiv preprint arXiv:2505.15116 (2025). [76] Zehong Wang, Zheyuan Zhang, Nitesh Chawla, Chuxu Zhang, and Yanfang Ye. 2024. Gft: Graph foundation model with transferable tree vocabulary. Advances in Neural Information Processing Systems 37 (2024), 107403107443. [77] Zehong Wang, Zheyuan Zhang, Tianyi Ma, Nitesh Chawla, Chuxu Zhang, and Yanfang Ye. 2025. Beyond message passing: Neural graph pattern machine. arXiv preprint arXiv:2501.18739 (2025). [78] Zehong Wang, Zheyuan Zhang, Tianyi Ma, Nitesh Chawla, Chuxu Zhang, and Yanfang Ye. 2025. Towards graph foundation models: Learning generalities across graphs via task-trees. In ICML. [50] Tianyi Ma, Yiyue Qian, Chuxu Zhang, and Yanfang Ye. 2023. Hypergraph con- [79] Zehong Wang, Zheyuan Zhang, Tianyi Ma, Chuxu Zhang, and Yanfang Ye. 2025. trastive learning for drug trafficking community detection. In ICDM. Generative graph pattern machine. In NeurIPS. Opbench : Graph Benchmark to Combat the Opioid Crisis KDD 26, August 913, 2026, Jeju, Korea [80] Qiang Wei, Amy Franklin, Trevor Cohen, and Hua Xu. 2018. Clinical text annotationwhat factors are associated with the cost of time?. In AMIA, Vol. 2018. 1552. [81] Qianlong Wen, Zhongyu Ouyang, Jianfei Zhang, Yiyue Qian, Yanfang Ye, and Chuxu Zhang. 2022. Disentangled dynamic heterogeneous graph learning for opioid overdose prediction. In KDD. [82] World Health Organization. 2023. Urgent action needed to tackle Sustainable Development Goals. progress on health-related stalled https://www.who.int/news/item/19-05-2023-urgent-action-needed-totackle-stalled-progress-on-health-related-sustainable-development-goals [83] Yanfang Ye, Zheyuan Zhang, Tianyi Ma, Zehong Wang, Yiyang Li, Shifu Hou, Weixiang Sun, Kaiwen Shi, Yijun Ma, Wei Song, et al. 2025. Llms4all: review of large language models across academic disciplines. arXiv preprint arXiv:2509.19580 (2025). [84] Zhengqing Yuan, Yixin Liu, Yihan Cao, Weixiang Sun, Haolong Jia, Ruoxi Chen, Zhaoxu Li, Bin Lin, Li Yuan, Lifang He, et al. 2024. Mora: Enabling generalist video generation via multi-agent framework. arXiv preprint arXiv:2403.13248 (2024). [85] Chuxu Zhang, Dongjin Song, Chao Huang, Ananthram Swami, and Nitesh Chawla. 2019. Heterogeneous graph neural network. In KDD. [86] Zheyuan Zhang, Yiyang Li, Nhi Ha Lan Le, Zehong Wang, Tianyi Ma, Vincent Galassi, Keerthiram Murugesan, Nuno Moniz, Werner Geyer, Nitesh Chawla, et al. 2025. Ngqa: nutritional graph question answering benchmark for personalized health-aware nutritional reasoning. In ACL. [87] Zheyuan Zhang, Kaiwen Shi, Zhengqing Yuan, Zehong Wang, Tianyi Ma, Keerthiram Murugesan, Vincent Galassi, Chuxu Zhang, and Yanfang Ye. 2025. AgentRouter: Knowledge-Graph-Guided LLM Router for Collaborative Multi-Agent Question Answering. arXiv preprint arXiv:2510.05445 (2025). [88] Zheyuan Zhang, Zehong Wang, Shifu Hou, Evan Hall, Landon Bachman, Jasmine White, Vincent Galassi, Nitesh Chawla, Chuxu Zhang, and Yanfang Ye. 2024. Diet-odin: novel framework for opioid misuse detection with interpretable dietary patterns. In KDD. [89] Zheyuan Zhang, Zehong Wang, Tianyi Ma, Varun Sameer Taneja, Sofia Nelson, Nhi Ha Lan Le, Keerthiram Murugesan, Mingxuan Ju, Nitesh Chawla, Chuxu Zhang, et al. 2024. MOPI-HFRS: Multi-objective Personalized Health-aware Food Recommendation System with LLM-enhanced Interpretation. arXiv preprint arXiv:2412.08847 (2024). [90] Jianan Zhao, Qianlong Wen, Mingxuan Ju, Chuxu Zhang, and Yanfang Ye. 2023. Self-supervised graph structure refinement for graph neural networks. In Proceedings of the sixteenth ACM international conference on web search and data mining. 159167. [91] Jianan Zhao, Qianlong Wen, Shiyu Sun, Yanfang Ye, and Chuxu Zhang. 2021. Multi-view self-supervised heterogeneous graph embedding. In Joint European conference on machine learning and knowledge discovery in databases. Springer, 319334. [92] Tianxiang Zhao, Xiang Zhang, and Suhang Wang. 2021. Graphsmote: Imbalanced node classification on graphs with graph neural networks. In WSDM. [93] Zhuoyuan Zheng, Yunpeng Cai, and Ye Li. 2015. Oversampling method for imbalanced classification. Computing and Informatics 34, 5 (2015), 10171037."
        },
        {
            "title": "A Baseline Implementation Details",
            "content": "Our benchmark framework supports all graph learning methods seamlessly. We implement classic baseline methods in the literature, including feature-based methods (G1), graph neural networks (G2), heterogeneous graph neural networks (G3), multi-relational graph neural networks (G4), and hypergraph neural networks (G5). In this section, we provide detailed descriptions and implementation details for each method. G1. Feature-based Methods. We implement the following featurebased methods as baselines that ignore the graph structure, serving as important references to evaluate whether graph-based methods provide meaningful improvements over structure-agnostic approaches. MLP serves as the foundational baseline that processes node features independently without considering graph topology. For each layer, it applies series of linear transformations, followed by nonlinear activations, to produce node representations. Oversampling [93] is feature-based method that addresses class imbalance by randomly creating samples from minority classes to match the majority class distribution. SMOTE [10] generates synthetic samples for minority classes by interpolating between existing minority samples and their k-nearest neighbors in the feature space. For Oversampling and SMOTE, we apply these techniques on the training set while preserving the original class distribution in validation and test sets to ensure unbiased evaluation. Moreover, we obtain source code for these methods from the widely used imbalanced-learn library [43] to ensure standardized, reproducible code. G2. Graph Neural Networks (GNNs). We implement the following GNNs as baselines for homogeneous graph learning. GCN [40] performs spectral graph convolutions through firstorder approximation of localized spectral filters. GCN aggregates information from neighboring nodes through symmetric normalization, making it fundamental baseline for evaluating graph structure utilization. GAT [70] introduces attention mechanisms with coefficient computation to learn adaptive importance weights for different neighbors during message passing. GraphSAGE [27] learns node embeddings through sampling and aggregating features from fixed-size neighborhood, enabling inductive learning on unseen nodes. We use the mean aggregator in our implementation for computational efficiency and stable performance. GraphSMOTE [92] extends SMOTE to graph-structured data by generating synthetic nodes for minority classes while preserving graph topology. It first embeds nodes using GNN encoder, then generates synthetic minority nodes in the embedding space through interpolation, and finally reconstructs edges for synthetic nodes based on learned edge predictors. To run GNNs over heterogeneous graphs, we ignore node and edge types and treat all nodes and edges as homogeneous, allowing us to evaluate the effectiveness of GNNs without explicit modeling of heterogeneity. Following existing work [12, 51], for the hypergraph datasets X-HyDrug-Comm and X-HyDrug-Role, we apply clique expansion to convert each hyperedge into pairwise edges between connected node pairs. We implement these methods based on the PyG library [22]. G3. Heterogeneous Graph Neural Networks (HetGNNs). We implement the following HetGNNs as baselines for heterogeneous graph learning, which explicitly model multiple node and edge types to capture the rich semantic information in opioid crisis data. HAN [72] employs hierarchical attention mechanism consisting of node-level and semantic-level attention. Node-level attention learns the importance ofmeta-path-basedd neighbors, while semantic-level attention learns the importance of different meta-paths. HGT [31] adapts the Transformer architecture to heterogeneous graphs by introducing type-specific linear projections and relationaware attention. HGMAE [69] is self-supervised pre-training method that learns node representations by reconstructing masked node features and graph structures. HGMAE first masks portion of nodes and their KDD 26, August 913, 2026, Jeju, Korea Tianyi Ma et al. associated edges, then uses heterogeneous graph encoder to embed the corrupted graph, and finally reconstructs the masked content through type-specific decoders. The pre-trained encoder is then fine-tuned for downstream tasks. We implement these methods using the source code from their original papers to ensure rigorous, reproducible execution. For metapath-based methods, we design metapaths that capture meaningful relationships in the networks, and list them in Table 8 and Table 9 for datasets Pdmp-OD-Det and NHANES-Diet, respectively. G4. Multi-Relational Graph Neural Networks (MRGNNs). We implement the following MRGNNs as baselines for multi-relational graph learning, which handle graphs with single node type but multiple edge types representing different interaction semantics. R-GCN [67] extends GCN to multi-relational graphs by learning relation-specific transformation matrices. GraphENS [58] addresses class imbalance through neighbor sampling strategy that considers both node features and local topology. GraphENS synthesizes ego networks for minority-class nodes by interpolating between existing minority samples and their structural neighborhoods, thereby preserving local graph structure during augmentation. AD-GSMOTE [60] extends GraphSMOTE with an adaptive mechanism that dynamically adjusts the synthesis strategy based on local graph density and class distribution. G5. Hypergraph Neural Networks (HyGNNs). We implement the following HyGNNs as baselines for hypergraph learning, which capture higher-order interactions among multiple nodes through hyperedges. HGNN [21] generalizes spectral graph convolution to hypergraphs using the hypergraph Laplacian. HNHN [15] introduces learnable hyperedge representations that evolve alongside node representations. By maintaining explicit hyperedge embeddings, HNHN captures the semantics of group interactions within drug-trafficking communities. HCHA [2] combines spectral hypergraph convolution with attention mechanisms to learn adaptive hyperedge importance, enabling the model to focus on the most relevant group interactions for role classification. AllSet [12] proposes unified framework that encompasses various hypergraph neural networks as special cases through multiset function learning. AllSet formulates hypergraph learning as two multiset functions, namely ùëì for node-to-hyperedge aggregation and ùëî for hyperedge-to-node aggregation, implemented using Deep Sets or Set Transformers. ED-HNN [71] introduces permutation equivariance and disentangled hypergraph operators for hypergraph representation learning."
        },
        {
            "title": "B Construction Guidelines for PDMP",
            "content": "B.1 Data Source The dataset is sourced from PDMP records provided by the State of Ohio Board of Pharmacy, covering the calendar year 2016 and comprising 1,395,958 controlled substance prescription records. Each record captures single dispensing event and includes patient demographics (age, sex, ZIP code), prescriber information (specialty, ZIP code, DEA identifier), pharmacy details (ZIP code, chain affiliation), and medication specifics (drug name, NDC code, therapeutic class, quantity, days supply, payment type). B.2 Data Cleaning and Preprocessing We apply the following cleaning steps to ensure data quality: Missing Value Handling. We remove records with missing values in essential fields, including prescription date, patient identifier, prescriber identifier, pharmacy identifier, and therapeutic class code. Moreover, for categorical attributes such as prescriber specialty and ZIP codes, we impute missing values with Unknown. Invalid Record Filtering. We exclude records with non-positive quantity or days supply values to prevent data entry errors. Date Standardization. We parse and standardize all prescription dates to ensure temporal consistency across records. B.3 Entity Construction and Feature Extraction We define four node types in the heterogeneous graph. For each entity, we generate textual descriptions from its attributes and encode them using SentenceBERT [65] (all-mpnet-base-v2) to produce 768-dimensional feature vectors: Patient (P.) Unique patient identifiers in the PDMP data constitute patient nodes, which serve as targets for overdose risk prediction. Feature descriptions incorporate patient identifier, age, sex, and ZIP code, e.g., ID: [hash], Age: 45, Sex: male, Zip: 43215. Prescriber (Pr.) Unique prescribers, such as physicians or healthcare providers, with valid DEA numbers, are represented as prescriber nodes. Feature descriptions incorporate prescriber identifier, ZIP code, specialty, and business activity codes, e.g., ID: [hash], Zip: 43215, Specialty: Pain Medicine, BAC: [code]. Pharmacy (Ph.) Unique dispensing pharmacies correspond to pharmacy nodes. Feature descriptions include pharmacy identifier, ZIP code, and business activity codes indicating chain affiliation, e.g., ID: [hash], Zip: 43210, BAC: [code]. Drug (D.) Unique therapeutic class codes define drug nodes. Feature descriptions contain NDC code, drug name, and therapeutic class, e.g., NDC: [code], Drug: Oxycodone, Class: Opioid Agonists ([code]). B.4 Edge Construction The graph contains five edge types derived from prescription records to capture the rich relationships among entities: This section presents the construction guidelines for the Pdmp-ODDet dataset, heterogeneous graph derived from Ohios PDMP data for opioid overdose risk detection. Patient-take-Drug (P.-take-D.): It connects patient to each therapeutic class of medication they receive. This edge captures the patients medication profile. Opbench : Graph Benchmark to Combat the Opioid Crisis KDD 26, August 913, 2026, Jeju, Korea Patient-pickup-Pharmacy (P.-pickup-Ph.): patient is linked to each pharmacy where they fill prescriptions. Multiple pharmacy connections may indicate pharmacy shopping behavior. Patient-visit-Prescriber (P.-visit-Pr.): It bridges patient to each prescriber who writes their prescriptions. Multiple prescriber connections may indicate doctor shopping behavior. Prescriber-prescribe-Drug (Pr.-prescribe-D.): This denotes connection between prescriber and therapeutic class the prescriber prescribed, capturing prescribing patterns and specialization. Pharmacy-dispense-Drug (Ph.-dispense-D.) pharmacy is linked with the therapeutic class it dispenses, indicating the pharmacy-level dispensing patterns. B.5 Overdose Risk Labeling We formulate the opioid overdose detection problem as binary classification task based on the overdose risk, based on established clinical guidelines [16, 46]: Positive Class (High Risk). Patients whose daily MME exceeds the CDC-recommended threshold, i.e., 90 MME/day, are labeled as high risk. Mention that MME provides standardized measure of opioid dosage across different medications, enabling consistent risk assessment. Negative Class (Low Risk). Patients with daily MME below the threshold are labeled as low risk. The resulting heterogeneous graph contains 54,318 nodes and 321,437 edges across five relation types. Table 8 summarizes the data statistics for Pdmp-OD-Det. Construction Guidelines for X/Twitter In this section, we discuss the data construction and annotation process for the X/Twitter datasets: X-HyDrug-Comm, X-HyDrugRole, and X-MRDrug-Role. C.1 Data Collection We first collect metadata via the official (formerly Twitter) API between December 2020 and August 2021, comprising 275,884,694 posts from 40,780,721 users. We filter for drug-relevant content using keyword list of 21 drug types linked to overdose and addiction (proposed by CDC), as listed in Table 7, leading to 266,975 drug-relevant posts from 54,680 users for annotation. C.2 Annotation Process Six domain experts spend 62 days to annotate the filtered users based on their posts, profiles, and interaction patterns. Each annotator labels users independently, in accordance with the guidelines below. When annotators disagree on label, they discuss the case until reaching consensus. C.3 Community Annotation Rules For X-HyDrug-Comm, we define six community types by pharmacological function: cannabis, opioid, hallucinogen, stimulant, depressant, and others, and we assign users to one or more communities based on the following rules: Active Promotion. Users who promote specific drugs on or interact frequently (following, replying, liking, retweeting) with drug-related accounts in given community. For example, seller advertising oxycodone, cocaine, and Xanax would be assigned to the opioid (oxycodone), stimulant (cocaine), and depressant (Xanax) communities. Overdose or Addiction Evidence. Users who post about overdose or addiction to specific substance. For example, user sharing opioid overdose experiences would be placed in the opioid community. Purchase Evidence. Users with evidence of purchasing specific drugs from others on X. Community assignment follows from the substances purchased. Active Discussion. Users who discuss or share drug-related content without direct evidence of selling, buying, or using. For instance, user who frequently retweets LSD promotion will be placed in the hallucinogen community. Unspecified Drugs. Users involved in drug-related activity who do not mention specific drug types are assigned to the others community. Since users may engage with multiple drug types, the task is formulated as overlapping community detection that each user can belong to multiple communities. Table 7 maps drug types to communities. Table 7: Drug community types and drug keywords. Community Type Representative Drugs (Keywords) Cannabis Opioid Hallucinogen Stimulant Depressant Others Cannabis and cannabis-infused products Oxycodone, Codeine, Morphine, Fentanyl, Hydrocodone LSD, MDMA, Shroom, Mescaline, DMT, Ketamine Cocaine, Amphetamine, Methamphetamine Xanax, Farmapram, Valium, Halcion, Ativan, Klonopin Drugs not listed above C.4 Role Annotation Rules For X-HyDrug-Role and X-MRDrug-Role, we classify users into four roles based on their behavior in drug trafficking networks: Drug Seller. We classify users who advertise or sell drugs on as drug sellers. These accounts typically post drug names, street slang, prices, or contact information, and frequently use drugrelated hashtags and emojis to attract buyers. Drug Buyer. Users with evidence of purchasing drugs on X, including those who respond to advertisements, negotiate transactions, or discuss past purchases, are considered as drug buyers. Drug User. Users showing signs of drug use, addiction, or overdose belong to the drug users. They may post about consumption habits or withdrawal symptoms, or seek information about drug effects, without evidence of selling or buying. Discussion. Users who discuss or share drug-related content without evidence of selling, buying, or using are classified as discussion. This includes harm reduction discussions, news sharing, and general commentary. KDD 26, August 913, 2026, Jeju, Korea Tianyi Ma et al. Table 8: Statistics for the benchmark PDMP-OD-Det. Table 9: Statistics for the benchmark NHANES-Diet. Node Type Patient (P.) Prescriber (Pr.) Pharmacy (Ph.) Drug (D.) Edge Type P.-take-D. P.-pickup-Ph. P.-visit-Pr. Pr.-prescribe-D. Ph.-dispense-D. Metapath Type P.-D.-P. P.-Ph.-P. P.-Pr.-P. P.-Pr.-D.-Pr.-P. P.-Ph.-D.-Ph.-P. #Nodes"
        },
        {
            "title": "Feature Dim",
            "content": "30,574 21,159 2,517 68 768 768 768 768 #Edges 76,172 57,700 86,055 66,544 34,966 #Edges 306,338 303,945 265,346 305,375 305,897 Each user is assigned exactly one role based on dominant behavior, resulting in multi-class classification task. C.5 Feature Extraction For each user node, we extract text from the anonymized usernames, profiles, and tweets. We split tweets into drug-related and drugunrelated groups using the keyword list. We keep all drug-related tweets and up to five drug-unrelated tweets per user, favoring those with interactions in the drug community. We encode the combined text with SentenceBERT [65] to produce fixed-length feature vectors. C.6 Hyperedge Construction For the hypergraph datasets (X-HyDrug-Comm and X-HyDrugRole), we define the following four hyperedge types: Users-Follow-User connects users who follow the same account, capturing follower circles within drug communities. Users-Engage-Conversation links users in the same tweet thread (posting, replying, retweeting, or liking), capturing shared topics. Users-Include-Hashtag connects users whose tweets contain the same drug-related hashtag. Users-Contain-Emoji connects users who use the same drugrelated emoji in tweets or profiles."
        },
        {
            "title": "D Construction Guidelines for NHANES",
            "content": "Node Type User (U.) Food (F.) Ingredient (I.) Category (C.) Habit (H.) Edge Type U.-eat-F. F.-contain-I. F.-belong-C. U.-has-H. Metapath Type U.-F.-U. U.-H.-U. U.-F.-I.-F.-U. U.-F.-C.-F.-U. #Nodes"
        },
        {
            "title": "Feature Dim",
            "content": "4,826 5,896 2,792 174 54 37 814 768 768 768 #Edges 273,934 38,820 38,820 93,894 #Edges 17,546,430 23,285,466 22,485,257 21,604,607 (FNDDS) food codes [57], database maintained by the USDA that catalogs food and beverage consumption in the What We Eat In America (WWEIA) survey [18]. D.2 Entity Construction and Feature Extraction We define five node types in the heterogeneous graph, each with distinct feature representations: User (U.) Unique NHANES respondents constitute user nodes, which serve as targets for opioid misuse prediction. User features consist of 37 demographic attributes, including age, gender, race, education level, income, and health indicators. Food (F.) Unique FNDDS food codes correspond to food nodes. Food features comprise 814 dimensions: 46 nutrient values (e.g., calories, protein, fat, vitamins, minerals) concatenated with 768dimensional BERT embeddings of the food description. Ingredient (I.) Food ingredients from the FNDDS ingredient database define ingredient nodes that link to their parent food items. Feature representations are 768-dimensional BERT embeddings of ingredient descriptions. Category (C.) WWEIA food categories represent category nodes that group related foods, such as Milk and Dairy, Meat and Poultry, etc. Feature representations are 768-dimensional BERT embeddings of category descriptions. Habit (H.) Dietary habit patterns derived from behavioral questionnaires constitute habit nodes. Feature representations are 768-dimensional BERT embeddings of habit descriptions. Next, we discuss the construction guidelines for the heterogeneous graph NHANES-Diet. D.3 Dietary Habit Annotation D.1 Data Source The dataset is obtained from NHANES [7] and covers the period 2003 to 2020, including dietary intake records, demographic information, and drug-use questionnaires. Food records in NHANES are encoded using Food and Nutrient Database for Dietary Studies We compile dietary habit data from various NHANES tables, including Diet Behavior and Consumer Behavior questionnaires. team of four domain experts meticulously examines the NHANES data to identify features indicative of dietary habits, such as awareness of healthy diet or frequency of consuming frozen food. For each identified feature, we apply threshold-based annotation strategy: Opbench : Graph Benchmark to Combat the Opioid Crisis KDD 26, August 913, 2026, Jeju, Korea We select the top 10% and bottom 10% of respondents based on their responses. Users in the top 10% receive positive habit tag, while users in the bottom 10% receive contrasting habit tag. For example, among respondents to the milk consumption questionnaire, the top 10% receive the habit drink lots of milk, while the bottom 10% receive drink little or no milk. Through this process, we derive 54 distinct dietary habits that capture meaningful patterns in users eating behaviors. D.4 Edge Construction We define four edge types that capture relationships among entities: User-eat-Food (U.-eat-F.) connects user to each food item they consume based on their dietary intake records. This edge captures individual food consumption patterns. Food-contain-Ingredient (F.-contain-I.) connects food item to its constituent ingredients based on the FNDDS ingredient database. This edge enables reasoning about nutritional composition. Food-belong-Category (F.-belong-C.) links food node to its WWEIA food category. This edge captures semantic groupings of related foods. User-has-Habit (U.-has-H.): connects user to their assigned dietary habits based on the annotation process. This edge captures behavioral patterns indicative of dietary preferences. D.5 Opioid Misuse Labeling We formulate opioid misuse prediction as binary classification task based on criteria commonly employed in public health research [26]. Specifically, user is labeled as positive (opioid misuse) if either: (i) they have records of using heroin within the past year, or (ii) they have records of using prescription opioid medication continuously for more than 90 days. Otherwise, the user is labeled as negative. The resulting heterogeneous graph contains 13,742 nodes and 445,468 edges across four relation types. Table 9 summarizes the data statistics for NHANES-Diet."
        },
        {
            "title": "E Additional Experiments",
            "content": "To provide practical guidance for deploying graph learning methods on opioid crisis datasets, we conduct an efficiency analysis examining how inference time scales with model capacity. We evaluate representative methods across X-HyDrug-Comm, X-HyDrug-Role, and NHANES-Diet, varying the hidden dimension from 64 to 512. Figure 2 presents the inference time for each configuration. Illicit Drug Trafficking Detection. For hypergraph datasets, MLP exhibits the most stable inference time across all hidden dimensions, ranging from 35 to 38 ms on X-HyDrug-Comm and 38 to 41 ms on X-HyDrug-Role, with minimal sensitivity to increased model capacity. Among HyGNNs, HCHA and ED-HNN maintain relatively low inference times even at larger hidden dimensions. On X-HyDrug-Comm, ED-HNN ranges from 36 to 57 ms, while HCHA ranges from 36 to 57 ms across dimensions 64 to 512. HGNN and AllSet show moderate scaling, with inference times increasing from 49 and 56 ms at dimension 64 to 62 and 63 ms at dimension 512. HNHN exhibits similar scaling behavior, spanning 42-62 ms. On X-HyDrug-Role, all methods demonstrate comparable scaling patterns, with ED-HNN maintaining the lowest inference times and HCHA showing efficient performance. Opioid Misuse Detection. For the heterogeneous graph dataset NHANES-Diet, we observe substantial variation in inference efficiency across methods. MLP is the most efficient, with inference time scaling linearly from 0.22 ms to 1.09 ms. GCN provides efficient graph-based inference, with inference times ranging from 1.35 to 4.66 ms across hidden dimensions. R-GCN incurs moderate overhead for relation-specific transformations, scaling from 3.65 to 6.64 ms. GAT shows quadratic scaling behavior due to attention computation, with inference time increasing from 5.85 ms to 32.75 ms. HGT exhibits similar scaling, ranging from 8.76 to 39.96 ms. HAN incurs the highest computational cost due to its hierarchical attention mechanism, with inference time scaling from 48.53 ms to 192.45 ms. Practical Recommendations. Based on these findings, we offer the following recommendations for practitioners: (1) For hypergraph datasets, all evaluated methods exhibit comparable inference times, making model selection primarily driven by performance requirements rather than computational constraints. (2) For heterogeneous graph datasets, attention-based methods (HAN, HGT, GAT) incur significantly higher inference costs that scale poorly with hidden dimension; R-GCN and GCN offer substantially more efficient alternatives suitable for latency-sensitive applications. (3) MLP provides the fastest inference across all settings, making it valuable for rapid prototyping or resource-constrained deployments where graph structure can be sacrificed. Ethical Considerations and Broader Impact F.1 Ethics Statement Our research adheres to the ethical standards for data privacy and human subjects protection. The PDMP dataset from the State of Ohio Board of Pharmacy is obtained under data use agreement and is fully de-identified before analysis, ensuring that no personally identifiable information (PII) was exposed. Similarly, the NHANES data is publicly available, de-identified dataset provided by the CDC. For the social media data collected from X/Twitter, we strictly follow the platforms Terms of Service and Developer Agreement. All user identifiers are hashed, and no individual users are identified in our research including annotation, data construction, and release. We acknowledge the sensitive nature of opioid-related data and have implemented rigorous security protocols to prevent misuse. Moreover, we release our benchmark in graph formats that do not contain any raw text or user-level data, further mitigating privacy risks. Since we use Sentence-BERT [65] to generate node features from text data, it is impossible to reconstruct the original text from the features, ensuring that no sensitive information is exposed through the released datasets. F.2 Broader Impact Opbench has the potential to significantly enhance the capabilities of public health authorities and law enforcement in identifying and intervening in the opioid crisis. By providing standardized platform for graph-based risk detection, we facilitate the development of more accurate early warning systems for overdoses and the disruption of illicit supply chains. However, we caution that these KDD 26, August 913, 2026, Jeju, Korea Tianyi Ma et al. Figure 2: Inference time (ms) across hidden dimensions (64, 128, 256, 512). Left and middle panels show hypergraph neural networks on X-HyDrug-Comm and X-HyDrug-Role; right panel shows heterogeneous graph neural networks on NHANESDiet. models should be used as decision-support tools by qualified professionals to avoid algorithmic bias or stigmatization of vulnerable populations. F.3 Limitations Despite the comprehensive nature of Opbench, several limitations exist. First, the PDMP data is restricted to single state (Ohio) and specific timeframe (2016), which may not capture the evolving patterns of the synthetic opioid crisis in recent years. Second, online drug trafficking detection on social media platforms only represents portion of the illicit market, as traffickers frequently migrate to encrypted platforms or the dark web. Third, nutritional biomarkers are proxy indicators and should be used as part of multi-modal assessment rather than standalone diagnostic tool. We will continue maintain and update Opbench to address these limitations by incorporating more recent data, expanding to additional states, and exploring new data sources as they become available. Opbench : Graph Benchmark to Combat the Opioid Crisis KDD 26, August 913, 2026, Jeju, Korea Table 10: Best hyperparameters for models on Opbench. LR, WD, Drop, and Dim denote learning rate, weight decay, dropout, and hidden dimension, respectively. OOM indicates out-of-memory error during training. Train-10%Valid-10%Test-80% Train-20%Valid-10%Test-70% Train-50%Valid-10%Test-40%"
        },
        {
            "title": "LR WD Drop Dim",
            "content": "- MLP GCN GAT R-GCN HAN HGT HGMAE - P MLP GCN GAT - HGNN HNHN HCHA AllSet - ED-HNN MLP GCN GAT HGNN HNHN HCHA AllSet ED-HNN - D - 0.001 0.0001 0.0001 0.0001 0.0001 0.01 0.001 0.0001 0.001 0.0001 0.0 0.0 0.0 0.0 0.0 0.0 0.001 0.0001 0.0001 0.0001 0.001 0.0005 0.001 0.0001 0.0001 0.0001 0.001 0.001 0.0 0. 0.0 0.0 0.0001 0.0001 0.0001 0.0001 0.0001 0.0001 0.0001 0.0001 0.0001 0.0001 0.0001 0.0001 0.0 0.0 R - D - MLP 0.001 0.0005 Oversampling 0.001 0.0005 0.001 0.0005 SMOTE 0.001 GCN 0.001 GAT 0.001 GraphSage GraphENS 0.001 GraphSMOTE 0.001 AD-GSMOTE 0.001 0.0005 0.0 0.0 0.0 0.0 0.0 MLP GAT - GCN R-GCN HAN HGT 0.0 0.0 0.0 0.001 0.001 0.001 0.001 0.0001 0.001 0.001 0.0 0. 0.0 0.3 0.5 0.0 0.3 0.0 0.5 0.0 0.3 0.3 0.3 0.3 0.5 0.3 0.3 0.5 0.5 0.3 0.5 0.0 0.5 0.3 0.3 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 512 256 256 512 512 128 256 256 512 512 256 256 128 256 256 256 256 512 512 256 256 512 256 256 256 256 256 256 256 256 256 256 256 256 128 256 128 0.0 0.0 0.01 0.0001 0.0001 0.0001 0.0001 0.001 0.001 0.0001 0.001 0. 0.0 0.0 0.0 0.0 0.0001 0.001 0.0001 0.0005 0.0001 0.0001 0.0001 0.0001 0.0001 0.0001 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0. 0.001 0.001 0.001 0.001 0.0001 0.0005 0.0001 0.001 0.0001 0.001 0.0001 0.0 0.001 0.0005 0.001 0.0005 0.001 0.0005 0.001 0.001 0.001 0.001 0.001 0.001 0.0005 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.001 0.001 0.001 0.001 0.0001 0.001 0. 0.0 0.0 0.5 0.5 0.3 0.5 0.3 0.3 0.5 0.3 0.5 0.3 0.5 0.3 0.3 0.5 0.5 0.5 0.5 0.5 0.5 0.3 0.3 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0. 512 512 256 64 256 512 512 256 512 256 512 256 256 512 512 256 256 512 256 512 256 256 512 256 256 256 256 256 256 256 256 256 256 256 256 128 256 128 0.0001 0.0 0.0 0. 0.01 0.0001 0.0001 0.0001 0.001 0.0001 0.0001 0.0001 0.0001 0.01 0.001 0.0001 0.001 0.0001 0.001 0.0001 0.0001 0.0001 0.001 0.001 0.0001 0.001 0.001 0.0 0.0 0.0 0.0 0.0 0.0 0.001 0.001 0.001 0.001 0.0005 0.001 0.0001 0.0001 0.0001 0.001 0.001 0. 0.0 0.001 0.0005 0.001 0.0005 0.001 0.0005 0.001 0.001 0.001 0.001 0.001 0.001 0.0005 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.001 0.001 0.001 0.001 0.0001 0.001 0.001 0.0 0. 0.5 0.5 0.5 0.5 0.3 0.3 0.5 0.3 0.3 0.3 0.3 0.3 0.3 0.5 0.5 0.0 0.0 0.3 0.3 0.3 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 256 128 256 512 512 128 256 512 256 512 256 512 256 256 256 512 256 512 512 256 256 512 256 256 256 256 256 256 256 256 256 256 256 256 128"
        }
    ],
    "affiliations": [
        "Amazon",
        "University of Connecticut",
        "University of Notre Dame"
    ]
}