{
    "paper_title": "Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model",
    "authors": [
        "Dongki Kim",
        "Wonbin Lee",
        "Sung Ju Hwang"
    ],
    "sections": [
        {
            "title": "Abstract",
            "content": "Understanding molecules is key to understanding organisms and driving advances in drug discovery, requiring interdisciplinary knowledge across chemistry and biology. Although large molecular language models have achieved notable success in interpreting molecular structures, their instruction datasets are limited to the specific knowledge from task-oriented datasets and do not fully cover the fundamental characteristics of molecules, hindering their abilities as general-purpose molecular assistants. To address this issue, we propose Mol-LLaMA, a large molecular language model that grasps the general knowledge centered on molecules via multi-modal instruction tuning. To this end, we design key data types that encompass the fundamental features of molecules, incorporating essential knowledge from molecular structures. In addition, to improve understanding of molecular features, we introduce a module that integrates complementary information from different molecular encoders, leveraging the distinct advantages of different molecular representations. Our experimental results demonstrate that Mol-LLaMA is capable of comprehending the general features of molecules and generating relevant responses to users' queries with detailed explanations, implying its potential as a general-purpose assistant for molecular analysis."
        },
        {
            "title": "Start",
            "content": "Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model Dongki Kim 1 Wonbin Lee 1 Sung Ju Hwang"
        },
        {
            "title": "Abstract",
            "content": "Understanding molecules is key to understanding organisms and driving advances in drug discovery, requiring interdisciplinary knowledge across chemistry and biology. Although large molecular language models have achieved notable success in interpreting molecular structures, their instruction datasets are limited to the specific knowledge from task-oriented datasets and do not fully cover the fundamental characteristics of molecules, hindering their abilities as general-purpose molecular assistants. To address this issue, we propose Mol-LLaMA, large molecular language model that grasps the general knowledge centered on molecules via multi-modal instruction tuning. To this end, we design key data types that encompass the fundamental features of molecules, incorporating essential knowledge from molecular structures. In addition, to improve understanding of molecular features, we introduce module that integrates complementary information from different molecular encoders, leveraging the distinct advantages of different molecular representations. Our experimental results demonstrate that MolLLaMA is capable of comprehending the general features of molecules and generating relevant responses to users queries with detailed explanations, implying its potential as general-purpose assistant for molecular analysis. 5 2 0 2 9 1 ] . [ 1 9 4 4 3 1 . 2 0 5 2 : r 1. Introduction Understanding molecules and their properties is fundamental to understanding chemical compounds and living organisms, driving scientific discovery. However, it remains challenging due to the complexity of molecules and their behaviors, necessitating comprehensive understanding 1Korea Advanced Institute of Science and Technology (KAIST), Seoul, South Korea 2DeepAuto.ai. CorDongki Kim <cleverki@kaist.ac.kr>, respondence Wonbin Lee <smilelwb01@kaist.ac.kr>, Sung Ju Hwang <sungju.hwang@kaist.ac.kr>. to: Preliminary work. 1 of molecules. Recent advancements in large language models (LLMs) (Touvron et al., 2023; Grattafiori et al., 2024; OpenAI, 2024a;b) have demonstrated their potential in understanding core concepts in chemistry and biology (AI4Science & Quantum, 2023; Sadeghi et al., 2024). Further, LLMs have shown that language can play various roles, which is especially crucial to dealing with substantial complexity in chemistry, biology, and further pharmacology by readily obtaining external knowledge from users prompts. Nevertheless, LLMs can only process string representations such as SMILES (Weininger, 1988), struggling to understand the entire molecular structures. To integrate structural information into LLMs, recent works have developed molecular LLMs which are instructiontuned with the molecular modality, achieving notable success in task transfer. Specifically, recent works (Liu et al., 2023b; Cao et al., 2023; Fang et al., 2024; Zhang et al., 2024; Li et al., 2024; Park et al., 2024; Yu et al., 2024) adopt the multi-modal instruction tuning: 1) constructing moleculetext pairs from public databases or by utilizing GPTs to augment descriptions and 2) instruction-tuning LLMs with projectors in an end-to-end manner, as widely studied in multi-modal LLMs for image (Li et al., 2023; Liu et al., 2024a), audio (Fathullah et al., 2024), and video (Chen et al., 2023; Zhang et al., 2023; Maaz et al., 2024). Despite their success, molecular LLMs still encounter difficulties in understanding the fundamental characteristics of molecules. Even though the molecular features span wide range including structural, chemical, and biological features, their understanding falls short as the scope of knowledge handled by the instruction datasets is narrow and typically task-specific, forgetting the general knowledge of molecules and losing their capabilities to handle the users requests. As result, recent molecular LLMs struggle to accurately reason molecular properties and provide detailed rationales in the zero-shot setting, hindering their ability to serve as versatile, general-purpose molecular assistants. To address this issue, we propose Mol-LLaMA, which learns fundamental knowledge centered on molecules, positioning it as general-purpose molecular assistant. To this end, we first establish an instruction dataset that encompasses the core levels for molecular understanding, proposMol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model ing three data types including detailed structural descriptions, structure-to-feature relationship explanations, and comprehensive conversations. Our dataset is focused on not only the fundamental knowledge of molecules but also the reasoning ability as it is designed to explicitly provide causality by associating molecular features to the structures. Further, to improve the structural understanding, we introduce blending module that combines molecular information from both 2D and 3D encoders using the cross-attention mechanism. By integrating complementary information from different representations, the blending module facilitates alleviating the hallucination problem, improving to capture the structural information and thus enhancing the understanding of molecular features. We experimentally validate the effectiveness of MolLLaMA in explaining the general features of molecules at the structural, chemical, and biological levels. Our results demonstrate that Mol-LLaMA outperforms baselines including LLMs and molecular LLMs, providing accurate, detailed, and helpful responses. We further evaluate MolLLaMA on the molecular property prediction task, where it not only accurately predicts molecular properties but also generates relevant and helpful explanations, highlighting its utility as general-purpose assistant for molecular analysis. Our contributions can be summarized as follows: We propose Mol-LLaMA that learns general knowledge for molecules across structural, chemical, and biological aspects, empowering to provide accurate and helpful responses with detailed explanations. We design three different data types for the general understanding of molecules, establishing large and informative instruction dataset centered on molecular features. We devise blending module to fully leverage the complementary information from different types of encoders, alleviating the hallucination and thus enhancing the understanding of molecular structures and advanced features. The proposed Mol-LLaMA outperforms previous LLMs and molecular LLMs including GPT-4o in the general understanding by learning the comprehensive knowledge centered on molecules. 2. Related Works Molecular Foundation Models Molecular foundation models have achieved remarkable success in modeling molecules using string representations (Chithrananda et al., 2020; Fabian et al., 2020; Wang et al., 2019; Irwin et al., 2022), 2D molecular graphs (Ying et al., 2021; MendezLucio et al., 2024), 3D molecular graphs (Zhou et al., 2023; Lu et al., 2024) or texts from biomedical literature (Gu et al., 2021; Lee et al., 2020; Beltagy et al., 2019). Recently, with the emergence of molecule-text pair datasets, multimodal foundation models have been developed based on contrastive learning (Su et al., 2022; Liu et al., 2023a) or text decoders (Edwards et al., 2022; Zeng et al., 2022; Luo et al., 2023; Christofidellis et al., 2023; Liu et al., 2024c). Despite their success on the transfer learning, they are limited to conduct diverse tasks as general-purpose assistants. Large Language Models in Scientific Discovery Large language models (LLMs) (OpenAI, 2024a;b; Touvron et al., 2023; Grattafiori et al., 2024) have shown that they can play varied roles via textual interactions with users. Recently, AI4Science & Quantum (2023) have demonstrated promising potential of LLMs in understanding wide-ranging knowledge and solving complicated problems in the scientific field. Despite their notable progress, LLMs struggle to interpret raw string representations such as SMILES (Weininger, 1988) and SELFIES (Krenn et al., 2020), as tokenizing these representations is difficult to understand for LLMs which learn the subword representations. Large Molecular Language Models Along with the remarkable progress in multi-modal large language models (LLMs) (Liu et al., 2024b;a; Xu et al., 2024), molecular LLMs including MolCA (Liu et al., 2023b), MolInstructions (Fang et al., 2024), LlasMol (Yu et al., 2024), InstructMol (Cao et al., 2023), and 3D-MoLM (Li et al., 2024) have been developed by training LLMs on moleculetext pair datasets with string representations or graph representations modeled by 2D or 3D molecular encoder. In the concurrent work to ours, LLaMo (Park et al., 2024) proposes projector to seamlessly encode the molecular structures from 2D representations, while training on the public databases and the constructed conversations. Despite their promising performance on task transfer, they are not explicitly trained on the general features of molecules as the instruction datasets are typically task-specific, hindering them from functioning as general-purpose assistants. In this work, we aim to build molecular LLM capable of understanding of general features of molecules to be utilized as general-purpose assistant for molecular analysis. 3. Mol-LLaMA We present Mol-LLaMA, large molecular language model for the general understanding of molecules. 3.1. Preliminary of Multi-modal Instruction Tuning Multi-modal instruction tuning (Liu et al., 2024b) is designed to tailor an LLM to other modalities expanding its ability to perceive and understand the other domains such as images or graphs. Specifically, the instruction dataset is composed of pairs of multi-modal input (Xm) and the corresponding single-turn description or multi-turn conversation between user and an assistant (Xu, Xa). The loss objective is learning to generate the answer of an assistant given multi-modal input and query from users, as follows: 2 Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model L(θ) = (cid:88) log (xiXm, Xu, Xa,<i) , (1) where denotes the length of the answer. In this work, we consider the molecular graphs as the multi-modal inputs to align an LLM to understand the molecular features. 3.2. General Molecular Instruction Dataset Goal The instruction dataset poses at the core of the multimodal instruction tuning promoting understanding of other modalities. In the context of our work, solving scientific problems requires complex reasoning, since, unlike images that humans can directly understand, scientific problems are interdisciplinary and are not straightforward to solve, necessitating wide-ranging expertise including chemistry and biology. To this end, an ideal instruction dataset for molecular LLMs should entail comprehensive information including structural, chemical, and biological features with detailed explanations. However, existing instruction datasets lack comprehensive and general information. For example, as shown in the description in Table 1 (Context Type 2), while the original description provides structural information and some properties, these descriptions do not fully provide the overall properties of the given molecules in structural, chemical, and biological aspects. To address these issues, our goal is to establish an instruction dataset that explicitly presents the fundamental features of molecules and explains the principles of how these features arise, to build large language model with wide-ranging knowledge focused on molecular structures and their features. GPT-assisted Data Generation Our goal is to construct an instruction dataset that explains the fundamental features of molecules in detail. However, manually annotating the molecular features is tricky as it requires in-depth expertise in chemistry and biology. To mitigate this problem, we employ GPT-4o (OpenAI, 2024b) that contains extensive knowledge of chemistry and biology (AI4Science & Quantum, 2023). Inspired by previous works (Liu et al., 2024b; Park et al., 2024), we prompt GPT-4o to generate instruction data by leveraging two types of contexts: 1) string representations of molecules and 2) their descriptions. For the descriptions, we use annotated descriptions from PubChem (Kim et al., 2021) to provide grounded features. For the string representations, we use the IUPAC name, which explicitly specifies the names of functional groups and their connectivity (Favre & Powell, 2013). The next question is how to design an instruction dataset that covers the fundamental features of molecules including structural, chemical, and biological features. To this end, we are inspired by the natural law, where the molecular features have hierarchical relationship. That is, the structures determine the chemical features, while the biological features are determined by both the structural and chemical features. Based on our observation, we devise three data types that address these fundamental features, as shown in Table 1. 1. Detailed Structural Description: We first design detailed descriptions of molecular structures to upskill the foundational understanding of molecules and improve the comprehension of advanced chemical and biological features. To achieve this, we prompt GPT-4o to include explanations of functional groups and their connectivity in detail. For structural descriptions, we use the IUPAC name exclusively, lensing on accurately describing the structural information without emphasizing the molecular functionalities. 2. Structure-to-Feature Relationship Explanation: To enable comprehensive understanding of chemical and biological features, we create structure-to-feature relationship explanations considering the hierarchical relationships. Specifically, we instruct GPT-4o to relate the structural information to its chemical or biological features with detailed explanations. Note that learning these relationships inherently helps an LLM understand the causality between molecular structures and their features, allowing it to provide rationales when responding. 3. Comprehensive Conversation: Even though the two types above facilitate the learning of general knowledge about molecules, it is important to tailor LLMs to handle diverse contexts of requests. Thereby, we design conversations to cultivate the ability to handle various inquiries such as prompting with specific information of molecule or task. Specifically, considering the hierarchical relationships of molecular features, we create comprehensive conversations by instructing to gradually deepen the level of features progressing from structural features to chemical and biological features, aiming to empower the comprehensive understanding and the stepby-step reasoning ability. To ensure the quality of instruction-following samples, we further filter out factually incorrect ones. Inspired by LLMas-a-judge (Zheng et al., 2023), we use GPT-4o to evaluate the factual accuracy of the samples and select those with correct contents. As result, we collect 284k instructionfollowing samples, establishing 77k samples for the detailed structural descriptions, 147k samples for the structure-tofeature relationship explanations, and 60k samples for the comprehensive conversations, from the training set of the PubChem 324k dataset (Li et al., 2024), referring to the constructed instruction dataset as Mol-LLaMA-Instruct. We note that our dataset not only aids in understanding the molecular features but also enhances reasoning abilities by extensively addressing fundamental molecular features and various types of interactions between users and an assistant. For more details on the dataset construction, please refer to Appendix B.1. 3 Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model Context Type 1: IUPAC Name (2R)-2-amino-3-methylsulfanylpropanoic acid Context Type 2: Description S-methylcysteine is cysteine derivative that is L-cysteine in which the hydrogen attached to the sulfur is replaced by methyl group. It has role as human urinary metabolite and plant metabolite. It is tautomer of S-methylcysteine zwitterion. Data Type 1: Detailed Structural Descriptions Instruction to GPT-4o: Explain which substructures and functional groups are contained and how they are connected. The molecule provided is chiral amino acid that contains several identifiable substructures. 1. **Amino Group**: This functional group consists of nitrogen atom bonded to two hydrogen atoms (-NH2). It is attached to the second carbon atom ...<omitted>... 2. **Carboxylic Acid Group**: This group includes carbon atom double-bonded to an oxygen atom and also bonded to an (-OH) group. It is attached to the end of the carbon chain, characteristic of amino acids ...<omitted>... Data Type 2: Struture-to-Feature Relationship Explanations Instruction to GPT-4o: Explain chemical properties by relating chemical properties to its structural information. Firstly, the presence of the amino group (-NH2) classifies this compound as an amino acid, which contributes to its ability to act as zwitterion. This means that it can contain both positive charge and negative charge ...<omitted>... The sulfur atom with methyl attachment forms thioether. This increases the molecules hydrophobic characteristics compared to cysteine, which contains more polar thiol group. ...<omitted>... Data Type 3: Comprehensive Conversations Instruction to GPT-4o: Design sequence of pairs of questions and answers that gradually deepen the level of the conversation, from structural information and chemical properties to biological functionalities. USER: Can you tell me about the basic structure of the given molecule? ASSISTANT: The given molecule is derivative of cysteine, where the hydrogen atom attached to the sulfur group is replaced by methyl group. ...<omitted>... USER: How does the molecules structure influence its chemical behavior? ASSISTANT: The structure of the given molecule, particularly the presence of both amino and carboxylic acid groups, contributes to its zwitterionic nature at physiological pH. ...<omitted>... USER: What role does this molecule play biologically? ASSISTANT: Biologically, S-methylcysteine serves as metabolite in both humans and plants. ...<omitted>... Table 1: One example of the constructed instruction data. We use the IUPAC name and description from PubChem as contexts for prompting GPT-4o as shown in the first block. The following three blocks show the instructions and corresponding responses of GPT-4o for each data type. Entire responses of the given example are provided in Table 12 and 13 of Appendix B.1 3.3. Model Architecture We now introduce the model architecture of Mol-LLaMA. Here, our goal is to accurately capture structural information, to further improve the understanding of molecular features. To this end, we propose to use both 2D and 3D representations without string representations. The model architecture consists of four components: molecular encoders, 2D-3D blending module, projector, and large language models. Molecular Encoders We observe that each molecular encoder has distinct advantages. While the 2D encoder explicitly models the bond information and their connectivity, the 3D encoder, which represents the molecules as point clouds, captures the spatial arrangements of atoms which is crucial to understanding 3D features such as surface area and volumes. To fully leverage the strength of each encoder, we propose to use both the 2D encoder and 3D encoder. For the 2D encoder, we opt MoleculeSTM (Liu et al., 2023a) which learns the molecular semantics from the biomedical texts through the contrastive learning between 2D molecular structure and textual description. For the 3D encoder, we opt UniMol (Zhou et al., 2023) which is trained via masked atom type prediction and position recovery. 2D-3D Blending Module Since each representation is independently modeled, we propose blending module that combines these molecular representations using crossattention scheme. Specifically, given the molecular embeddings from each encoder which are the concatenation of graph and node embeddings, self-attention and crossattention are sequentially applied to blend the complementary information from each encoder. Then, we concatenate the 2D and 3D embeddings before forwarding to the projector, as shown in Fig. 1 (Blending Module). 4 Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model Figure 1: Illustration of the end-to-end instruction tuning stage of Mol-LLaMA. It is trained on the proposed instruction datasets, where the blending module, Q-Former, and LoRA in LLMs are trained, while the molecular encoders and LLM are frozen. Projector We employ Q-Former (Li et al., 2023; 2024) to project the unified molecular representations from the proposed 2D-3D blending module to an LLM. Q-Former is transformer architecture with learnable query tokens, which embeds molecules by performing cross-attention between the unified molecular representations and the learnable query tokens as shown in Fig. 1 (Q-Former). It is worth noting that Q-Former architecture is advantageous especially for modeling graphs, as the cross-attention guarantees the permutation invariance. Following the recent work (Li et al., 2024), we opt to initialize the Q-Former with SciBERT (Beltagy et al., 2019) which is trained on large corpus from scientific domains including the biomedical domain. Large Language Models We choose Llama-27b-chat (Touvron et al., 2023) and Llama-3.1-8BInstruct (Grattafiori et al., 2024), which are well-studied in the multi-modal LLM field and have demonstrated their capabilities in the multi-modal instruction tuning. 3.4. Training Now, we turn out to introduce two training stages: molecular representation learning and end-to-end instruction-tuning. Molecular Representation Learning In the first stage, we train the blending module and the Q-Former while freezing the 2D and 3D encoders. Following recent works (Li et al., 2023; 2024), we adopt the multi-objectives to align the molecular embeddings to the molecule-relevant texts including molecule-text contrastive learning, molecule-text matching, and molecule-grounded text generation. We opt to use the IUPAC name as the molecule-relevant texts instead of using descriptions, to bridge the molecular embeddings to the key information in structures such as the functional groups and their connectivity. Note that the IUPAC name is more compact than the textual descriptions, making the training efficient. Please refer Section B.2 for detailed explanation of molecular representation learning. End-to-end Instruction Tuning As shown in Fig. 1, we jointly train the blending module, Q-Former, and an LLM via the multi-modal instruction tuning (Eq. 1), while freezing the 2D and 3D encoders. We instruction-tune LLMs on the proposed instruction dataset without any additional datasets, employing LoRA (Hu et al., 2021) for the efficiency of training. For the training details of the instruction tuning of Mol-LLaMA, please refer Section B.2. 4. Experimental Results We evaluate the capabilities of Mol-LLaMA by assessing the quality of generated responses to general questions and conducting the molecular property prediction task. To evaluate the qualification as general-purpose assistant for molecular analysis, we assess LLMs in zero-shot settings without task-specific fine-tuning. 4.1. Baselines We compare the following large language models: GPT4o (OpenAI, 2024b) and Llama series (Touvron et al., 2023; Grattafiori et al., 2024) which are text-only general LLMs, Mol-Instructions (Fang et al., 2024) and LlasMol (Yu et al., 2024) which learn the string representations such as SMILES or SELFIES via the public databases including PubChem (Kim et al., 2021), USPTO (Wei et al., 2010; Lu & Zhang, 2022), and MoleculeNet (Wu et al., 2018), 3DMoLM (Li et al., 2024) where the inputs are SMILES and the 3D representation trained on the enriched descriptions, LLaMo (Park et al., 2024) which is trained on the generated conversations and other public datasets such as PubChem, MoleculeNet, and USPTO leveraging SMILES and the 2D molecular representations via the multi-level projector. 4.2. Evaluation of General Understanding of Molecules 4.2.1. QUALITATIVE EVALUATION To show how well Mol-LLaMA understands the molecular structures and their properties, we ask question for molecule whose properties are widely studied as shown in Table 2. Interestingly, Mol-LLaMA accurately predicts the main class of the given molecule, explains the relevant properties, and provides the rationales for the predicted properties by learning the general knowledge from the proposed dataset. In contrast, GPT-4o and 3D-MoLM misinterpret 5 Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model Original Description Bromazepam binds to the GABA receptor GABA-A, causing conformational change and increasing inhibitory effects of GABA. Other neurotransmitters are not influenced. One of the benzodiazepines that is used in the treatment of anxiety disorders. User Explain the features of the given molecule that are most distinct from those of other molecules. Mol-LLaMA (Ours) GPT-4o LLaMo 3D-MoLM The given molecule is member of the benzodiazepine class, which is characterized by fusion of benzene ring and seven-membered diazepine ring. This structure is crucial for its biological activity, particularly its role as sedative and hypnotic agent. ...<omitted>... The given molecule is also characterized by ketone group within the diazepine ring, which is common feature in benzodiazepines. This functional group is important for the interaction with the GABA-A receptor, enhancing the inhibitory effects of GABA. ...<omitted>... 1. **Quinazoline Core**: The molecule contains quinazoline core, ...<omitted>... Overall, the combination of quinazoline structure with unique substitution patterns, including bromine halogenation and the presence of pyridinyl group, ...<omitted>... . The molecule has benzodiazepine structure with bromo substituent at the 7-position and methyl group at the 1-position. It is distinct from other molecules in that it contains bromine atom, nitrogen atom, and methyl group, which are not present in the other molecules. ...<omitted>... It belongs to the class of compounds called quinazolines, which are characterized by bicyclic structure consisting of benzene ring fused to pyrimidine ring. ...<omitted>... The molecules structure suggests potential applications in medicinal chemistry, as quinazolines have been found to possess various biological activities, including antitumor, antimicrobial, and anti-inflammatory properties. Mol-Instructions The molecule is quinoxaline derivative. Table 2: Case study to compare molecular understanding and reasoning ability. Mol-LLaMA accurately understands the molecular features, answering correct molecular taxonomy and providing its distinct properties that are relevant to the given molecule. the key structures failing to provide correct properties, while LLaMo misinterprets the substructure and does not explain the relevant properties. On the other hand, Mol-Instructions inaccurately predicts the main class and does not provide additional explanations of the molecular features. For the entire responses and additional qualitative results, please refer Table 6, 7, 8, and 9 in Appendix A. 4.2.2. QUANTITATIVE EVALUATION Experimental Setting We first select 100 representative molecules from the test set of PubChem dataset following splitting from Li et al. (2024) by conducting the k-means clustering based on Morgan Fingerprints (Morgan, 1965). Then, we instruct LLMs and molecular LLMs to describe general features of molecules such as structural, chemical, or biological features, respectively. Please refer Appendix C.1 for detailed explanations of experimental settings. Evaluation Setting To quantitatively evaluate the general understanding ability, we leverage GPT-4o to measure the quality of generated responses inspired by Liu et al. (2024b). Specifically, after gathering the responses, we instruct GPT4o to assess the quality of generated responses using the string representation and description from PubChem as references for judgment, considering the following four types of criteria: helpfulness, relevance, accuracy, and level of details. Additionally, we ask to assess the overall score and provide an explanation of its judgement to prevent biased evaluation. We report the relative score compared to GPT-4o (i.e. the score of an LLM divided by the score of GPT-4o) for each criterion. We evaluate by querying GPT-4o three times, reporting the average score. For detailed evaluation settings, please refer Appendix C.1. Results As shown in Table 3, relative scores of MolLLaMA are beyond 1 for all criteria, indicating that it is superior to GPT-4o in the understanding of general features of molecules. In contrast, the scores of other baselines are mostly lower than 1, showing an inferior understanding of the general features. On the other hand, Mol-LLaMA shows significant performance improvement compared to the base LLMs and outperforms all baselines on the same architecture, suggesting that it understands the general features and provides helpful and relevant explanations, thanks to the proposed instruction dataset and the blending module. 6 Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model Models Help. Relev. Acc. Details Overall Help. Relev. Acc. Details Overall Help. Relev. Acc. Details Overall STRUCTURAL CHEMICAL BIOLOGICAL Llama2-7B-Based 0.312 0.333 0.207 Llama2-7B-Chat 0.218 0.249 0.210 Mol-Instructions 0.251 0.266 0.221 LlasMol 0.550 0.541 0.426 3D-MoLM LLaMo 0.314 0.396 0.348 Mol-LLaMA (Ours) 1.105 1.121 1.105 Llama3.1-8B-Instruct-Based 0.612 0.636 0.484 Llama3.1-8B 0.257 0.315 0.282 Mol-Instructions 3D-MoLM 0.778 0.800 0.680 LLaMo 0.445 0.565 0.465 Mol-LLaMA (Ours) 1.126 1.145 1.154 0.284 0.144 0.192 0.542 0.206 1. 0.567 0.166 0.759 0.312 1.090 0.279 0.207 0.228 0.507 0.310 1.098 0.569 0.253 0.749 0.442 1.125 0.447 0.437 0.304 0.250 0.280 0.254 0.273 0.301 0.235 0.669 0.666 0.557 0.359 0.459 0.447 1.202 1.242 1.288 0.654 0.658 0.523 0.274 0.359 0.322 0.882 0.936 0.838 0.410 0.542 0.489 1.224 1.266 1.302 0.415 0.168 0.213 0.661 0.240 1. 0.606 0.179 0.854 0.295 1.211 0.394 0.235 0.252 0.628 0.361 1.232 0.610 0.276 0.875 0.425 1.251 0.436 0.422 0.335 0.351 0.448 0.425 0.346 0.410 0.390 0.836 0.894 0.855 0.498 0.734 0.803 1.495 1.706 1.875 0.664 0.665 0.589 0.392 0.547 0.555 1.105 1.272 1.292 0.650 0.905 0.898 1.578 1.840 2.030 0.449 0.253 0.298 0.892 0.340 1. 0.644 0.259 1.145 0.441 1.528 0.405 0.360 0.353 0.862 0.568 1.631 0.641 0.423 1.191 0.705 1.744 Table 3: Quantitative evaluation on the quality of generated responses for five criteria including helpfulness, relevance, accuracy, level of detail and overall score. We report the average of relative score (i.e. score of an LLM divided by score of GPT-4o) by running GPT-4o evaluation three times. Molecular LLMs that are trained on Llama3.1-8B-Instruct strictly following their official implementations. 4.3. Molecular Property Prediction Experimental Setting To assess the effectiveness of learning the general knowledge, we conduct zero-shot evaluation on the parallel artificial membrane permeability assay (PAMPA) task from Therapeutics Data Commons (TDC) dataset (Velez-Arce et al., 2024), where the task is to classify whether the given molecule has high permeability or low-to-moderate permeability to the artificial membrane. The reason why we adopt PAMPA task is that it requires capturing fundamental properties of molecules such as lipophilicity, molecular size, polarity, and membrane affinity, spanning from the chemical properties to the biological properties. To evaluate the ability to handle diverse requests, we use three prompting methods: the default setting (Default), the chain-of-thought prompting (Wei et al., 2022) (CoT), and prompting with task-specific information (w/ Task Info). For the default setting, we do not use additional prompting methods, for CoT prompting, we instruct to provide rationales while answering, and, for prompting with task-specific information, we provide property types that are relevant to predict the task, to demonstrate the ability to understand and leverage the additional information. Detailed evaluation settings are provided in Appendix C.2. Evaluation Setting We consider three metrics: accuracy, fidelity, and helpfulness. Accuracy measures the ratio of correct answers, evaluating how an LLM accurately understands the molecules and their properties. Fidelity and helpfulness measure the quality of responses regardless of whether the final prediction is correct or not, to assess the qualifications as practical assistant. Specifically, the fidelity score evaluates soundness and relevance, while the helpfulness score evaluates whether the responses are clear, informative, and helpful. We leverage GPT-4o to evaluate the fidelity and helpfulness and report the relative score compared to GPT-4o (i.e. the score of an LLM divided by the score of GPT-4o) for each criterion. Additionally, we report the ratio of the predicted labels to check whether an LLM is biased to predict the labels. Please refer Appendix C.2 for detailed prompts. Result Table 4 shows that Mol-LLaMA achieves high accuracy outperforming GPT-4o, while showing high fidelity and helpfulness scores, demonstrating that it is able to accurately predict the molecular property with helpful explanations. Further, compared to the base LLMs, Mol-LLaMA shows performance gain for both the accuracy and the quality of the responses by learning the general knowledge and reasoning ability from our constructed dataset. In contrast, other baselines lose the ability to provide relevant and helpful explanations, showing low fidelity and helpfulness scores compared to the base LLMs. Notably, Mol-LLaMA trained on Llama3.1 shows consistent performance improvement when using CoT prompting and providing taskspecific information, showing its ability to handle diverse requests from users. On the other hand, LLaMo (Llama2) usually predicts labels biasedly, while LLaMo (Llama3.1) shows inferior performances compared to the base LLM. We note that the models whose relative scores of fidelity and helpfulness are below 0.3 tend to directly predict the labels without any explanation as shown in the detailed analysis of Table 23, 24, 25 and 26 in Appendix D.1. We provide additional experimental results on another task (i.e. BBBP) in Table 22 of Section D.3. 4.4. Ablabtion Study Blending Module To show the effectiveness of the proposed blending module, we ablate the different types of molecular representations. As shown in Table 5 (Left), leveraging each type of encoder (2D and 3D) shows superior Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model Default CoT w/ Task Info. Models GPT-4o Acc. (Ratio) Fidel. Help. Acc. (Ratio) Fidel. Help. Acc. (Ratio) Fidel. Help. 48.65 (59.95) - - 58.23 (47.42) - - 47.17 (62.41) - - Llama2-7B-Based Llama2 Mol-Instructions LLaMo Mol-LLaMA (Ours) 57.14 (36.12) 49.63 (47.67) 84.28 (0.74) 75.68 (11.30) Llama3.1-8B-Instruct-Based Llama3 Mol-Instructions 3D-MoLM LLaMo Mol-LLaMA (Ours) 56.51 (45.70) 55.91 (38.33) 46.93 (58.72) 49.25 (51.74) 63.55 (36.86) 0.517 0.277 0.242 0.781 0.629 0.245 0.668 0.265 0.804 0.508 0.210 0.187 0.820 0.554 0.207 0.651 0.212 0.829 57.53 (39.56) 31.16 (70.02) 84.52 (0.00) 79.61 (6.88) 46.19 (58.48) 33.50 (73.96) 50.00 (51.35) 64.37 (28.50) 64.37 (31.94) 0.639 0.314 0.246 0.759 0.795 0.299 0.671 0.254 0.819 0.658 0.270 0.191 0.793 0.786 0.247 0.649 0.209 0.848 84.52 (0.00) 38.18 (68.80) N/A 67.90 (28.75) 63.64 (34.15) 70.47 (25.55) 64.86 (35.87) 48.51 (53.73) 72.48 (17.44) 0.658 0.331 0.226 0.757 0.850 0.245 0.767 0.401 0.927 0.718 0.256 0.185 0.744 0.875 0.206 0.744 0.327 0.966 Table 4: Zero-shot performances on PAMPA task. We report accuracy with the ratio of predicted labels, and relative scores of fidelity and helpfulness (i.e. score of an LLM divided by score of GPT-4o). We highlight the best results in bold, except for the cases where all predicted labels are identical which are denoted as . N/A denotes the cases in which more than 20% of the responses do not follow the answer format. Molecular LLMs that are trained on Llama3.1-8B-Instruct strictly following their official implementations. STRUCTURAL CHEMICAL BIOLOGICAL STRUCTURAL CHEMICAL BIOLOGICAL PAMPA Models Overall Overall Overall Models Overall Overall Overall Default CoT w/ Task Info. 2D 3D 2D+3D (Concat) 2D+3D (Blended) 0.907 1.071 1.037 1.125 1.137 1.195 1.210 1.251 1.526 1.632 1.741 1.744 S+S2F Conv. Full 1.119 1.172 1.166 1. 1.166 1.285 0.689 1.251 1.328 1.754 0.887 1.744 37.35 66.83 41.03 63.55 32.92 64.13 45.95 64.37 56.02 57.88 83.05 72.48 Table 5: Ablation studies on (Left) molecular representations and (Right) data types. denotes the detailed structural descriptions, S2F denotes the structure-to-feature relationship explanations, and Conv. denotes the comprehensive conversations. We report overall scores following the settings in Section 4.2.2. For the ablation study on data types, we report the accuracy on PAMPA task. understanding of molecular modality compared to GPT-4o by learning comprehensive knowledge of molecules from the proposed instruction dataset. On the other hand, concatenating 2D and 3D representations without the blending module (2D+3D (Concat)) attains performance improvement for chemical and biological features, whereas being degenerated for the structural understanding. Using the proposed blending module (2D+3D (Blended)) outperforms other variants, indicating that integrating the complementary information from different molecular representations via the proposed blending module is crucial to enhancing the structural understanding and learning the chemical and biological features. For the entire scores, please refer Table 20 of Appendix D.2. Data Type We ablate the different data types in MolLLaMA-Instruct to show the effect of each data type. As shown in Table 5 (Right), learning structural descriptions exclusively or with structure-to-feature relationship explanations helps understand the general features. On the other hand, even though learning comprehensive conversations shows an inferior understanding of chemical and biological features, it allows to handle the diverse contexts of users requests showing large performance gain when predicting molecular property with task-specific information. Training on the full data balances this trade-off, showing moderate performances both on the understanding of general features and the ability to handle the users inquiries. Please refer Table 21 of Appendix D.2 for the entire scores including helpfulness, relevance, accuracy, and level of detail. 5. Conclusion In this work, we propose Mol-LLaMA, large molecular language model with general understanding of molecular features across structural, chemical, and biological features. To this end, we present large instruction dataset by conceptualizing the core data types for molecular understanding including detailed structural descriptions, structure-to-feature relationship explanations, and comprehensive conversations, to cover the fundamental features from structural features to chemical and biological features. Further, we propose the blending module to fully capture the structural information from different encoder types to enhance the understanding of structures and advanced properties. Experimentally, we show that Mol-LLaMA is capable of predicting molecular features accurately and providing informative and helpful responses, implying its utility as general-purpose assistant for molecular analysis. We hope that our work can be utilized to solve scientific problems based on its capability. Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model"
        },
        {
            "title": "References",
            "content": "AI4Science, M. R. and Quantum, M. A. The impact of large language models on scientific discovery: preliminary study using gpt-4. arXiv:2311.07361, 2023. Beltagy, I., Lo, K., and Cohan, A. Scibert: pretrained language model for scientific text. arXiv preprint arXiv:1903.10676, 2019. Cao, H., Liu, Z., Lu, X., Yao, Y., and Li, Y. Instructmol: Multi-modal integration for building versatile and reliable molecular assistant in drug discovery. arXiv:2311.16208, 2023. Chen, G., Zheng, Y.-D., Wang, J., Xu, J., Huang, Y., Pan, J., Wang, Y., Wang, Y., Qiao, Y., Lu, T., et al. Videollm: Modeling video sequence with large language models. arXiv:2305.13292, 2023. Chithrananda, S., Grand, G., and Ramsundar, B. Chemberta: large-scale self-supervised pretraining for molecular property prediction. arXiv:2010.09885, 2020. Christofidellis, D., Giannone, G., Born, J., Winther, O., Laino, T., and Manica, M. Unifying molecular and textual representations via multi-task language modelling. In International Conference on Machine Learning, 2023. Dalllgna, O. P., Porciuncula, L. O., Souza, D. O., Cunha, R. A., and Lara, D. R. Neuroprotection by caffeine and adenosine a2a receptor blockade of β-amyloid neurotoxicity. British journal of pharmacology, 138(7):12071209, 2003. Edwards, C., Lai, T., Ros, K., Honke, G., Cho, K., and Ji, H. Translation between molecules and natural language. In Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing, 2022. Fabian, B., Edlich, T., Gaspar, H., Segler, M., Meyers, J., Fiscato, M., and Ahmed, M. Molecular representation learning with language models and domain-relevant auxiliary tasks. arXiv:2011.13230, 2020. Fang, Y., Liang, X., Zhang, N., Liu, K., Huang, R., Chen, Z., Fan, X., and Chen, H. Mol-instructions: largescale biomolecular instruction dataset for large language models. In International Conference on Learning Representations, 2024. Fathullah, Y., Wu, C., Lakomkin, E., Li, K., Jia, J., Shangguan, Y., Mahadeokar, J., Kalinli, O., Fuegen, C., and Seltzer, M. Audiochatllama: Towards general-purpose speech abilities for llms. In Association for Computational Linguistics: Human Language Technologies (Volume 1: Long Papers), 2024. Favre, H. A. and Powell, W. H. Nomenclature of organic chemistry: IUPAC recommendations and preferred names 2013. Royal Society of Chemistry, 2013. Grattafiori, A. et al. The llama 3 herd of models. arXiv:2407.21783, 2024. Gu, Y., Tinn, R., Cheng, H., Lucas, M., Usuyama, N., Liu, X., Naumann, T., Gao, J., and Poon, H. Domain-specific language model pretraining for biomedical natural language processing. ACM Transactions on Computing for Healthcare (HEALTH), 3(1):123, 2021. Heseltine, L., Webster, J. M., and Taylor, R. Adenosine effects upon insulin action on lipolysis and glucose transport in human adipocytes. Molecular and cellular biochemistry, 144:147151, 1995. Hu, E. J., Shen, Y., Wallis, P., Allen-Zhu, Z., Li, Y., Wang, S., Wang, L., and Chen, W. Lora: Low-rank adaptation Internation Conference on of large language models. Learning Representations, 2021. Irwin, R., Dimitriadis, S., He, J., and Bjerrum, E. J. Chemformer: pre-trained transformer for computational chemistry. Machine Learning: Science and Technology, 3(1):015022, 2022. Kim, S., Chen, J., Cheng, T., Gindulyte, A., He, J., He, S., Li, Q., Shoemaker, B. A., Thiessen, P. A., Yu, B., et al. Pubchem in 2021: new data content and improved web interfaces. Nucleic acids research, 49(D1):D1388 D1395, 2021. Krenn, M., Hase, F., Nigam, A., Friederich, P., and AspuruGuzik, A. Self-referencing embedded strings (selfies): 100% robust molecular string representation. Machine Learning: Science and Technology, 1(4):045024, 2020. Lee, J., Yoon, W., Kim, S., Kim, D., Kim, S., So, C. H., and Kang, J. Biobert: pre-trained biomedical language representation model for biomedical text mining. Bioinformatics, 36(4):12341240, 2020. Li, J., Li, D., Savarese, S., and Hoi, S. Blip-2: Bootstrapping language-image pre-training with frozen image encoders and large language models. In International Conference on Machine Learning, 2023. Li, S., Liu, Z., Luo, Y., Wang, X., He, X., Kawaguchi, K., Chua, T.-S., and Tian, Q. 3d-molm: Towards 3d moleculetext interpretation in language models. In International Conference on Learning Representations, 2024. Liu, H., Li, C., Li, Y., and Lee, Y. J. Improved baselines with visual instruction tuning. In Conference on Computer Vision and Pattern Recognition, 2024a. 9 Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model Liu, H., Li, C., Wu, Q., and Lee, Y. J. Visual instruction tuning. Advances in Neural Information Processing Systems, 2024b. Park, J., Bae, M., Ko, D., and Kim, H. J. Llamo: Large language model-based molecular graph assistant. In Advances in Neural Information Processing Systems, 2024. Liu, P., Ren, Y., Tao, J., and Ren, Z. Git-mol: multi-modal large language model for molecular science with graph, image, and text. Computers in biology and medicine, 171: 108073, 2024c. Liu, S., Nie, W., Wang, C., Lu, J., Qiao, Z., Liu, L., Tang, J., Xiao, C., and Anandkumar, A. Multi-modal molecule structuretext model for text-based retrieval and editing. Nature Machine Intelligence, 5(12):14471457, 2023a. Liu, Z., Li, S., Luo, Y., Fei, H., Cao, Y., Kawaguchi, K., Wang, X., and Chua, T.-S. MolCA: Molecular graphlanguage modeling with cross-modal projector and unimodal adapter. In Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing, 2023b. Loshchilov, I. Decoupled weight decay regularization. International Conference on Learning Representations, 2019. Lu, J. and Zhang, Y. Unified deep learning model for multitask reaction predictions with explanation. Journal of chemical information and modeling, 62(6):13761387, 2022. Lu, S., Gao, Z., He, D., Zhang, L., and Ke, G. Data-driven quantum chemical property prediction leveraging 3d conformations with uni-mol+. Nature Communications, 15 (1):7104, 2024. Luo, Y., Yang, K., Hong, M., Liu, X. Y., and Nie, Z. Molfm: multimodal molecular foundation model. arXiv preprint arXiv:2307.09484, 2023. Maaz, M., Rasheed, H., Khan, S., and Khan, F. VideoChatGPT: Towards detailed video understanding via large vision and language models. In Proceedings of the 62nd Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), 2024. Mendez-Lucio, O., Nicolaou, C. A., and Earnshaw, B. Mole: foundation model for molecular graphs using disentangled attention. Nature Communications, 15(1):9431, 2024. Morgan, H. L. The generation of unique machine description for chemical structures-a technique developed at chemical abstracts service. Journal of chemical documentation, 5(2):107113, 1965. OpenAI. Gpt-4 technical report. arXiv:2303.08774, 2024a. OpenAI. Gpt-4o system card. arXiv:2410.21276, 2024b. Sadeghi, S., Bui, A., Forooghi, A., Lu, J., and Ngom, A. Can large language models understand molecules? BMC bioinformatics, 25(1):225, 2024. Serhan, G., Stack, C. M., Perrone, G. G., and Morton, C. O. The polyene antifungals, amphotericin and nystatin, cause cell death in saccharomyces cerevisiae by distinct mechanism to amphibian-derived antimicrobial peptides. Annals of clinical microbiology and antimicrobials, 13: 14, 2014. Su, B., Du, D., Yang, Z., Zhou, Y., Li, J., Rao, A., Sun, H., Lu, Z., and Wen, J.-R. molecular multimodal foundation model associating molecule graphs with natural language. arXiv:2209.05481, 2022. Touvron, H. et al. Llama 2: Open foundation and fine-tuned chat models. arXiv:2307.09288, 2023. Velez-Arce, A., Lin, X., Li, M., Huang, K., Gao, W., Fu, T., Pentelute, B. L., Kellis, M., and Zitnik, M. Signals in the cells: Multimodal and contextualized machine learning foundations for therapeutics. Advances in Neural Information Processing Systems Workshop on AI for New Drug Modalities, 2024. Wang, L., Zhang, J., Zhang, W., Zheng, M., Guo, H., Pan, X., Li, W., Yang, B., and Ding, L. The inhibitory effect of adenosine on tumor adaptive immunity and intervention strategies. Acta Pharmaceutica Sinica B, 14(5):1951 1964, 2024. Wang, S., Guo, Y., Wang, Y., Sun, H., and Huang, J. Smilesbert: large scale unsupervised pre-training for molecular property prediction. In Proceedings of the 10th ACM international conference on bioinformatics, computational biology and health informatics, pp. 429436, 2019. Wei, J., Wang, X., Schuurmans, D., Bosma, M., Xia, F., Chi, E., Le, Q. V., Zhou, D., et al. Chain-of-thought prompting elicits reasoning in large language models. Advances in Neural Information Processing Systems, 2022. Wei, J.-M., Yuan, X.-J., Hu, Q.-H., and Wang, S.-Q. novel measure for evaluating classifiers. Expert Systems with Applications, 37(5):37993809, 2010. Weininger, D. Smiles, chemical language and information system. 1. introduction to methodology and encoding rules. Journal of chemical information and computer sciences, 28(1):3136, 1988. Wu, D., Chen, Q., Chen, X., Han, F., Chen, Z., and Wang, Y. The bloodbrain barrier: structure, regulation, and drug 10 Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model delivery. Signal Transduction and Targeted Therapy, 8 (1):217, 2023. Wu, Z., Ramsundar, B., Feinberg, E. N., Gomes, J., Geniesse, C., Pappu, A. S., Leswing, K., and Pande, V. Moleculenet: benchmark for molecular machine learning. Chemical science, 9(2):513530, 2018. Xu, G., Jin, P., Li, H., Song, Y., Sun, L., and Yuan, L. Llava-cot: Let vision language models reason step-bystep. arXiv:2411.10440, 2024. Ying, C., Cai, T., Luo, S., Zheng, S., Ke, G., He, D., Shen, Y., and Liu, T.-Y. Do transformers really perform badly for graph representation? In Advances in Neural Information Processing Systems, 2021. Yu, B., Baker, F. N., Chen, Z., Ning, X., and Sun, H. Llasmol: Advancing large language models for chemistry with large-scale, comprehensive, high-quality instruction tuning dataset. arXiv:2402.09391, 2024. Zeng, Z., Yao, Y., Liu, Z., and Sun, M. deep-learning system bridging molecule structure and biomedical text with comprehension comparable to human professionals. Nature communications, 13(1):862, 2022. Zhang, H., Li, X., and Bing, L. Video-LLaMA: An instruction-tuned audio-visual language model for video understanding. In Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing: System Demonstrations, 2023. Zhang, J., Bian, Y., Chen, Y., and Yao, Q. Unimot: Unified molecule-text language model with discrete token representation. arXiv:2408.00863, 2024. Zheng, L., Chiang, W.-L., Sheng, Y., Zhuang, S., Wu, Z., Zhuang, Y., Lin, Z., Li, Z., Li, D., Xing, E., et al. Judging llm-as-a-judge with mt-bench and chatbot arena. Advances in Neural Information Processing Systems, 36: 4659546623, 2023. Zhou, G., Gao, Z., Ding, Q., Zheng, H., Xu, H., Wei, Z., Zhang, L., and Ke, G. Uni-mol: universal 3d molecular representation learning framework. In International Conference on Learning Representations, 2023. 11 Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model"
        },
        {
            "title": "Appendix",
            "content": "Organization Appendix is organized as follows: In Section A, we provide additional qualitative results including the entire responses in Table 2 and other case studies. In Section B, we explain details of the instruction dataset construction and the training. In Section C, we provide experimental details for the evaluation settings. Finally, in Section D, we provide additional experimental results for the PAMPA prediction, ablation study, and BBBP prediction. A. Additional Qualitative Results In this section, we provide additional qualitative results to analyze the behaviors of Mol-LLaMA. First, we provide the entire responses of the case study in Table 2. As shown in Table 6, Mol-LLaMA understands the molecular structures and correctly predicts the main class of the given molecule (i.e. Benzodiazepine), the attached functional group (i.e. pyridine), and its biological functionalities. Interestingly, Mol-LLaMA provides additional information, detailing the effects of each structural component such as the blood-brain barrier penetration from the pyridine ring, the binding affinity to the GABA-A receptor from the halogen atom, and the inhibitory effects of benzodiazepines. In contrast, as shown in Table 7, GPT-4o, 3D-MoLM, and Mol-Instructions misinterpret the molecular structures and give the incorrect features of molecules. On the other hand, LLaMo misinterprets the substructures (i.e. methyl group) and does not provide the molecular features, focusing on describing the structural information. Additionally, as shown in Table 8, one notable ability of Mol-LLaMA is that, beyond the properties annotated in PubChem, Mol-LLaMA understands various aspects of the molecular properties that can be found in the scientific literature, such as regulating the secretion of insulin (Heseltine et al., 1995), inhibiting the immune cells (Wang et al., 2024), and protecting neurons (Dalllgna et al., 2003). Further, as shown in Table 9, Mol-LLaMA provides detailed rationales for the predicted properties. Specifically, Mol-LLaMA explains the key structure (i.e. macrolides) and additional structural features (i.e. polyene chain), and then explains that these structural features are related to the specific biological properties (i.e. antifungal activity), providing principles of the predicted properties (i.e. binding to ergosterol) (Serhan et al., 2014). We hope that these additional qualitative results show the potential of Mol-LLaMA as general-purpose assistant for molecular analysis. SMILES C1C(=O)NC2=C(C=C(C=C2)Br)C(=N1)C3=CC=CC=N3 Original Description Bromazepam binds to the GABA receptor GABA-A, causing conformational change and increasing inhibitory effects of GABA. Other neurotransmitters are not influenced. One of the benzodiazepines that is used in the treatment of anxiety disorders. User Explain the features of the given molecule that are most distinct from those of other molecules. Mol-LLaMA (Ours) The given molecule is member of the benzodiazepine class, which is characterized by fusion of benzene ring and seven-membered diazepine ring. This structure is crucial for its biological activity, particularly its role as sedative and hypnotic agent. One of the key features of the given molecule is the presence of pyridine ring attached to the benzodiazepine core. This pyridine moiety is significant because it can influence the molecules pharmacokinetic properties, such as its ability to cross the blood-brain barrier, which is essential for its function as central nervous system depressant. Additionally, the molecule contains bromine atom attached to the benzodiazepine ring. The presence of this halogen atom can affect the molecules lipophilicity and its binding affinity to the GABA-A receptor, which is the primary target of benzodiazepines. The bromine atom may also contribute to the molecules metabolic stability and its duration of action. The given molecule is also characterized by ketone group within the diazepine ring, which is common feature in benzodiazepines. This functional group is important for the interaction with the GABA-A receptor, as it plays role in the formation of the benzodiazepine-receptor complex, enhancing the inhibitory effects of GABA. Overall, the structural features of the given molecule, including the benzodiazepine core, the pyridine ring, the bromine atom, and the ketone group, collectively contribute to its pharmacological properties as sedative and hypnotic agent. Table 6: Entire responses of Mol-LLaMA for the case study in Table 2. 12 Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model SMILES C1C(=O)NC2=C(C=C(C=C2)Br)C(=N1)C3=CC=CC=N3 Original Description User GPT-4o LLaMo 3D-MoLM Bromazepam binds to the GABA receptor GABA-A, causing conformational change and increasing inhibitory effects of GABA. Other neurotransmitters are not influenced. One of the benzodiazepines that is used in the treatment of anxiety disorders. Explain the features of the given molecule that are most distinct from those of other molecules. The given molecule is 6-bromo-3-(pyridin-2-yl)-1H-quinazoline-2,4-dione. Several distinctive features set this molecule apart: 1. **Quinazoline Core**: The molecule contains quinazoline core, which is bicyclic structure combining benzene ring and pyrimidine ring. This is distinct from simpler aromatic compounds due to the additional nitrogen atoms in the pyrimidine portion. 2. **Substitution Pattern**: The molecule has unique substitution on the quinazoline core: - bromine atom is substituted at the 6-position of the quinazoline ring. This halogenation is distinctive and can affect the molecules reactivity and binding properties significantly, compared to non-halogenated quinazolines. - pyridin-2-yl group is attached at the 3-position. This makes the compound heteroarylated quinazoline, which can modulate the electronic properties and polarity of the molecule. 3. **Presence of Two Carbonyl Groups**: The molecule has two carbonyl groups at the 2-position and 4-position of the quinazoline ring. These functional groups contribute to potential hydrogen bonding and polarity, influencing the molecules chemical reactivity and interaction with biological targets. 4. **Heteroaromatic Ring Systems**: Besides the quinazoline core, the presence of pyridine ring at the 3position adds second heteroaromatic system, increasing the overall aromatic character and introducing additional nitrogen atoms, which can serve as potential sites for interaction or coordination with metal ions. Overall, the combination of quinazoline structure with unique substitution patterns, including bromine halogenation and the presence of pyridinyl group, defines the molecules distinct chemical characteristics. This structure is particularly relevant in medicinal chemistry, where such frameworks are often explored for developing bioactive compounds. The molecule has benzodiazepine structure with bromo substituent at the 7-position and methyl group at the 1-position. It is distinct from other molecules in that it contains bromine atom, nitrogen atom, and methyl group, which are not present in the other molecules. The molecule with the SMILES code C1C(=O)NC2=C(C=C(C=C2)Br)C(=N1)C3=CC=CC=N3 is known as 7-bromohypnotic. It belongs to the class of compounds called quinazolines, which are characterized by bicyclic structure consisting of benzene ring fused to pyrimidine ring. The molecule contains carbonyl group (C=O) and an amide group (C(=O)N) attached to the pyrimidine ring. These functional groups contribute to the molecules ability to form hydrogen bonds and participate in various chemical reactions. The presence of bromine atom (Br) on the benzene ring imparts unique properties to 7-bromohypnotic. Bromine is halogen that is more electronegative than carbon, resulting in polar bond. This polarity can influence the molecules reactivity and solubility in different solvents. Additionally, the molecule contains nitrogen atom (N) in the pyrimidine ring, which can act as basic center and participate in acid-base reactions. The presence of conjugated double bonds in the benzene and pyrimidine rings gives rise to delocalized pi-electron systems, leading to enhanced stability and potential for aromaticity. Overall, 7-bromohypnotic exhibits distinct features such as the presence of bromine atom, carbonyl and amide groups, and conjugated double bonds, which contribute to its unique chemical and physical properties. The molecules structure suggests potential applications in medicinal chemistry, as quinazolines have been found to possess various biological activities, including antitumor, antimicrobial, and anti-inflammatory properties. Additionally, the presence of bromine atom can enhance the molecules lipophilicity, potentially affecting its bioavailability and distribution in the body. Further studies and experiments are necessary to fully understand the specific biological activities and potential therapeutic uses of 7-bromohypnotic. However, its unique molecular features make it an intriguing compound for further investigation in the field of chemistry and biology. Mol-Instructions The molecule is quinoxaline derivative. Table 7: Entire responses of GPT-4o, LLaMo, 3D-MoLM, and Mol-Instructions for the case study in Table 2. Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model Original Description from PubChem Adenosine is nucleoside that is composed of adenine and d-ribose. Adenosine or adenosine derivatives play many important biological roles in addition to being components of DNA and RNA. For instance, adenosine plays an important role in energy transfer - as adenosine triphosphate (ATP) and adenosine diphosphate (ADP). It also plays role in signal transduction as cyclic adenosine monophosphate, cAMP. Adenosine itself is both neurotransmitter and potent vasodilator. When administered intravenously, adenosine causes transient heart block in the AV node. Because of the effects of adenosine on AV node-dependent supraventricular tachycardia, adenosine is considered class antiarrhythmic agent. User What are the biological functionalities of this molecule? Mol-LLaMA The given molecule, commonly known as adenosine, is purine ribonucleoside composed of two main components: an adenine base and ribose sugar. This structure allows it to play several critical biological roles: 1. **Energy Transfer and Storage**: Adenosine is precursor to adenosine triphosphate (ATP), which is the primary energy currency of the cell. It is involved in the storage and transfer of energy in cellular processes. 2. **Signal Transduction**: As signaling molecule, adenosine acts as neuromodulator in the central and peripheral nervous systems. It binds to specific receptors, such as A1, A2A, A2B, and A3, influencing various physiological processes, including vasodilation, anti-inflammatory responses, and modulation of neurotransmitter release. 3. **Metabolic Regulation**: Adenosine is involved in the regulation of glucose and lipid metabolism. It affects insulin secretion and sensitivity, which is crucial for maintaining glucose homeostasis. 4. **Cardiovascular Function**: In the cardiovascular system, adenosine plays role in regulating heart rate and blood pressure. It acts as vasodilator, which helps in reducing blood pressure and improving blood flow. 5. **Immune System Modulation**: Adenosine can modulate immune responses by inhibiting the activity of immune cells, such as lymphocytes and macrophages. This helps in preventing excessive inflammation. 6. **Neuroprotection**: Adenosine has neuroprotective properties, which may help in protecting neurons from damage and degeneration. It is involved in the regulation of synaptic plasticity and neuronal survival. 7. **Role in DNA and RNA**: As nucleoside, adenosine is building block of nucleic acids, such as DNA and RNA. It is essential for the synthesis and repair of genetic material. 8. **Cellular Communication**: Adenosine is involved in cellular communication processes, such as the regulation of cell growth, differentiation, and apoptosis. Overall, the given molecule is multifunctional compound that plays vital role in various physiological and biochemical processes in the body. Table 8: Case study for adenosine. Mol-LLaMA understands the name of molecules and their corresponding properties, providing an in-depth explanation. We highlight the properties that are not described in PubChem in blue. Original Description from PubChem Nystatin is polyene antifungal drug that has broad-spectrum fungicidal and fungistatic activity against number of yeasts and fungi, most notably Candida species. It is one of the most effective antifungal agents synthesized by bacteria, in this case strain of Streptomyces noursei, and is closely related to [amphotericin B], differing only slightly in structure. Nystatin has greater antifungal activity than amphotericin - parenterally administered nystatin, however, is associated with significant toxicity and is not available in formulation appropriate for systemic use. As it undergoes very little absorption following oral or topical administration, nystatins efficacy is limited to the treatment/prevention of cutaneous, mucocutaneous, and gastrointestinal fungal infections. Nystatin is polyene macrolide antibiotic, with antifungal activity. Upon administration, nystatin binds to sterols in the fungal plasma membrane, thereby increasing membrane permeability. This leads to leakage of important intracellular components, cell rupture, and eventually fungal cell death. User Could you explain the biological implication of this molecule? Mol-LLaMA The given molecule is complex natural product known for its potent antifungal properties. It is produced by the fungus *Streptomyces nodosus* and is classified as polyene macrolide. The biological implications of this molecule are primarily related to its ability to disrupt the cell membranes of fungi, making it an effective antifungal agent. The structure of the given molecule includes large lactone ring, which is characteristic of macrolides. This ring is conjugated with multiple conjugated double bonds, forming polyene chain. The polyene chain is crucial for its antifungal activity, as it allows the molecule to bind to ergosterol, key component of fungal cell membranes. This binding results in the formation of pores in the membrane, leading to the leakage of essential ions and molecules, ultimately causing cell death. Additionally, the presence of multiple hydroxyl groups and an amino sugar moiety in the structure enhances the molecules solubility and binding affinity to the fungal cell membrane. The carboxylic acid group contributes to the molecules overall polarity and may play role in its interaction with the fungal cell surface. Overall, the given molecules structure is intricately linked to its biological function as an antifungal agent, making it valuable compound in the treatment of fungal infections. Table 9: Case study for Nystatin. Mol-LLaMA correctly understands the molecular features and explains them in detail. We highlight the rationales that Mol-LLaMA provides in blue. 14 Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model B. Details of Mol-LLaMA B.1. Instruction Dataset Construction Details of GPT-assisted Data Generation First, we randomly select 100k molecules from the train set of PubChem following the splitting from Li et al. (2024) for each data type including detailed structural descriptions, structure-tochemical features, structure-to-biological features, and comprehensive conversations. Then, we employ GPT-4o-2024-08-06 to construct the instruction datasets with different prompts as shown in Table 10. For the data filtering, the prompts are provided in Table 11, where we select samples whose scores are 4. The entire responses for the example in Table 1 are provided in Table 12 and 13. Instructions We provide the instructions for the detailed structural description, the structure-to-chemical feature relationship explanations, the structure-to-biological feature relationship explanations, and the comprehensive conversations in Table 14, 15, 16, and 17, respectively. Instructions for each data type have similar semantics. For the comprehensive conversations, the user prompts are the generated questions. B.2. Training Details Blending Module The number of heads of the blending module is 8, and the number of blocks is 4, where each block consists of sequence of one self-attention block and one cross-attention block. Molecular Representation Learning In the molecular representation learning stage, Q-Former is constituted of two transformers: molecular transformer and text transformer as shown in Fig. 2. The molecular transformer embeds the molecular information by the cross-attention between learnable query tokens and the molecular embeddings with an additional cross-attention block. The text transformer models the molecule-relevant texts while maintaining the original transformer architecture. To train Q-Former, we adopt three training objectives proposed in Li et al. (2024): molecule-text matching, molecule-text contrastive learning, and molecule-grounded text generation. Specifically, we choose IUPAC name as the molecule-relevant text to compactly learn the molecular structures. Therefore, we refer them to the structure-IUPAC matching, structureIUPAC contrastive learning, and structure-grounded IUPAC generation. The structure-IUAPC contrastive learning and structure-IUPAC matching aim to learn the similarity via the cosine similarity or the binary classification, respectively. The structure-grounded IUPAC generation aims to learn the text generation via the next token prediction. For each training objective, the self-attention masking strategies are different. For the structure-IUPAC contrastive learning, self-attention is performed on each modality. For structure-IUPAC matching, the self-attention is performed for all tokens without masking. For the structure-grounded IUPAC generation, the causal mask is applied. The blending module and the Q-Former are trained for 50 epochs. The optimizer is AdamW optimizer (Loshchilov, 2019) with weight decay of 0.05 and cosine scheduler with 1000 steps of linear warmup where the peak and minimal learning rates are 1e-4 and 5e-6. The number of query tokens is 8 and the batch size is 256. Figure 2: Detail illustration of blending module and Q-Former and their training. End-to-end Instruction Tuning We leverage LoRA (Hu et al., 2021) where the rank (r) is 8, α is 32, and the dropout ratio is 0.1. We use the same optimizer configuration in the molecular representation learning stage, while training for 10 epochs with 128 batch sizes. Resources We train Mol-LLaMA on NVIDIA H100 and NVIDIA A100 80GB. 15 Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model Prompt for Detailed Structural Description Prompt for Structure-to-Feature Relationship Explanation System You are chemical assistant and you are given molecule with the IUPAC name. Provide detailed explanation of the given molecule at the molecular structural level. Explain which substructures and functional groups are contained and how they are connected. User Input molecule (IUPAC name): {IUPAC name} System You are {level} assistant that can analyze the {level} properties of single molecule. molecule is given as the IUPAC name, accompanied by description. Based on the provided IUPAC name and the description, explain **the {level} properties** in detailed manner by relating the {level} properties to its structural information. User Input molecule (IUPAC name): {IUPAC name} Description: {Description} Prompt for Comprehensive Conversation System You are an AI chemical assistant with extensive knowledge of molecular properties. You are given molecule with the IUPAC name and its description. Your task is to design conversation between you (e.g. AI chemical assistant) and user asking about this molecule. Design sequence of pairs of questions and answers that gradually deepen the level of the conversation, from structural information and chemical properties to biological functionalities. Include questions asking about the molecules structural, chemical, and biological features, including functional groups, the most specific compound species name, corresponding chemical and biological properties, and functionalities, etc. User Input molecule (IUPAC name): {IUPAC name} Description: {Description} Table 10: Prompts for constructing the instruction dataset for each data type. {level} is chemical or biological. Prompt for Filtering Correct Responses System You are an assistant specializing in chemistry and biology. You are provided with molecules IUPAC name and its {level} description. Your task is to evaluate the factual accuracy of the given description based on the provided IUPAC name. Assign score from 1 to 4 based on the following criteria: 1: All contents are factually incorrect 2: Some contents are factually correct, but most are factually incorrect 3: Most contents are factually correct, but some are factually incorrect 4: All contents are factually correct Indicate your score in the format: Score: .... User Input molecule (IUPAC name): {IUPAC name} Description: {Description} Table 11: Prompts for filtering correct samples. {level} is one of the following: structural, chemical, and biological. 16 Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model Context Type 1: IUPAC Name (2R)-2-amino-3-methylsulfanylpropanoic acid Context Type 2: Description S-methylcysteine is cysteine derivative that is L-cysteine in which the hydrogen attached to the sulfur is replaced by methyl group. It has role as human urinary metabolite and plant metabolite. It is tautomer of S-methylcysteine zwitterion. Data Type 1: Detailed Structural Descriptions The molecule provided is chiral amino acid that contains several identifiable substructures. 1. **Amino Group**: This functional group consists of nitrogen atom bonded to two hydrogen atoms (N H2). It is attached to the second carbon atom of the main carbon chain, which is typical for amino acids as they feature the amino group connected to the alpha carbon. 2. **Carboxylic Acid Group**: Represented by COOH, this group includes carbon atom double-bonded to an oxygen atom and also bonded to an OH group. It is attached to the end of the carbon chain, characteristic of amino acids which bear carboxylic acid group at the terminal carbon. 3. **Main Carbon Chain**: The molecule has three-carbon chain serving as the backbone. The central carbon, referred to as the alpha carbon, is chiral center, meaning it is bonded to four different substituents: the amino group, the carboxylic acid group, hydrogen atom, and side chain. 4. **Methylsulfanyl Group**: Attached to the third carbon is side chain consisting of sulfur atom single-bonded to methyl group (SCH3). This group acts as the side chain substituent and characterizes the molecule as containing thioether linkage, where the sulfur atom replaces the carbon in the typical ether linkage. 5. **Chirality**: The molecule is chiral, with the alpha carbon being the stereocenter. Its configuration is designated as R, indicating the spatial arrangement of its substituents according to the Cahn-Ingold-Prelog priority rules. Overall, this molecule is sulfur-containing, optically active alpha amino acid with focus on the specific arrangement of its functional groups including the amino, carboxylic acid, and distinct methylsulfanyl side chain. This structure is essential for understanding its interactions and functions in biological systems. Data Type 2: Struture-to-Feature Relationship Explanations (Chemical Features) The given molecule is derivative of cysteine, an amino acid known for containing thiol group. In the given molecule, this thiol group has one of its hydrogen atoms replaced by methyl group, making it methylthioether. This structural tweak to cysteine results in distinct chemical properties. Firstly, the presence of the amino group (-NH2) classifies this compound as an amino acid, which contributes to its ability to act as zwitterion. This means that in aqueous solutions or physiological pH, it can contain both positive charge (on the ammonium group) and negative charge (on the carboxylate group), enhancing its solubility in water. The sulfur atom with methyl attachment forms thioether. This increases the molecules hydrophobic characteristics compared to cysteine, which contains more polar thiol group. This methylsulfanyl group can also affect the molecules reactivity and interaction with biochemical systems, possibly altering how it participates in or affects metabolic pathways. The stereochemistry indicated by specifies the spatial arrangement of groups around the chiral carbon atom, which corresponds to natural configurations found in biological systems like human and plant metabolites. This natural configuration is crucial for its biological activity and integration into metabolic processes. As human urinary metabolite, the presence of this compound in urine suggests its role in human metabolism where it might play role in sulfur metabolism or act as detoxification product. In plants, it could partake in sulfur metabolism and possibly aid in detoxification or defense processes due to environmental stressors. In summary, the structural modification from cysteine to include methylthioether enhances its lipophilic properties and potentially alters its metabolic and biochemical roles due to changes in reactivity, solubility, and interaction with enzymes or other biomolecules. Table 12: One example of the constructed instruction data. The top block shows the example of context types when prompting GPT-4o. The following two blocks show the responses of GPT-4o. 17 Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model Context Type 1: IUPAC Name (2R)-2-amino-3-methylsulfanylpropanoic acid Context Type 2: Description S-methylcysteine is cysteine derivative that is L-cysteine in which the hydrogen attached to the sulfur is replaced by methyl group. It has role as human urinary metabolite and plant metabolite. It is tautomer of S-methylcysteine zwitterion. Data Type 2: Struture-to-Feature Relationship Explanations (Biological Features) The given molecule, known as S-methylcysteine, is derivative of the amino acid cysteine. In its structure, the core amino acid framework is maintained, which consists of an amino group, carboxylic acid group, and side chain. In the side chain of this molecule, the sulfur atom of cysteine is bonded to methyl group, distinguishing it from the native structure of cysteine. The biological properties of the given molecule are influenced significantly by this methylation at the sulfur atom. This modification preserves some aspects of cysteines chemical behavior but also endows the molecule with unique characteristics: 1. **Human Urinary Metabolite Role**: The metabolite role of the molecule in humans suggests it participates in or results from various metabolic processes. The transformation of cysteine to S-methylcysteine may occur as part of detoxification pathways or sulfur metabolism. The presence in urine indicates the bodys method of excreting or regulating sulfur-containing compounds, possibly involved in processes managing oxidative stress or sulfur balance. 2. **Plant Metabolite Role**: In plants, sulfur-containing amino acids like the given molecule can function in sulfur storage, cellular redox regulation, or even in the defense against stress. Methylation of cysteine could help modulate its reactivity, buffering against electrophile attacks or preventing unwanted formation of disulfide bonds, which is crucial for cellular homeostasis. 3. **Tautomeric Properties**: The tautomeric relationship of the given molecule with its zwitterionic form is instrumental in understanding its behavior in biological environments, such as different pH conditions. As zwitterion, it can exhibit varied solubility and stability profiles, influencing its transport and reactivity within both human and plant systems. The methylsulfanyl group adds to the biological properties by contributing degree of non-polarity and slightly altering the exact steric and electronic nature of the side chain compared to cysteine, which can influence enzyme interactions, protein structure stability, and metabolic pathways where sulfur chemistry is paramount. Overall, despite being derived from cysteine, the methyl modification gives the molecule distinct roles and characteristics in living organisms. Data Type 3: Comprehensive Conversations USER: Can you tell me about the basic structure of the given molecule? ASSISTANT: Certainly! The given molecule is derivative of cysteine, where the hydrogen atom attached to the sulfur group is replaced by methyl group. This makes it include sulfur-containing side chain as part of its structure. It has an amino group (-NH2), carboxylic acid group (-COOH), and methylsulfanyl side chain, all connected to the central carbon atom. USER: What are the functional groups present in this molecule? ASSISTANT: The molecule contains the following functional groups: an amino group (-NH2), carboxylic acid group (-COOH), and methylthio group (methylsulfanyl, -SCH3). USER: What is the stereochemistry of this molecule? ASSISTANT: The given molecule has chiral center at the 2nd carbon atom and is specified to be in the (R)-configuration, meaning its spatial arrangement is determined relative to this stereocenter. USER: Can you tell me more about the specific species of this compound? ASSISTANT: The compound is known as S-methylcysteine. It is specific derivative of cysteine with distinctive methyl substitution on the sulfur atom, differing from the typical cysteine structure. USER: How does the molecules structure influence its chemical behavior? ASSISTANT: The structure of the given molecule, particularly the presence of both amino and carboxylic acid groups, contributes to its zwitterionic nature at physiological pH. The substitution of methyl group on the sulfur atom confers specific interactions and stability to the thiol, altering its reactivity compared to standard cysteine. USER: What role does this molecule play biologically? ASSISTANT: Biologically, S-methylcysteine serves as metabolite in both humans and plants. It is identified as human urinary metabolite and also plays role as plant metabolite, indicating its potential involvement in metabolic pathways within these organisms. USER: What might be some of the functions or activities attributed to this molecule? ASSISTANT: The molecule is involved in several functions due to its presence in metabolic processes. In plants, Smethylcysteine may play role in sulfur transport or storage. Its function as human metabolite could potentially affect pathways related to detoxification or protein synthesis where cysteine and its derivatives play roles. Table 13: One example of the constructed instruction data. The top block shows the example of context types when prompting GPT-4o. The following two blocks show the responses of GPT-4o. 18 Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model System You are helpful assistant specializing in chemistry and biology. The instruction that describes task is given, paired with molecules. Provide comprehensive response that appropriately completes the request. User Explain the components and how they are linked within the provided molecule. Detail the structural parts of the molecule and their interconnections. Outline the individual subunits of the molecule and describe their arrangement. Provide an analysis of the molecular substructures and how they are bonded together. Identify the segments of the molecule and elaborate on their attachments. Break down the molecular structure into its subcomponents and describe how they are connected. Map out the substructures within the molecule and illustrate how they are linked. Table 14: List of instructions for the detailed structural descriptions. System You are helpful assistant specializing in chemistry and biology. The instruction that describes task is given, paired with molecules. Provide comprehensive response that appropriately completes the request. User Provide an in-depth explanation of the chemical characteristics of the given molecule. Elaborate on the detailed chemical attributes and properties of the molecule. Describe the chemical properties of the provided molecule with comprehensive detail. Offer thorough analysis of the chemical characteristics of the compound. Discuss the chemical properties of the given compound extensively and in detail. Present an in-depth overview of the chemical attributes of the provided compound. Explain the detailed aspects of the chemical properties of the molecule. Analyze the the molecules chemical properties with an in-depth approach. Present detailed report on the chemical traits of the compound. Table 15: List of instructions for the structure-to-chemical feature relationship explanations. System You are helpful assistant specializing in chemistry and biology. The instruction that describes task is given, paired with molecules. Provide comprehensive response that appropriately completes the request. User Provide comprehensive explanation of the biological characteristics of the given molecule, focusing on how its main substructures relate to its biological properties. Discuss the molecules biological properties thoroughly, emphasizing the connection between its key substructures and their functions. Elaborate in detail on the biological attributes of the provided compound, explaining how its primary substructures are linked to its properties. Analyze the biological properties of the given compound, providing an in-depth explanation of how the core substructures of the molecule influence these properties. Describe the biological characteristics of the given molecule in detail, paying particular attention to how its main structural components affect its behavior. Offer an in-depth discussion of the biological traits of the molecule, specifically highlighting the relationship between the core parts of the molecule and its properties. Present detailed analysis of the biological properties of the provided molecule, focusing on how the essential substructures within the molecule correlate with these properties. Give an in-depth explanation of the biological properties of the provided molecule, especially how its core substructures are associated with these properties. Outline the biological properties of the given compound comprehensively, emphasizing the interplay between its main substructures and its biological behavior. Table 16: List of instructions for the structure-to-biological feature relationship explanations. 19 Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model System You are helpful assistant specializing in chemistry and biology. The instruction that describes task is given, paired with molecules. Write response that appropriately completes the request. Table 17: List of instructions for the comprehensive conversations. C. Experimental Details C.1. Quantitative Evaluation on General Understanding of Molecules To evaluate the general understanding of molecules, we ask general questions about structures and chemical and biological properties, respectively, as follows: Explain the structural features of the given molecule., Explain the chemical properties of the given molecule., and Explain the biological properties of the given molecule.. To assess the quality of responses, GPT-4o is provided the IUPAC name, the original descriptions annotated in PubChem (Kim et al., 2021), and the questions asked to the assistants as references. Then, given the responses of two assistants, GPT-4o assesses the scores of each response for five criteria: helpfulness, relevance, accuracy, level of detail, and overall scores. C.2. Molecular Property Prediction The prompts for predicting PAMPA results are provided in Table 18 and the prompts for evaluating the reasoning processes on the PAMPA task are provided in Table 19. If the generated responses do not follow the designated format of the final answer, we add the final answer format (i.e. Final answer: ) at the end of the generated responses and let LLMs generate in succession to make the final decision based on their previous reasoning process. System You are drug discovery assistant tasked with predicting the permeability of molecule in the Parallel Artificial Membrane Permeability Assay (PAMPA). Specifically, your role is to determine whether molecule has high permeability or low-tomoderate permeability to the artificial membrane. Consider the following properties of molecules: 1) Lipophilicity: Higher lipophilicity generally correlates with increased permeability, up to certain threshold. 2) Molecular Size and Weight: Smaller molecules tend to have higher permeability. 3) Polarity: Low polar surface area and low hydrogen bond donors/acceptors are associated with higher permeability. 4) Charge: Neutral molecules typically have better permeability compared to charged species, which are less likely to diffuse through the hydrophobic lipid bilayer. 5) Rigidity: high degree of rigidity often permeate membranes more easily. 6) Aromaticity: The presence of aromatic rings can influence lipophilicity and molecular interactions with the lipid bilayer, thereby affecting permeability. 7) Hydration Energy: Lower hydration energy generally improves membrane permeation. 8) Membrane Affinity: Compounds with balanced affinity for both the aqueous phase and the lipid bilayer tend to exhibit better PAMPA permeability. Your final answer should be formatted as either : Final answer : High permeability. or Low-to-moderate permeability. User Determine the permeability of the given molecule to the artificial membrane. Please provide rationale for your answer. Table 18: Prompts for PAMPA task. For the default setting, the blue prompt and green prompt are not included. For the CoT promoting, we add the blue prompt not including the green prompt, and, for the case with the task-specific information (w/ Task Info), we add the green prompt not including the blue prompt. 20 Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model System You are helpful assistant specializing in chemistry and biology, whose role is to evaluate the quality of the reasoning process of an AI assistant in predicting the permeability of molecules in the Parallel Artificial Membrane Permeability Assay (PAMPA). For your reference, the SMILES of the given molecule is provided. Evaluate the quality of each assistants response based on the criteria below: Fidelity: It evaluates the soundness and relevance of the reasoning process by assessing whether the reasoning is valid to appropriately address the given task. Helpfulness: It evaluates the quality of the reasoning process by assessing whether the reasoning is clear, informative, and helpful to the user. First, provide an explanation of your assessment, and then evaluate the score on scale of 1 to 10, where higher score indicates better quality. Follow the format in the below example: Explanation of the evaluation: Final Decision: [Assistant n] - Fidelity : ... - Helpfulness : ... User [Molecule Information] SMILES: {SMILES} [Assistant 1] {Response of Assistant 1} [End of Assistant 1] [Assistant 2] {Response of Assistant 2} [End of Assistant 2] Table 19: Prompts for evaluating reasoning results in PAMPA task. D. Additional Experimental Results D.1. Analysis of Generated Responses on PAMPA Task To further understand the behaviors of LLMs and molecular LLMs, we analyze the entire responses on PAMPA task for molecule of Fig. 3. As shown in Table 23, in the default setting, Mol-LLaMA tends to reason in substructure-wise manner. With the chain-of-thought prompting, the response is similar to the one of the default setting as Mol-LLaMA already provides the rationales in the default setting. For the case with the task-specific information, Mol-LLaMA successfully follows the instructions, providing detailed explanations for each given property. On the other hand, as shown in Table 24, GPT-4o tends to reason in property-wise manner, while the response with chain-of-thought prompting is not largely changed similarly to Mol-LLaMA. In contrast, as shown in Table 25, 3D-MoLM often misinterprets the molecular structures, leading to an incorrect prediction. LLaMo usually does not provide helpful response, directly making the final decision, as shown in Table 26. Figure 3: Input molecule Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model D.2. Ablation Study In Table 20 and 21, We report all scores of the ablation study in Table 5 including helpfulness, relevance, accuracy, and level of detail. STRUCTURAL CHEMICAL BIOLOGICAL Models Help. Relev. Acc. Details Overall Help. Relev. Acc. Details Overall Help. Relev. Acc. Details Overall 0.916 0.968 0.930 2D 3D 1.078 1.085 1.069 2D+3D (Concat) 1.039 1.076 1.060 2D+3D (Unified) 1.126 1.145 1.154 0.835 1.047 0.980 1.090 0.907 1.071 1.037 1. 1.129 1.168 1.163 1.185 1.206 1.237 1.187 1.221 1.256 1.224 1.266 1.302 1.100 1.157 1.156 1.211 1.137 1.195 1.210 1.251 1.432 1.631 1.760 1.507 1.713 1.853 1.571 1.827 2.002 1.578 1.840 2.030 1.362 1.443 1.537 1.528 1.526 1.632 1.741 1. Table 20: Ablation studies on molecular representations. We report all scores including helpfulness, relevance, accuracy, level of detail, and overall score following the settings in Section 4.2.2. STRUCTURAL CHEMICAL BIOLOGICAL PAMPA Models Help. Relev. Acc. Details Overall Help. Relev. Acc. Details Overall Help. Relev. Acc. Details Overall Default CoT w/ Task Info. 1.124 1.119 1.128 S+S2F 1.176 1.163 1.189 1.169 1.152 1.172 Conv. 1.126 1.145 1.154 Full 1.123 1.184 1.176 1.090 1.119 1.172 1.166 1.125 1.127 1.183 1.189 1.249 1.286 1.325 0.674 0.814 0.787 1.224 1.266 1.302 1.133 1.259 0.519 1.211 1.166 1.285 0.689 1. 1.201 1.320 1.499 1.604 1.814 2.005 0.861 1.079 1.067 1.578 1.840 2.030 1.310 1.608 0.589 1.528 1.328 1.754 0.887 1.744 37.35 66.83 41.03 63.55 32.92 64.13 45.95 64.37 56.02 57.88 83.05 72. Table 21: Ablation studies on data types. denotes the detailed structural descriptions, S2F denotes the structure-to-feature relationship explanations, and Conv. denotes the comprehensive conversations. We report all scores including helpfulness relevance, accuracy, level of detail, and overall score following the settings in Section 4.2.2. Additionally, we report the accuracy on PAMPA task. Models GPT-4o Llama2 Llama3 Mol-Instructions Mol-Instructions LlasMol 3D-MoLM LLaMo LLaMo LLM Default CoT w/ Task Info. 60.82 37.37 Llama2-7B Llama3.1-8B 57.07 52.58 Llama2-7B - Llama3.1-8B Mistral-7B 51.55 Llama3.1-8B 49.14 Llama2-7B Llama3.1-8B 55.44 - 61.34 51.56 51.03 52.58 - 54.64 51.65 49.36 55.45 52.58 55. 64.43 53.09 55.15 51.34 54.91 56.19 51.91 50.60 56.91 52.58 59.08 Mol-LLaMA (Ours) Llama2-7B 53.37 Mol-LLaMA (Ours) Llama3.1-8B 59.54 Table 22: Zero-shot performances on BBBP task. We report accuracy for the test set following the splitting from Zhou et al. (2023). The best results are highlighted in bold, and the second-best results are underlined. D.3. Molecular Property Prediction on BBBP We additionally conduct an experiment on BBBP task, where the task is to predict whether given molecule can penetrate the blood-brain barrier. The brain-blood barrier is system with high selectivity by complicated transport routes such as transporter-mediated transcytosis, receptor-mediated transcytosis, cell-mediated transcytosis, lipophilic pathway, efflux pumps, adsorptive transcytosis, and paracellular aqueous pathway (Wu et al., 2023). Therefore, the task requires external knowledge such as the structure of tight junctions, the interactions with membrane proteins, and the environment of BBB. We follow the experimental settings in Section 4.2.2, using three types of prompt strategies: default setting, CoT prompting, and providing task-specific information. As shown in Table 22, MolLLaMA shows high performance, achieving performance improvement compared to the base LLMs. However, GPT-4o outperforms all baselines due to its extensive knowledge. 22 Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model Mol-LLaMA (Ours) Default CoT with Task Info. The given molecule is complex organic compound with several structural features that influence its permeability in the PAMPA assay. Lets break down these features and their potential impact on permeability: 1. **Indole Core**: The presence of an indole moiety, which is bicyclic structure consisting of benzene ring fused to pyrrole ring, is significant. Indole derivatives are known for their ability to interact with biological membranes due to their planar structure and aromaticity. This can enhance the molecules ability to permeate through the artificial membrane, contributing to high permeability. 2. **Phenyl Group** : The phenyl group attached to the indole core adds to the hydrophobic character of the molecule. Aromatic rings like phenyl groups can facilitate interactions with the lipid bilayer of the artificial membrane, potentially increasing permeability. 3. **Pyrrolidinone Moiety** : The pyrrolidinone ring, which is five-membered lactam, introduces degree of polarity to the molecule. This can affect the overall solubility and permeability balance. The presence of carbonyl group within the pyrrolidinone can form hydrogen bonds, which might influence the molecules interaction with the membrane and its permeability. 4. **Carboxamide Group** : The carboxamide functional group is polar and can participate in hydrogen bonding. This group can enhance the molecules solubility in aqueous environments, which is crucial for its interaction with the PAMPA membrane. However, it may also introduce some steric hindrance, potentially reducing permeability. Overall, the given molecules structure suggests balance between hydrophobic and hydrophilic properties. The indole and phenyl groups contribute to hydrophobic interactions, while the pyrrolidinone and carboxamide groups introduce polar characteristics. These features collectively suggest that the given molecule likely exhibits high permeability in the PAMPA assay, as it can effectively interact with the artificial membrane. Final answer: High permeability The given molecule is complex organic compound with several structural features that influence its permeability in the PAMPA assay. Lets break down these features and their implications: 1. **Indole Core**: The presence of an indole moiety, which is bicyclic structure consisting of benzene ring fused to pyrrole ring, is significant. Indole derivatives are known for their ability to interact with biological membranes due to their planar structure and aromaticity. This can enhance the molecules ability to permeate through the artificial membrane, contributing to high permeability. 2. **Phenyl Group**: The phenyl group attached to the indole core adds to the hydrophobic character of the molecule. Aromatic rings like phenyl groups can engage in π-π interactions with the membrane, potentially increasing the molecules permeability. 3. **Pyrrolidinone Moiety**: The pyrrolidinone ring, which is five-membered lactam, introduces degree of polarity to the molecule. This can affect the overall solubility and permeability balance. The presence of carbonyl group in the pyrrolidinone can form hydrogen bonds, which might influence the molecules interaction with the membrane and its permeability. 4. **Carboxamide Group** : The carboxamide functional group is polar and can form hydrogen bonds, which may enhance the molecules solubility in aqueous environments. However, it can also affect the permeability by introducing steric hindrance and increasing the molecules overall polarity. Overall, the given molecule has combination of hydrophobic and polar features. The indole and phenyl groups contribute to hydrophobic interactions, while the pyrrolidinone and carboxamide groups introduce polar characteristics. These features suggest that the molecule would have balance of permeability, potentially leading to high permeability in the PAMPA assay. However, the exact permeability would depend on the specific conditions of the assay and the nature of the artificial membrane used. Final answer: High permeability. 1. **Lipophilicity**: The presence of aromatic rings, such as the phenyl group and the indolizine moiety, suggests that the given molecule is relatively lipophilic. This lipophilicity is likely to enhance its permeability through the lipid bilayer of the artificial membrane. 2. **Molecular Size and Weight**: The given molecule has moderate molecular size and weight, as indicated by its classification as pyrrolidinone. This size is not excessively large, which may allow it to pass through the membrane without significant steric hindrance. 3. **Polarity**: The molecule contains pyrrolidinone group, which introduces some degree of polarity. However, the overall structure is dominated by aromatic and hydrocarbon components, suggesting that the polar surface area is not high enough to significantly impede permeability. 4. **Charge**: The given molecule is neutral, which is favorable for permeability as charged molecules often have reduced ability to cross lipid membranes. 5. **Rigidity**: The indolizine moiety contributes to the rigidity of the molecule. Rigidity can enhance membrane permeability by allowing the molecule to maintain consistent conformation as it interacts with the membrane. 6. **Aromaticity**: The aromatic rings in the structure can engage in π-π interactions with the lipid bilayer, potentially enhancing permeability. 7. **Hydration Energy**: The presence of the pyrrolidinone group may lower the hydration energy of the molecule, facilitating its passage through the membrane by reducing the energy required to displace water molecules. 8. **Membrane Affinity**: The balance of hydrophobic and hydrophilic regions in the given molecule suggests that it has favorable membrane affinity, which is conducive to high permeability. Considering these structural characteristics, the given molecule is likely to exhibit high permeability in the PAMPA assay. Final answer: High permeability. Table 23: Generated responses of Mol-LLaMA on PAMPA task. GPT-4o Default CoT with Task Info. Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model To begin determining the permeability of the given molecule (identified as bicyclic pyrrole compound with an embedded quinoline structure), we need to consider several molecular properties that influence permeability in the Parallel Artificial Membrane Permeability Assay (PAMPA). Key factors that tend to influence permeability include: 1. **Lipophilicity** : Molecules with higher lipophilicity generally have higher permeability due to better membrane partitioning. The presence of aromatic rings and the overall hydrophobic character of this molecule suggests moderate to high lipophilicity. 2. **Molecular Weight** : Compounds with lower molecular weights usually have better permeability. However, this molecule appears to have moderate molecular weight, which could suggest moderate permeability. 3. **Polarity and Hydrogen Bonding** : Molecules with several hydrogen bond donors and acceptors tend to have lower permeability due to increased interaction with water. This molecule contains multiple potential sites for hydrogen bonding (e.g., amide NH groups, ketone, and nitrogen atoms in rings), which might suggest lower permeability. 4. **Structural Rigidity and Planarity** : Rigidity and planarity can enhance membrane permeability as they may facilitate passage through lipid layers. The bicyclic and aromatic nature of the compound could potentially increase permeability. Upon considering these factors, the multiple heteroatoms and hydrogen bonding potential in the structure suggest that, despite its potentially favorable aspects like lipophilicity, other factors potentially reduce its permeability. Therefore, integrating these insights, the overall picture leans towards the molecule demonstrating reduced permeability. Final answer: Low-to-moderate permeability. To evaluate the permeability of the given molecule using the Parallel Artificial Membrane Permeability Assay (PAMPA), we should consider several structural and physicochemical factors that influence passive diffusion through artificial membranes. 1. **Molecular Size**: Smaller molecules generally permeate membranes more easily than larger molecules. The given molecule is relatively large due to the presence of multiple rings and multiple atoms, indicating potential low permeability. 2. **Lipophilicity**: Lipophilicity (often estimated by LogP) plays crucial role in membrane permeability. The presence of aromatic rings and the amide groups suggests moderate lipophilicity. The two amide groups, which can form hydrogen bonds, might reduce lipophilicity and thus permeability to lipid-like membranes. 3. **Polarity and Hydrogen Bonding**: The presence of polar functional groups such as the carbonyl and the secondary and tertiary amine groups can increase polarity and potential hydrogen bonding with the aqueous phase, decreasing permeability. 4. **Planarity**: The presence of multiple aromatic rings that might be able to stack could imply some level of planarity aiding in permeability. However, the overall complexity and potential for multiple conformations could negate this advantage. Based on this analysis, especially considering the overall size and the presence of hydrogen-bond forming groups which can interact with the aqueous environment and hinder passive diffusion, the molecule is more likely to exhibit: Final answer: Low-to-moderate permeability. To evaluate the PAMPA permeability of the given molecule, we need to consider several molecular properties based on the IUPAC name and SMILES string provided: 1) **Lipophilicity**: The molecule contains aromatic rings, which generally enhance lipophilicity. However, this is balanced by the presence of polar functional groups such as amides. 2) **Molecular Size and Weight**: The molecule features multiple ring structures, indicating relatively large size and weight, which may hinder permeability. 3) **Polarity**: The presence of amide groups increases polarity, which could reduce permeability. The molecule also has moderate potential for hydrogen bonding. 4) **Charge**: There are no apparent ionizable groups that would carry charge at physiological pH, suggesting that the molecule remains neutral, favoring higher permeability. 5) **Rigidity**: The molecule appears to be fairly rigid due to its fused and aromatic ring structures, which can facilitate membrane permeation. 6) **Aromaticity**: The aromatic rings present will influence the hydrophobic interactions with the lipid bilayer, potentially enhancing permeability. 7) **Hydration Energy**: Polar groups and potential for hydrogen bonding can increase hydration energy, thus reducing permeability. 8) **Membrane Affinity**: The molecules structure suggests balanced hydrophilic and hydrophobic characteristics, which could result in moderate affinity for the membrane. Taking these properties into account, the molecule has characteristics that both enhance and reduce permeability. The moderate size, polarity, and hydration energy, combined with the presence of lipophilic and rigid structures, suggest that the molecules permeability would not be categorized as high. Final answer: Low-to-moderate permeability. Table 24: Generated responses of GPT-4o on PAMPA task. 24 Mol-LLaMA: Towards General Understanding of Molecules in Large Molecular Language Model 3D-MoLM Default CoT with Task Info. The molecule with the SMILES code C1CC(=O)NC1CNC(=O)C2=C3C=CNC3=CC(=N2)C4=CC=CC=C4 is pyrazolo[1,5a]pyrimidine-7-carboxamide derivative. It consists of pyrazolo[1,5-a]pyrimidine core with carboxamide group attached at position 7. The molecule also contains pyrrolidine ring and phenyl ring. The presence of the carboxamide group suggests that this molecule may have the ability to form hydrogen bonds, which can influence its permeability. Additionally, the presence of the pyrrolidine ring and the phenyl ring can contribute to the overall hydrophobicity of the molecule. Based on the structure and the presence of the pyrazolo[1,5-a]pyrimidine core, it is likely that this molecule has low-to-moderate permeability to the artificial membrane. The pyrazolo[1,5-a]pyrimidine core is known to have moderate permeability, and the presence of the carboxamide group and the phenyl ring may slightly enhance or hinder the permeability, respectively. Therefore, the final answer is: Final answer: Low-to-moderate permeability. The molecule with the SMILES code C1CC(=O)NC1CNC(=O)C2=C3C=CNC3=CC(=N2)C4=CC=CC=C4 is pyrroloquinoline derivative. Pyrroloquinolines are class of heterocyclic compounds that contain pyrrole ring fused with quinoline ring. This particular molecule is derivative of pyrroloquinoline, with additional functional groups attached. The molecule has pyrrolidine ring (C1CC(=O)NC1) and pyrroloquinoline ring (CNC(=O)C2=C3C=CNC3=CC(=N2)C4=CC=CC=C4). The presence of the pyrrolidine ring suggests that the molecule may have some degree of flexibility and can adopt different conformations. The pyrroloquinoline ring is aromatic, which means it has planar structure and exhibits delocalized pi-electrons. This aromaticity contributes to the molecules stability and can influence its reactivity. The presence of amide groups (C(=O)N) in the molecule indicates the potential for hydrogen bonding and the ability to form intermolecular interactions. These interactions can affect the molecules solubility and permeability. Based on the structure and functional groups present, it is likely that this molecule has low-to-moderate permeability to the artificial membrane. The presence of aromatic rings and amide groups can influence the molecules ability to pass through the membrane, but the overall size and complexity of the molecule may limit its permeability. Therefore, the final answer is: Final answer: Low-to-moderate permeability. The molecule with the SMILES code C1CC(=O)NC1CNC(=O)C2=C3C=CNC3=CC(=N2)C4=CC=CC=C4 is complex compound with various chemical and physical properties that influence its permeability in the Parallel Artificial Membrane Permeability Assay (PAMPA). Lets analyze these properties to determine the permeability of the molecule. 1. Lipophilicity: The presence of multiple aromatic rings, such as the phenyl ring, suggests that this molecule is lipophilic. Lipophilicity generally correlates with increased permeability, up to certain threshold. 2. Molecular Size and Weight: The molecule has relatively large size due to the presence of multiple rings and functional groups. This size may limit its permeability. 3. Polarity: The molecule contains polar functional groups, such as amide and carbonyl groups, which contribute to its overall polarity. However, the presence of aromatic rings and hydrophobic substituents, like the phenyl ring, suggests that the molecule may have balanced affinity for both the aqueous phase and the lipid bilayer. 4. Charge: The molecule is neutral, which is generally favorable for permeability. 5. Rigidity: The presence of multiple rings and the rigidity of the molecule may contribute to its permeability. 6. Aromaticity: The molecule contains aromatic rings, which can influence lipophilicity and molecular interactions with the lipid bilayer, thereby affecting permeability. 7. Hydration Energy: The presence of polar functional groups may result in higher hydration energy, which could potentially hinder membrane permeation. 8. Membrane Affinity: The balanced affinity for both the aqueous phase and the lipid bilayer suggests that the molecule may exhibit better PAMPA permeability. Based on these properties, the molecule is expected to have low-to-moderate permeability to the artificial membrane. The presence of polar functional groups, large size, and potential hydration energy limitations may hinder its diffusion through the lipid bilayer. However, the lipophilicity, rigidity, and aromaticity may contribute to its permeability to some extent. Therefore, the final answer is: Final answer: Low-to-moderate permeability. Table 25: Generated responses of 3D-MoLM on PAMPA task."
        },
        {
            "title": "LLaMo",
            "content": "Default The molecule has low-to-moderate permeability to the artificial membrane. CoT with Task Info. The molecule has high permeability to the artificial membrane. The molecule has high lipophilicity, low molecular size and weight, low polarity, and is neutral. It also has high degree of rigidity and aromaticity, which are all factors that contribute to higher permeability. Final answer: The molecule has high permeability. Table 26: Generated responses of LLaMo on PAMPA task."
        }
    ],
    "affiliations": [
        "DeepAuto.ai",
        "Korea Advanced Institute of Science and Technology (KAIST), Seoul, South Korea"
    ]
}