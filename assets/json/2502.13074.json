{
    "paper_title": "The snake in the Brownian sphere",
    "authors": [
        "Omer Angel",
        "Emmanuel Jacob",
        "Brett Kolesnik",
        "Grégory Miermont"
    ],
    "sections": [
        {
            "title": "Abstract",
            "content": "The Brownian sphere is a random metric space, homeomorphic to the two-dimensional sphere, which arises as the universal scaling limit of many types of random planar maps. The direct construction of the Brownian sphere is via a continuous analogue of the Cori--Vauquelin--Schaeffer (CVS) bijection. The CVS bijection maps labeled trees to planar maps, and the continuous version maps Aldous' continuum random tree with Brownian labels (the Brownian snake) to the Brownian sphere. In this work, we describe the inverse of the continuous CVS bijection, by constructing the Brownian snake as a measurable function of the Brownian sphere. Special care is needed to work with the orientation of the Brownian sphere."
        },
        {
            "title": "Start",
            "content": "5 2 0 2 8 1 ] . m [ 1 4 7 0 3 1 . 2 0 5 2 : r a"
        },
        {
            "title": "The snake in the Brownian sphere",
            "content": "Omer Angel Brett Kolesnik Emmanuel Jacob Grégory Miermont February 2025 Abstract The Brownian sphere is random metric space, homeomorphic to the two-dimensional sphere, which arises as the universal scaling limit of many types of random planar maps. The direct construction of the Brownian sphere is via continuous analogue of the CoriVauquelin Schaeffer (CVS) bijection. The CVS bijection maps labeled trees to planar maps, and the continuous version maps Aldous continuum random tree with Brownian labels (the Brownian snake) to the Brownian sphere. In this work, we describe the inverse of the continuous CVS bijection, by constructing the Brownian snake as measurable function of the Brownian sphere. Special care is needed to work with the orientation of the Brownian sphere."
        },
        {
            "title": "1 Introduction",
            "content": "The CoriVauquelinSchaeffer (CVS) bijection [8, 24] is correspondence between labeled trees and rooted and pointed quadrangulations of sphere, where by pointed we mean that an additional vertex, other than the root, has been distinguished. Given (rooted and pointed) quadrangulation, the University of British Columbia, Department of Mathematics École Normale Supérieure de Lyon, Unité de Mathématiques Pures et Appliquées University of Warwick, Department of Statistics École Normale Supérieure de Lyon, Unité de Mathématiques Pures et Appliquées, and Institut Universitaire de France 1 inverse CVS bijection yields labeled plane tree, which is naturally embedded in the sphere, together with the map. continuum analogue of the CVS bijection may be obtained by associating metric measure space (X, d, µ) with pair of real-valued functions (f, g), where should be interpreted as the contour function of some R-tree Tf , and as label function defined on Tf . When the pair of functions is random, with law given by the Brownian snake [11], the resulting random metric space is called the Brownian sphere [14, 19]. More specifically, taking to be normalized Brownian excursion, Tf is Aldous continuum random tree (CRT) [13]. This random R-tree is given Brownian labels g, which can be interpreted as Brownian motion indexed by the CRT. The Brownian sphere is singular, spherical metric space (almost surely homeomorphic to the 2-dimensional sphere [16], but of Hausdorff dimension 4 [12]), which describes the scaling limit of many natural models of large planar maps of the sphere, as was first established by Le Gall [14] and Miermont [19]. The purpose of this work is to invert the continuum CVS mapping, so as to find the Brownian snake (and tree) in the Brownian sphere. While the Brownian sphere was first discovered as the scaling limit of random planar maps, it has since been constructed by other means, with connections to Liouville quantum gravity [2123]. Therefore, our results further emphasize that the Brownian tree and snake are fundamental objects in modern probability, which present themselves, regardless of the way in which the Brownian sphere is constructed. Our main result is the following. Theorem 1. Let (X, d, µ) be the Brownian sphere, and let x0, x1 be two independent points in X, drawn according to the measure µ. Then, almost surely, there exists measurable function of (X, d, µ, x0, x1), that outputs an R-tree and label function : R, in such way that: (i) has the law of the CRT, (ii) are Brownian labels on , and (iii) the continuum CVS mapping applied to (T , Z) recovers (X, d, µ). The last point of the theorem requires some interpretation, because the continuum CVS mapping will formally be defined on pairs of functions encoding (T , Z), which endow the tree with some extra structure; namely, with certain planar order. See Theorem 4 below for formal version of Theorem 1."
        },
        {
            "title": "1.1 The construction",
            "content": "As we will see, the construction in Theorem 1 is quite natural. In order to describe the inverse continuum CVS mapping, we use the geometric notion of cut locus. We recall that, if is geodesic metric space, the cut locus of with respect to point is the set of all points such that there are at least two distinct geodesics between and x. Let C(X, d, x) denote the cut locus of the Brownian sphere (X, d) with respect to x. For the Brownian sphere, Le Gall [13] showed that, for µ-almost every x, the cut locus has measure 0, and is dense in X. The inverse continuum CVS mapping is constructed in several steps, as outlined below: 1. Given the doubly marked Brownian sphere (X, d, µ, x0, x1), let = C(X, d, x1) be the cut locus with respect to x1. 2. For each point C, define Z(y) = d(y, x1) d(x0, x1). 3. Observe that (C, d) is almost surely (a.s.) path-connected and has no cycles. By local connectivity there is topology on in which it is dendrite embedded in the Brownian sphere. 4. Observe that does not include the leaves of the dendrite, however, the labels extend continuously to the closure of with respect to local topology, intrinsic to C. 5. Define metric on so that : is Brownian motion indexed by . To find the distance, note that dT (u, v) is the quadratic variation of the function along the unique path between and in . 6. The orientation of the Brownian sphere induces an order on , making it plane tree, and thereby canonically encoded by contour process. These steps will be justified in Section 4, where we will also address the delicate question of the measurability of the resulting mapping. Let us discuss little more the role of the marked points and of the orientation in the construction."
        },
        {
            "title": "1.2 The marked points",
            "content": "The two marked points x0, x1 indeed play crucial role in the recovery of the label process. Roughly speaking, we will use one marked point to determine its time origin, and the other marked point for its values. The roles of x0 and x1 are very different in the mapping that we construct. For given space (X, d, µ, x0, x1) as in Theorem 1, change of x0 amounts to re-rooting of the tree . change in x1, on the other hand, modifies the 3 tree and process profoundly. Roughly, the tree is cut into countably many trees, which are then reconnected in different manner, while maintaining the increments of on each part. We note that the Brownian sphere usually comes equipped with distinguished point ρ, called the root. By Le Galls [13] re-rooting property, ρ is equal in distribution to random point drawn according to the measure µ. The two marked points x0, x1 in our construction are independent, with the same distribution as ρ."
        },
        {
            "title": "1.3 Choosing an orientation",
            "content": "The choice of an orientation for the Brownian sphere also plays crucial role in our construction. The Brownian sphere is homeomorphic to sphere, and thus orientable. Previous works, however, have mostly avoided explicitly discussing the issue of orientation. Both constructions of the Brownian sphere, as quotient of the CRT or via Liouville quantum gravity, give rise to natural orientation of the sphere. However, if we are given the Brownian sphere as an unoriented metric space, there are two possible orientations. Reversing the orientation of the sphere corresponds to reflection of the CRT. It is worth explaining what we mean when discussing the Brownian sphere as an oriented space. It is not smooth manifold, so some standard definitions fail. There are several possible equivalent definitions for the orientation of topological sphere X: 1. For each simple loop we may regard one side as the interior and the other as the exterior, making the choice continuously on the space of loops in X. 2. For each collection of pairwise disjoint paths emanating from X, we can determine cyclic order, again making the choice continuously on the space of such stars. 3. Observe that the homology group H2(X, Z) is isomorphic to Z, and select one of the generators as +1 and the other as 1. Of these, the first and third extend naturally to higher dimensions. The first two are local and generalize to topologies other than the sphere. In the case of topological sphere, these definitions are all equivalent. To deal with the fact that the Brownian sphere has been defined as an unoriented metric space, there are two approaches that one might take. One could consider the Brownian sphere as an oriented metric space to begin 4 with. This would require revisiting the definition of the Brownian sphere, and to view it as random element of space of oriented metric spheres. Working in such an abstract space would create some undesirable technicalities. Specifically, number of steps in the construction of the Brownian sphere would need to be revisited to show that all steps work with oriented spheres. For example, Le Gall and Paulin [16] used Moores theorem to show that the Brownian sphere is homeomorphic to the sphere. The usual form of Moores theorem does not provide an orientation for the quotient space, though one can verify that there is natural orientation. Another approach, which we will follow, is to simply consider the Brownian sphere as metric space, and assign to it random orientation based on an independent variable ϵ {1}, to account for the two possible orientations. This is conceptually simpler, but poses some measurability issues that will need to be addressed."
        },
        {
            "title": "1.4 Other Brownian surfaces",
            "content": "The Brownian sphere is only one element in family of compact [5, 6] or non-compact [4, 9] Brownian random surfaces, including the Brownian plane, disc, and any compact orientable surface with or without boundary. Although we did not work out the details, we are confident that the methods and results of this paper generalize to these objects with little change, and similar inverse bijections to that of Theorems 1 and 4 can be derived in these settings, because Brownian random surfaces all have similar constructions in terms of labeled tree-like structures. For instance, the Brownian plane [9], which is random pointed metric measure space (X, d, µ, x0) that is a.s. homeomorphic to R2, is obtained if the Brownian excursion used to generate the CRT is replaced by two-sided, infinite Brownian motion encoding the infinite, self-similar CRT, see e.g. [4]. In this setting, the second marked point x1 can be taken to be at infinity. The labels are well-defined, since there is unique Busemann function Bx0(x) = d(x, ) d(x0, ) on the Brownian plane, and the cut locus with respect to infinity is the set of points from which one can start multiple geodesics rays. From these basic facts, one should be able apply the methods of Section 4 with little change. In this situation, however, the orientation random variable ϵh appearing below in (3) would need to be defined in some other way, but fortunately, there is some flexibility in its choice, see the last remark of Section 3.1."
        },
        {
            "title": "1.5 Organization of the paper",
            "content": "The rest of the paper consists of three sections. In Section 2, we review the basic constructions of the Brownian tree, snake and sphere, and properly define the continuum Cori-Vauquelin-Schaeffer mapping that we want to invert. Section 3 states and discusses Theorem 4, more precise version of Theorem 1, and shows how the latter follows from the former. Section 4 provides the proof of Theorem 4, following the steps in Section 1.1."
        },
        {
            "title": "1.6 Acknowledgments",
            "content": "We thank Jean-François Le Gall for useful discussions. The authors would like to thank the Isaac Newton Institute for Mathematical Sciences, Cambridge, for support and hospitality during the program Random geometry, where initial work on this paper was undertaken. This work was supported by EPSRC grant EP/K032208/1. OA is supported in part by NSERC."
        },
        {
            "title": "2 Random snakes and the Brownian sphere",
            "content": "We first review the definitions of some of the known objects we will work with, namely, the Brownian tree, snake and sphere, and the properties that will be needed in the proof of Theorem 4 below."
        },
        {
            "title": "2.1 Deterministic encodings",
            "content": "Let us first give general discussion on some metric structures encoded by deterministic functions. 2.1.1 Trees coded by functions If : [0, 1] is continuous function such that (0) = (1) = 0, we define df (s, s) = (s) + (s) 2 max (cid:18) inf [ss,ss] f, inf [0,ss][ss,1] (cid:19) , which defines pseudometric on [0, 1]. This means that it is symmetric function that satisfies the triangle inequality, and vanishes on the diagonal. In fact, we can alternatively view as function : S1 R, where the unit 6 circle S1 is identified with R/Z, and, with this identification, the expression for df simplifies to df (s, s) = (s) + (s) 2 max (cid:18) inf [s,s] f, inf [s,s] (cid:19) , where [s, s] and [s, s] are the two naturally oriented arcs of S1 between and s. The quotient Tf = [0, 1]/{df = 0}, endowed with the distance inherited from df , is an R-tree, and for a, Tf , we denote by [[a, b]]f the unique geodesic segment between and in (Tf , df ). It naturally carries distinguished point ρf = pf (argmin ), where pf : [0, 1] Tf is the quotient mapping. Note df (s, t) = 0 whenever attains its infimum at and t, so ρf is well defined. We call (Tf , df , ρf ) the rooted tree coded by . 2.1.2 The mating of trees metric Let us denote by the space of pairs = (f, g) of continuous functions f, : [0, 1] R, taking value 0 at 0 and 1. We associate with and the trees (Tf , df ) and (Tg, dg) as above1. For S, the mating of trees pseudometric is defined, for every s, in [0, 1], by dh(s, t) = inf (cid:40) (cid:88) i=1 dg(si, ti) : 1, = s1, t1, s2, t2, . . . , sk, tk = df (tj, sj+1) = 0, 1 1 (cid:41) . The quotient Xh = [0, 1]/{dh = 0}, endowed with the distance inherited from dh, is called the mating of trees coded by h. Informally, it is obtained by wrapping the tree (Tg, dg) around the tree Tf . Note that the construction is not at all symmetric in the two trees. In particular, it depends strongly on dg, but depends on only through the set {df = 0}, that is, on the topological space Tf . 1In our applications below, starting with Section 2.3, we will require the further property that (f, g) encodes snake trajectory. This means that can be interpreted as label function on the tree Tf , in the sense that g(s) = g(t) for any s, such that df (s, t) = 0. However, we stress that the discussion of Section 2.1 holds in full generality. 7 As consequence of the definition of the quotient metric dh, there is natural commutative diagram: [0, 1] pg Tg pf ph pg Tf pf Xh (1) All projection mappings pf , pf , pg, pg, ph are continuous. Therefore, Xh can be seen as the quotient of either Tf or Tg, with canonical projections pf , pg. The space Xh naturally carries two distinguished points x0 = ph(argmin ) = pf (ρf ) and x1 = ph(argmin g) = pg(ρg) , where, we recall that ρf , ρg are the roots of the trees Tf , Tg. We also define the image measure µh = (ph)Leb[0,1], which we call the area measure on Xh. 2.1.3 GromovHausdorff-type spaces In order to consider random versions of the metric space constructions discussed above, with random, we will need to introduce Gromov Hausdorff-type spaces. Suppose that (X, dX, µX, (ai)1in) and (Y, dY , µY , (bi)1in) are two compact metric measure spaces with 0 distinguished points. We call them isometric if there exists an isometry φ : (X, dX) (Y, dY ) such that µY = φµX and φ(ai) = bi for 1 n. We let [X, dX, µX, (ai)1in] denote the isometry class of (X, dX, µX, (ai)1in). We endow the set mMn of all such isometry classes with the GromovHausdorffProkhorov topology. We write Xn to denote generic element of mMn, to emphasize that it has marked points. When = 0, we write mM = mM0 and = X0. In Section 3.3 below, we will also consider the GromovHausdorff space of isometry classes [X, d] of compact metric spaces, endowed with the GromovHausdorff topology. In particular, for every S, the isometry class [Xh, dh, µh, x0 h] is an . We also let Xh = [Xh, dh, µh] be h, element of mM2, which we denote by X2 its unmarked version."
        },
        {
            "title": "2.2 The continuum CVS mapping ψ",
            "content": "Finally, using the above definitions, we obtain mapping ψ : mM2 (cid:55) X2 , (2) which we call the continuum CVS mapping. Proposition 2. The continuum CVS mapping is measurable. Proof. Let Cm be the space of continuous functions from [0, 1]2 to R+ that are pseudometrics. Consider the mapping ψ1 : = (f, g) Cm [0, 1] [0, 1] (cid:55) ((dh(s, t), 0 s, 1), s(f ), s(g)) , where s(f ) (resp. s(g)) is the first times that (resp. g) attains its minimum. We already mentioned that dh is pseudometric. The fact that it is continuous can be seen by writing dh(s, t) dh(s, t) dh(s, s) + dh(t, t) dg(s, s) + dg(t, t) , which goes to 0 as (s, t) (s, t). Moreover, for fixed integer 1, for δ > 0 and for s, [0, 1], the quantities d(k,δ) (s, t) = inf (cid:40) (cid:88) i= dg(si, ti) : = s1, t1, s2, t2, . . . , sk, tk = df (tj, sj+1) < δ, 1 1 (cid:41) are measurable functions of (note that the infimum can be taken over choices of t1, s2, t2, . . . , sk in Q), so that the same holds for dh(s, t), since it equals limk limδ0 d(k,δ) (s, t). The measurability of ψ1 follows. Finally, consider the mapping ψ2 : Cm [0, 1] [0, 1] mM2 (d, s, t) (cid:55) [[0, 1]/{d = 0}, d, pLeb, p(s), p(t)] , where for Cm, the mapping : [0, 1] [0, 1]/{d = 0} is the canonical projection map. This mapping is easily seen to be continuous. Altogether, we obtain the result, noting that ψ = ψ2 ψ1. 9 The following lemma is simple but important observation. For S, we denote by R(h) the reversed path (f (1 ), g(1 )). Lemma 3. For every S, the spaces X2 of mM2. and X2 R(h) are equal as elements The proof is immediate, noting that [0, 1] (cid:55) 1 induces an isometry h) and (XR(h), dR(h), µR(h), x0 R(h)). We remark R(h) is between (Xh, dh, µh, x0 that if one considers the quotient spaces as oriented spheres, then X2 the reflection of X2 , i.e. the same space with the opposite orientation. R(h), x1 h, x"
        },
        {
            "title": "2.3 The Brownian tree, snake and sphere",
            "content": "The Brownian tree, snake and sphere are obtained by applying the above constructions to certain natural random functions. Let (et, 0 1) be normalized Brownian excursion. The tree (Te, de) that it encodes is called Aldous continuum random tree (CRT). The Brownian excursion is nonnegative, so its root is simply ρe = pe(0). Next, conditionally given e, define continuous centered Gaussian process (Zt, 0 1) with covariance function Cov(Zs, Zt) = inf stust eu. The fact that such process has continuous version is well known. Moreover, almost surely, Zs = Zt for every s, such that de(s, t) = 0, so that can be seen as process indexed by Te. Indeed, this process can be interpreted as Brownian motion indexed by Te, with value 0 at ρe, and with independent increments over disjoint paths. The pair = (e, Z) is random element of S, which we call the Brownian snake2. Its law is denoted by PSnake. Finally, applying the continuum CVS mapping ψ : (cid:55) X2 to the Brownian snake, we obtain the (doubly marked) Brownian sphere X2 , with Sphere = ψPSnake. We also denote by values in mM2. We denote its law by P2 PSphere the law of the unmarked Brownian sphere XW , with values in mM. 2In fact, what is usually called the Brownian snake is the path-valued Markov process encoding the trajectories of from the root of Te, as one follows the contour of the tree. The process is called the lifetime process of the snake, and the head of the snake. However, this path-valued process can be recovered as continuous function of (e, Z)."
        },
        {
            "title": "3 The inverse continuum CVS mapping ϕ",
            "content": "Our goal is to invert the continuum CVS mapping, that is, to find measurable mapping mM2 that is an (almost sure) inverse of ψ One possible approach is as follows. Suppose we find Borel subset such that PSnake(S A) = 0 and ψA is injective. Then, by general theorem of Lusin and Souslin on measurable functions on Polish spaces (see, e.g., Kechris [10, Corollary 15.2]), it would follow that ψ(A) mM2 is Borel set, and that the inverse ϕ : ψ(A) is Borel measurable. This approach, however, has two major drawbacks. First, it gives an abstract inverse function, without telling us anything about its nature or how to compute it. Secondly, this approach requires the continuum CVS mapping to be almost everywhere injective, which it is not, due to Lemma 3. Applying the reflection R, while preserving the planar tree structure and Brownian labels, has the effect of reversing the orientation of the Brownian sphere (as will be further discussed in Section 4.3). However, mM2 does not include information about the orientation of the sphere. Thus, as we will state and prove rigorously below (see Theorem 4), the continuum CVS mapping is actually 2-to-1 on set of full probability for the law PSnake. This is also the case for discrete maps, if one does not keep track of their orientation. This has not been an issue in the past since discrete maps have always been considered as oriented (not just orientable), so that map and its reflection are considered as distinct objects. However, previous works on the Brownian sphere have opted to omit the orientation when taking the limit, so that map and its reflection are considered identical. To overcome this issue, we work in an extended space mM2 {1}. The coordinate in {1} is used to determine the orientation of the Brownian sphere. As one might expect, this orientation turns out to be uniformly random (see Proposition 5). However, as we will see, describing this choice in measurable way requires some care. For = (f, g) S, recall that s(g) is the first time that attains its minimum. We put ϵh = sgn(1 2s(g)) = (cid:40) 1 1 if s(g) 1/2 if s(g) > 1/2 . (3) We then extend the mapping ψ by ψ : mM2 {1} (cid:55) (ψ(h), ϵh) . (4) When = (e, Z) follows the law of the Brownian snake, the infimum of is a.s. attained at the unique time = s(Z), as shown in [17, 2.3]. Since has cyclically exchangeable increments, this implies that is uniformly distributed in [0, 1], see [7, Corollary 3.1]. In particular, ϵW follows the Rademacher distribution (equal to 1 with equal probability). We may finally state our main result in precise form. Theorem 4. There exists Borel mapping ϕ : mM2 {1} which is an a.s. inverse of ψ, in the sense that: (i) P2 Sphere(dX2)-a.s., and for every ϵ {1}, ψ ϕ(X2, ϵ) = (X2, ϵ) , and (ii) PSnake(dh)-a.s., ϕ ψ(h) = . This result immediately yields that, P2 Sphere(dX2)-a.s., for ϵ {1}, ψ ϕ(X2, ϵ) = X2 , which justifies our interpretation of ϕ as an inverse of the continuum CVS mapping ψ. See also (6) below for composing ϕ and ψ in the reverse order. In the following subsections, we will explain why the above statement implies Theorem 1, which will also allow us to clarify the role of the parameter ϵ and of the two marked points that appear in the input of the mapping ϕ."
        },
        {
            "title": "3.1 The role of ϵ",
            "content": "Let us first discuss the meaning of the parameter ϵ {1}. We claim that, PSnake(dh)-a.s., ψ(R(h)) = (ψ(h), ϵh), (5) recalling that R(h) is time-reversal of h. Indeed, as already mentioned, ψ(h) and ψ(R(h)) are equal as elements of mM2. Also, ϵR(h) = ϵh, PSnake(dh)- a.s., because the law of s(g) under PSnake is diffuse, so that the probability 12 s(g) = 1/2 (and hence that ϵR(h) = ϵh) is zero. In particular, we deduce the following two properties. First, PSnake(dh)-a.s., for ϵ {1}, ϕ (ψ(h), ϵ) {h, R(h)} . Second, P2 Sphere(dX2)-a.s., ϕ(X2, ϵ) = R(ϕ(X2, ϵ)) , ϵ {1} . (6) (7) These properties show that ϵ determines the orientation of h. As we will see in the course of the proof of Theorem 4, ϵ allows one to distinguish PSnake-almost surely from R(h). Moreover, ϵ determines an orientation of ψ(h), which under Ph is a.s. topological sphere, and this orientation is reversed by changing ϵ to ϵ. See Section 4.3 for more details. Next, we describe the joint law of (ψ(h), ϵh) under PSnake. Proposition 5. Under PSnake(dh), the random variables ψ(h) and ϵh are independent, and the latter has the Rademacher distribution. Proof. We use the well-known (and easy to check) fact that R(h) has same distribution as under PSnake. Therefore, (5) implies that (ψ(h), ϵh) and (ψ(h), ϵh) have same distribution under PSnake. Hence, the random variables ϵh have the same law conditionally given ψ(h). The result follows. The above proposition and the discussion just before its statement are in line with the intuitive fact that, conditionally given the (orientable, but not oriented) random sphere X2 considered in Section 2.3, the choice of orientation is determined by an independent fair coin flip. On rigorous grounds, the mapping ϕ allows this choice to be done in measurable way. As an immediate consequence, we have the following. Recall that P2 Sphere is the image measure ψPSnake. Corollary 6. The measure PSnake is the image measure of P2 under the mapping ϕ. Sphere(δ1+δ1)/2 Remark. We mention that the choice of the random variable ϵh is not canonical. Theorem 4 would remain true (although for possibly different inverse function ϕ) if we had adopted some other definition than (3), as long as it almost surely differentiates from R(h). However, for choice of ϵh not satisfying the additional property (5), Corollary 6 would not be true."
        },
        {
            "title": "3.2 The role of the marked points",
            "content": "The role of ϵ being now (partially) clarified, let us address the role of the . Recall the notation PSphere for the law of the distinguished points x0 , x1 unmarked Brownian sphere. By the re-rooting property [13], conditionally given [X, d, µ] with law PSphere, if y0 and y1 are two independent random points in with law µ, then [X, d, µ, y0, y1] has law P2 play the role of two independent marked points, distributed according to the area measure3. Sphere. In other words, the points x0 , x1 Summarizing the discussion of this and the preceding sections, we arrive at the following statement, which is more precise version of Theorem 1. Corollary 7. Let = [X, d, µ] have law PSphere. Conditionally given X, let x0, x1 be two independent random points in with law µ. Let = ϕ(X2, 1), where X2 = [X, d, µ, x0, x1]. Then, almost surely, R(W+) = and ψ(W+) = ψ(W) = X2. Moreover, if σ {+, } is itself random, independent of X2, and uniformly distributed, then Wσ has law PSnake."
        },
        {
            "title": "3.3 The role of the measure",
            "content": "Finally, let us discuss the role of the area measure µ. As shown by Le Gall [15], this measure is almost surely determined by the metric structure, in the following sense. Fix the gauge function H(r) = r4 log log(1/r). Then there exists constant (0, ) such that PSnake(dh)-a.s., µh is equal to times the H-Hausdorff measure on the space (Xh, dh). Hence the mapping [X, d, µ] (cid:55) [X, d] from the GromovHausdorffProkhorov space mM to the GromovHausdorff space is injective on Borel set of full measure. Therefore, by the LusinSouslin theorem (already mentioned in Section 3 above), there exists Borel mapping χ : mM such that χ([X, d]) = [X, d, µ], and Sphere is the law of the unmeasured space [Xh, dh] under PSnake(dh). Given these observations, it is possible to state version of Corollary 7, with PSphere replaced by Sphere. We omit the details. Sphere(d[X, d])-a.s., where 3Strictly speaking, this discussion is not completely accurate since we are working with isometry classes of spaces, and not with fixed space. more precise statement would be in terms of Markov kernels mM mM2; see [18, Section 6.5]. However, for ease of exposition, we will use to this slightly informal formulation."
        },
        {
            "title": "4 Proof of Theorem 4",
            "content": "h and ϵh. Recall that, by virtue of the LusinSouslin theorem, it suffices to prove that, for PSnake-a.e. = (f, g) S, the functions and can be expressed as function of X2 From now on, we let = (e, Z) be random variable with law PSnake defined on some probability space, and our goal is to show that is determined by X2 , ϵW on set of full probability. We prove this by following the steps listed in Section 1.1."
        },
        {
            "title": "4.1 The two intertwined trees\nIf (T , d) is an R-tree and x ∈ T , we let degT (x) ∈ {1, 2, . . .} ∪ {∞} be the\nnumber of connected components of T \\ {x}. The sets",
            "content": "Leaf(T ) = {x : degT (x) = 1} and Skel(T ) = Leaf(T ) are called the set of leaves and the skeleton of . We will use the well-known fact that if : [0, 1] is continuous function with (0) = (1) = 0, then the points of Skel(Tf ) are exactly those which have at least two preimages in [0, 1) under pf . Our proof of Theorem 4 will depend great deal on the fact that the images of the trees Skel(Te) and Skel(TZ) under the projections pe and pZ are geometric loci in the Brownian sphere. Namely, almost surely, the first one is the cut locus of (XW , dW ) with respect to the point x1 , and the second is the set of relative interiors of geodesics towards x1 . These properties are already known, and summarized as follows. Lemma 8. The following properties hold almost surely. (ii) The set CW is the cut locus of (XW , dW ) with respect to x1 (i) The restrictions of pe and pZ to Skel(Te) and Skel(TZ) are homeomorphisms onto their images, which we denote by CW and ΓW , respectively. , which consists of the points XW such that there exists at least two distinct geodesic paths from to x1 . (iii) The set ΓW (of points inside geodesics to x1 ) consists of the points XW such that there exists geodesic segment in (XW , dW ) that contains x, and whose extremities are x1 and some other point = x. (iv) It holds that CW ΓW = , and moreover, for every XW ΓW (resp. XW CW ), has unique preimage under pe (resp. pZ). For convenience, let us also define See Figure 1 for an illustration of the above results. (cid:101)XW = XW (CW ΓW ). Proof. Points (i)(iii) are proved in [13, Proposition 3.1] and [20, Theorem 6.3.3]. More precisely, it holds that the geodesic segments to x1 in (XW , dW ) are exactly of the form pZ([[ρZ, a]]Z), where TZ, which are called the simple geodesics in [13], and one has dW (x1 , pZ(a)) = dZ(ρZ, a). Point (iv) is consequence of [12, Theorem 3.4] and [16, Lemma 3.2]. Let us give bit more details on this last point. The two aforementioned results can be reformulated as follows: for every = in (0, 1), one has dW (s, t) = 0 if and only if de(s, t) = 0 or dZ(s, t) = 0, these two possibilities being mutually exclusive, and, given the characterization of Skel(Tf ) recalled at the beginning of this subsection, this implies directly that CW ΓW = . Moreover, if = are elements of Te such that pe(a) = pe(b) = x, then we can find = [0, 1) such that pe(s) = a, pe(t) = b. Then it holds that dW (s, t) = 0, but de(s, t) > 0, which implies that dZ(s, t) = 0, meaning that ΓW . The argument is completely symmetric and can be applied to give the last property."
        },
        {
            "title": "4.2 Recovering the tree branches",
            "content": "Working on the almost sure event that the properties of Lemma 8 hold, one can define distinguished simple paths in the Brownian sphere. For x, XW ΓW , we let CW (x, y) = pe([[p1 (x), p1 (y)]]e). Likewise, for x, XW CW , we define ΓW (x, y) = pZ([[p (x), p1 (y)]]Z) . Note that CW (x, y) and ΓW (x, y) are simple curves in XW , by Lemma 8(i). Lemma 9. Almost surely, it holds that: (i) For every x, XW CW , the two geodesics from and to x1 , meet for the first time at some point ΓW . The set ΓW (x, y) is the union of the geodesic segment from to and the geodesic segment from to z, and dZ(p1 (x), p1 (y)) = dW (x, z) + dW (y, z). (8) 16 Figure 1: Some branches of the tree ΓW of relative interiors of geodesics toward x1 are represented in blue, and part of the the cut locus CW is represented in red. The two distinguished points x0 are almost surely not in ΓW CW , and we have represented two more points x, outside this set. and x1 (ii) For every x, XW ΓW , the set CW (x, y){x, y} CW is the set of points such that there exist two geodesics from to x1 that separate and (meaning that the points and lie in different connected components of the complement of the geodesics). This lemma is illustrated in Figure 2. Proof. The first point (i) is proved in [19, Lemmas 4 and 5], but we recall the main ideas. We use the fact that ΓW (x, x1 ) is geodesic path in (XW , dW ), isometric to the segment [[p1 (x), ρZ]]Z in (TZ, dZ). The fact that TZ is an R-tree shows that the paths ΓW (x, x1 ) coincide on maximal final segment of the form ΓW (z, x1 (y)) = dZ(p1 (x), W ) and ΓW (y, x1 ). Moreover, one has (z)) + dZ(p1 (x), p1 = dW (x, z) + dW (y, z). (y), p1 dZ(p1 (z)) For the second point (ii), we first observe that if / CW (x, y) {x, y}, then the continuous path CW (x, y) connects and without intersecting Figure 2: From the points x, (cid:101)XW , there is unique geodesic pointing towards x1 , which allows to identify ΓW (x, y), represented by the thick dark blue line. The curve CW (x, y), represented by the thick dark red line, consists of points from which we can find (at least) two geodesics pointing towards x1 that separate from y. One of these points, called z, is highlighted together with the two relevant geodesics. (x) and = p1 (except possibly at its extremities) nor ΓW because of Lemma 8(iv). In particular, the geodesics from do not disconnect from y. Conversely, let CW (x, y) {x, y}, and let = p1 (y). Note that = p1 (z), being an element of Skel(Te), splits the latter into two or three connected components. Let us assume for simplicity that we are in the first case (the case of three components can be treated similarly). This means that there exist exactly two times = (0, 1) such that pe(u) = pe(u) = c. Our goal is to show that the union of the two geodesic segments pZ([[pZ(u), ρZ]]Z) and pZ([[pZ(u), ρZ]]Z) from to x1 in (XW , dW ) separates from y. Note that these two paths form lollipop shape: they both start from z, remain disjoint in neighborhood of z, and then merge into final common segment, and consequently, they indeed separate XW into two connected components. In order to show that and do not belong to the same connected component, we consider continuous path α : [0, 1] XW from to y, and aim to show that α intersects the union of geodesics from to x1 in (XW , dW ). Let us call Te(a) (resp. Te(b)) the component of Te {c} containing (resp. b). Let r0 = inf{r [0, 1] : p1 (α(r)) Te(b)}. Then there exist sequences (rn), (r n) that are respectively non-decreasing and non-increasing with limit r0 (α(rn)) Te(a) and p1 such that p1 (α(r n)) Te(b) for every n, and up to extracting subsequence, we may assume that the latter sequences converge to Te(a) {c} and Te(b) {c}, such that pe(a) = pe(b) = α(r0). If α(r0) = z, then we obtain the desired conclusion. Otherwise, we have Te(a) and Te(b), and this implies the existence of s, [0, 1] such that pe(s) = and pe(t) = b, and dW (s, t) = 0 (since and both project to α(r0) via pe). We know that this implies that de(s, t) = 0 or dZ(s, t) = 0, but the first case is excluded since = b. This means that Zs = Zt = min[s,t] or Zs = Zt = min[t,s] Z, depending on which of the minima is the largest one (recalling the notation for cyclic intervals from Section 2.1.1). Since is on the path of Te from to b, it must hold that one of or is in [s, t], and the other one is in [t, s]. This implies that pW (s) = pW (t) is on the simple geodesic from or from u, as desired."
        },
        {
            "title": "4.3 Orienting the sphere and recovering Z",
            "content": "W , x1 , x1 In this section, we explain how one can recover the process from (X2 , ϵW ). Recall that, a.s., x0 (cid:101)XW . The preceding lemma allows to describe CW , ΓW , (cid:101)XW , and the segments CW (x, y) and ΓW (x, y) for x, (cid:101)XW , in terms of (XW , dW , µW , x0 ), in way that is invariant with respect to isometries. That is, if we select an element (X, d, µ, x0, x1) in the isometry class X2 , then we can define sets C, Γ, (cid:101)X, and C(x, y) and Γ(x, y) for every x, (cid:101)X, in such way that measure-preserving isometry from (XW , dW , µW , x0 ) to (X, d, µ, x0, x1) sends CW to C, ΓW to Γ, etc. This will be crucial in our main proof. Lemma 10. Almost surely, for every (cid:101)XW {x0 CW (x0 and pW ([p1 rates. Proof. Let (cid:101)XW and = p1 (x). Observe that the two closed simple curves CW (x0 ) intersect only at their extremities, since CW ΓW = and x0 (cid:101)XW . As consequence, their union γ(x) forms simple loop separating two disks in XW . Furthermore, the sets pW ([0, s]) and pW ([s, 1]) are compact and connected, with union XW . Therefore, it suffices to show that their boundary is γ(x). }, the curve γ(x) = (x)]) (x), 1]) are the closures of the two Jordan domains that it sepaW ) is closed, simple loop in XW , and pW ([0, p1 , x) and ΓW (x, W , x) ΓW (x, x0 , x1 To this end, we proceed similarly to the proof of Lemma 9. We let α : [0, 1] XW be continuous path with α(0) pW ([0, s]) γ(x) and 19 Figure 3: The curve γ(x) is illustrated in thick lines, and the domain Dx = pW ([0, p1 (x)]) is the gray area. If we choose to orient the curve γ(x) by first following CW (x0 to x, then the Brownian sphere is canonically oriented in such way that Dx is circled counterclockwise by γ(x), for any choice of (cid:101)XW {x0 , x) from W }. α(1) pW ([s, 1]) γ(x), and we aim to prove that α intersects γ(x). Let r0 = inf{r [0, 1] : α(r) pW ([s, 1])}. Then, by compactness, there must exist [0, s] and [s, 1] such that pW (s) = pW (t) = α(r0). If or equals s, then this means that α(r0) = and we are done. Otherwise, we know that either de(s, t) = 0 or dZ(s, t) = 0. In the first case, we deduce α(r0) CW (x0 ), which concludes the proof. , x), and in the second case, α(r0) ΓW (x, x0 For given (cid:101)XW {x0 that the loop γ(x), oriented by following the segment CW (x0 and ΓW (x, x0 }, we may choose the orientation of XW such , x) from x0 to , goes around pW ([0, p1 (x)]) counterclockwise. We claim that this choice of orientation is independent of x. To see this, ) from to x0 note that if p1 (x) < p1 (x), we have that pW ([0, p1 (x)]) pW ([0, W (x)]), and that the paths CW (x0 and similarly for ΓW (x, x0 (x) < p1 p1 , x) and CW (x0 ) and ΓW (x, x0 , x) have nontrivial intersection, ). The argument is similar if (x). See Figure 3 for an illustration of the above discussion. This being said, we cannot priori distinguish the two regions only from . This is where the sign variable ϵW defined at (3) comes the isometry class X2 20 ), the region circled counterclockwise by γ(x1 into play. In order to make this specific choice of orientation, we take = x1 as reference point, and decide that, among the two regions separated by γ(x1 ) is the one of smallest µW -measure if ϵW = 1, or the one of largest µW -measure if ϵW = 1. There is an ambiguity when both regions have the same measure, but this happens with probability 0 since = s(W ) is uniform random variable in [0, 1]. In this way, we see that it is indeed possible to identify the region pW ([0, s]), and hence, the canonical orientation of XW . , x) ΓW (x, x0 Once this orientation choice is made, we can finally recover the process as follows. For each (cid:101)XW , we define Dx to be the disk in XW bounded by CW (x0 ), and such that the loop γ(x) goes around Dx in counterclockwise order, for the canonical orientation. From the above discussion, it holds that Dx = pW ([0, p1 (x)]), and therefore, we see that we can identify W (x) purely in metric-measure terms, as follows. Corollary 11. Almost surely, it holds that (cid:101)XW , p1 (x) = µW (Dx). We have thereby identified p1 and the restriction of to W ( (cid:101)XW ), the restriction of pW to p1 ( (cid:101)XW ), using (8) and the observation that ( (cid:101)XW ), Zs Zs(W ) = dZ(p1 (pW (s)), p1 (x1 )) , p1 ( (cid:101)XW ). The functions pW and can then be extended by continuity to [0, 1]. We conclude this section by noting, as stressed in the previous section, that our constructions are invariant with respect to isometries. That is, applying them to any choice of element in the isometry class X2 produces the same function Z."
        },
        {
            "title": "4.4 Recovering e",
            "content": "It remains to determine on [0, 1], which requires slightly different argument since there is no formula similar to (8) for expressing the distance de directly in terms of [XW , dW ]. As noted, the idea here is that encodes known continuum tree, and we are also provided with the values of the Brownian snake parametrized by that tree. Thus in order to recover we just need to know the length of paths in the tree. These can be deduced from the 21 Brownian snake by measuring its quadratic variation. See Lemma 12 for this last step. We proceed to make this precise. First, we note that it suffices to determine on [0, 1], as can then be extended to [0, 1] by continuity. Observe that pW (Q [0, 1]) (cid:101)XW , almost surely4. Consider the function ℓ on XW defined by ℓ(x) = dW (x, x1 ) dW (x , x1 ). Fix [0, 1], and let βq(r) = sup{t : et = r} for 0 eq. Then pe βq is isometric with image [[ρe, pe(q)]]e in (Te, de), so that pW βq is natural parametrization of CW (x0 , pW (q)) by [0, eq]. By the defining properties of (e, Z) and formula (8), the mapping B(q) = ℓ pW βq is standard Brownian motion with duration eq, conditionally on e. Since we do not know priori from (X2 , ϵW ), we do not have direct access to βq. However, if αq is any parametrization of CW (x0 , pW (q)) (by [0, 1], say), then ℓ αq is time-change of this Brownian motion. This means that (X2 , ϵW ) determines B(q) up to reparametrization, for every [0, 1]. Lemma 12. Let = (Bt, 0) be standard Brownian motion. Then, almost surely, the following property holds. For every increasing continuous function κ : [0, 1] R+ with κ(0) = 0, it is possible to compute κ(1) as function of (Bκ(u), 0 1). Proof. Consider the number of steps made by (Bκ(u), 0 1) on the sub-lattice εZ, multiply by ε2, and then take limit. From this observation, we deduce that almost surely, (eq, [0, 1]) and ϵW . Finally, we conclude , rather than can be recovered from the isometry class X2 that = (e, Z) is function of ϵW and the isometry class X2 of some particular representative. This completes the proof. 4There is small subtlety here: the information given by the dense set pW (Q [0, 1]) is not obviously invariant under isometries. The reason why this indeed holds is that we have identified the parametrization by [0, 1] (i.e., the measure and order structure) in the previous subsection, so we can define the point visited at time by pW in purely measure-metric terms."
        },
        {
            "title": "References",
            "content": "1. D. Aldous. The continuum random tree. I. Ann. Probab., 19(1):128, 1991. 2. D. Aldous. The continuum random tree. II. An overview. In Stochastic analysis (Durham, 1990), volume 167 of London Math. Soc. Lecture Note Ser., pages 2370. Cambridge Univ. Press, Cambridge, 1991. 3. D. Aldous. The continuum random tree. III. Ann. Probab., 21(1):248289, 1993. 4. E. Baur, G. Miermont, and G. Ray. Classification of scaling limits of uniform quadrangulations with boundary. Ann. Probab., 47(6):3397 3477, 2019. 5. J. Bettinelli and G. Miermont. Compact Brownian surfaces II. Orientable surfaces. Available at arXiv:2212.12511. 6. J. Bettinelli and G. Miermont. Compact Brownian surfaces I: Brownian disks. Probab. Theory Related Fields, 167(3-4):555614, 2017. 7. L. Chaumont and G. Uribe Bravo. Shifting processes with cyclically exchangeable increments at random. In XI Symposium on Probability and Stochastic Processes, volume 69 of Progr. Probab., pages 101117. Birkhäuser/Springer, Cham, 2015. 8. R. Cori and B. Vauquelin. Planar maps are well labeled trees. Canadian J. Math., 33(5):10231042, 1981. 9. N. Curien and J.-F. Le Gall. The Brownian plane. J. Theoret. Probab., 27(4):12491291, 2014. 10. A. S. Kechris. Classical descriptive set theory, volume 156 of Graduate Texts in Mathematics. Springer-Verlag, New York, 1995. 11. J.-F. Le Gall. class of path-valued Markov processes and its applications to superprocesses. Probab. Theory Related Fields, 95(1):2546, 1993. 12. J.-F. Le Gall. The topological structure of scaling limits of large planar maps. Invent. Math., 169(3):621670, 2007. 23 13. J.-F. Le Gall. Geodesics in large planar maps and in the Brownian map. Acta Math., 205(2):287360, 2010. 14. J.-F. Le Gall. Uniqueness and universality of the Brownian map. Ann. Probab., 41(4):28802960, 2013. 15. J.-F. Le Gall. The volume measure of the Brownian sphere is Hausdorff measure. Electron. J. Probab., 27:Paper No. 113, 28, 2022. 16. J.-F. Le Gall and F. Paulin. Scaling limits of bipartite planar maps are homeomorphic to the 2-sphere. Geom. Funct. Anal., 18(3):893918, 2008. 17. J.-F. Le Gall and M. Weill. Conditioned Brownian trees. Ann. Inst. H. Poincaré Probab. Statist., 42(4):455489, 2006. 18. G. Miermont. Tessellations of random maps of arbitrary genus. Ann. Sci. Éc. Norm. Supér. (4), 42(5):725781, 2009. 19. G. Miermont. The Brownian map is the scaling limit of uniform random plane quadrangulations. Acta Math., 210(2):319401, 2013. 20. G. Miermont. Lecture notes of the Saint-Flour Summer School 2014, available at http://perso.enslyon.fr/gregory.miermont/coursSaint-Flour.pdf, 2014. random maps. Aspects of 21. J. Miller and S. Sheffield. Liouville quantum gravity and the Brownian map I: the QLE(8/3, 0) metric. Invent. Math., 219(1):75152, 2020. 22. J. Miller and S. Sheffield. Liouville quantum gravity and the Brownian map II: Geodesics and continuity of the embedding. Ann. Probab., 49(6):27322829, 2021. 23. J. Miller and S. Sheffield. Liouville quantum gravity and the Brownian map III: the conformal structure is determined. Probab. Theory Related Fields, 179(3-4):11831211, 2021. 24. G. Schaeffer. Conjugaison darbres et cartes combinatoires aléatoires. PhD thesis, Université Bordeaux I, 1998."
        }
    ],
    "affiliations": [
        "Institut Universitaire de France",
        "University of British Columbia, Department of Mathematics",
        "University of Warwick, Department of Statistics",
        "École Normale Supérieure de Lyon, Unité de Mathématiques Pures et Appliquées"
    ]
}