{
    "paper_title": "WAY: Estimation of Vessel Destination in Worldwide AIS Trajectory",
    "authors": [
        "Jin Sob Kim",
        "Hyun Joon Park",
        "Wooseok Shin",
        "Dongil Park",
        "Sung Won Han"
    ],
    "sections": [
        {
            "title": "Abstract",
            "content": "The Automatic Identification System (AIS) enables data-driven maritime surveillance but suffers from reliability issues and irregular intervals. We address vessel destination estimation using global-scope AIS data by proposing a differentiated approach that recasts long port-to-port trajectories as a nested sequence structure. Using spatial grids, this method mitigates spatio-temporal bias while preserving detailed resolution. We introduce a novel deep learning architecture, WAY, designed to process these reformulated trajectories for long-term destination estimation days to weeks in advance. WAY comprises a trajectory representation layer and Channel-Aggregative Sequential Processing (CASP) blocks. The representation layer generates multi-channel vector sequences from kinematic and non-kinematic features. CASP blocks utilize multi-headed channel- and self-attention for aggregation and sequential information delivery. Additionally, we propose a task-specialized Gradient Dropout (GD) technique to enable many-to-many training on single labels, preventing biased feedback surges by stochastically blocking gradient flow based on sample length. Experiments on 5-year AIS data demonstrate WAY's superiority over conventional spatial grid-based approaches regardless of trajectory progression. Results further confirm that adopting GD leads to performance gains. Finally, we explore WAY's potential for real-world application through multitask learning for ETA estimation."
        },
        {
            "title": "Start",
            "content": "5 2 0 2 5 1 ] . [ 1 0 9 1 3 1 . 2 1 5 2 : r WAY: Estimation of Vessel Destination in Worldwide AIS Trajectory JIN SOB KIM HYUN JOON PARK WOOSEOK SHIN Korea University, Seoul 02841, Republic of Korea DONGIL PARK SeaVantage, Seoul 06119, Republic of Korea SUNG WON HAN Korea University, Seoul 02841, Republic of Korea Abstract The Automatic Identification System (AIS) has recorded near-real-time vessel monitoring data over the years, paving the way for data-driven maritime surveillance methods; concurrently, the data suffer from unrefined, reliability issues and irregular intervals. In this paper, we address the problem of vessel destination estimation by exploiting the global-scope AIS data. We propose differentiated data-driven approach recasting long sequence of port-to-port international vessel trajectories as nested sequence structure. Based on spatial grids, this approach mitigates the spatio-temporal bias of AIS data while preserving the detailed resolution of the original. Further, we propose novel deep learning architecture (WAY) that is designed to effectively process the reformulated trajectory and perform the long-term estimation of the vessel destination ahead of arrival with horizon of days to weeks. WAY comprises trajectory representation layer and channel-aggregative sequential processing (CASP) blocks. The representation layer produces the multi-channel vector sequence output based on each kinematic and non-kinematic feature collected from AIS data. Then CASP blocks include multi-headed channeland self-attention architectures, where each processes aggregation information delivery respectively. Then, taskand sequential specialized learning technique, Gradient Dropout (GD), is also suggested for adopting many-to-many training along the trajectory progression on single labels. The technique prevents surge of biased feedback by blocking the gradient flow stochastically using the condition depending on the length of training samples. Experimental results on 5-year accumulated AIS data demonstrated the superiority of WAY with recasting AIS trajectory compared to conventional spatial grid-based approaches, regardless of the trajectory progression steps. Moreover, the data proved that adopting GD This research was supported by Brain Korea 21 FOUR. This research was also supported by Korea Institute for Advancement of Technology(KIAT) grant funded by the Korea Government(MOTIE) (P0008691, The Competency Development Program for Industry Specialist). (Corresponding author: Sung Won Han). Jin Sob Kim, Hyun Joon Park, Wooseok Shin, and Sung Won Han are with the School of Industrial and Management Engineering, Korea University, Seoul 02841, Republic of Korea (e-mail: jinsob, winddori2002, wsshin95, swhan; @korea.ac.kr). Dongil Park is with SeaVantage, Seoul 06120, Republic of Korea (e-mail: dipark@seavantage.com). 0018-9251 2023 IEEE in spatial grid-based approach leads to the performance gain. In addition, the possibilities of improvement and real-world application with WAYs expandability in multitask learning for the estimation of ETA was explored. Index Terms AIS data, annotation pipeline, vessel destination estimation, deep-learning model, channel attention, transformer. I."
        },
        {
            "title": "INTRODUCTION",
            "content": "SEA routes are the largest market for international goods freight, with the United Nations (UN) stating that more than 80% of the volume of international trade is carried by ship transportation [1]. To secure both the safety and cost efficiency of vessel operations, shipping technologies and infrastructure have made progress toward the advancement of maritime surveillance. For example, the Automatic Identification System (AIS), self-reporting messaging system established on vessel, is mandatory for international voyages and provides near-real-time surveillance data [2]. The vast amount of accumulated AIS data opened up possibilities for data-driven analysis of marine traffic patterns, with many recent studies [3] [13] conducted to solve diverse optimization problems in vessel operations. As an optimization issue, the port congestion problem has arisen in terms of efficient transportation management. According to the UN, shortages in port capacities, unreliable schedules, and port congestion, in contrast to the annual growth of international maritime trade keep vessels waiting and have led to surge in surcharges and fees [1]. Knowing the destinations of ongoing ships with an accurate Estimated Time of Arrival (ETA) to ports is the key to resolving these congestion issues in advance. AIS data originally contain information on destinations and ETA written by human resources for each data collection. However, these reports are unstructured, with unpredictable errors included in the data itself and irregular intervals between each observation, which causes lack of reliability and challenges the investigation of international marine traffic analysis. Even so, the AIS has recorded tremendous amount of data since its establishment and contains significant maritime trajectory contexts. Consequently, large-scale global AIS data rather have been availed the maritime traffic/route analyses and the derivation of nationwide maritime insights [14], [15], than exploited in the studies to track single maritime object. Meanwhile, for securing safety and auto-navigating systems, many studies [6][13] proposed several advanced data-driven methods to track ongoing vessels at sea and predict their future paths. However, these studies were constrained to the Region of Interest (ROI), which is an inevitable condition regarding the sequential length of intercontinental trajectories and to eliminate concerns for unrefined data. To fulfill the lack of motivation and exploit the AIS data out of the ROI constraint, this study introduces recasting the former data-driven approaches of AIS trajectory sequence representation. Based on the premise that IEEE TRANSACTIONS ON AEROSPACE AND ELECTRONIC SYSTEMS VOL. XX, No. XX XXXXXXX 2023 2023 IEEE. Personal use of this material is permitted. Permission from IEEE must be obtained for all other republication or redistribution. the start and end of the AIS trajectory are known to be tuple of ports, the departure and the destination, the objective of probability maximization is defined. Thus, to make the premise satisfied, the annotation framework for extracting meaningful segments from the raw AIS sequence is introduced. Therefore, the verified trajectories comprise AIS messages sharing the same context from departure to destination, underlying the analysis of portto-port instances. Exploiting the annotated trajectory, the deep learning architecture (WAY) is proposed to meet the formularization of nested sequence structure from the portto-port AIS trajectory. To address the problem covering the entire marine region without ROIs, this study further explores the design of the deep learning architecture fitting the diverse properties of AIS data that are multivariate sequences with irregular intervals and non-sequential features. The proposed model, WAY, adopts spatial grid division approach while encompassing the details of the trajectories in 4-channel vector sequence representation. The model utilizes channel attention mechanism to aggregate the representations at each sequential step and adopts the Transformer-decoder architecture to convey information toward the current step from the past. In addition, the task-specialized learning technique, Gradient Dropout, is suggested to temper the surge of feedback bias over the length of individual sequences where the bias occurs due to many-to-many learning for fixed single destination target according to the trajectory progression. The remainder of this paper is organized as follows. Sec. II provides an overview of prior approaches that have dealt with the refinement of AIS data and the related studies in the field that adopted deep learning methods to process such sequential information. Sec. III formulates the problem of destination port estimation given AIS trajectories and the training procedure of the datadriven approach. Sec. IV presents the details of WAY and applied methods in delivering the long-range estimation. Sec. demonstrates the leading edge of performance achieved by the proposed method compared to the other related models based on experiments. Future studies and conclusions are discussed in Sec. VI and Sec. VII. II. RELATED WORK Since AIS messages were first recorded in 2002 [2], tremendous amount of data has been collected, which contain wealth of information on international voyages. Currently, the potential of intelligent techniques is in the spotlight, as the affordability of data acquisition increases with advances in storage and processing infrastructure. By exploiting analyses of massive AIS data, these techniques are expected to enhance or replace conventional Maritime like manual Domain Awareness (MDA) applications, monitoring of traffic patterns at sea, while reducing costs [16][18]. MDA appliances, or the awareness of maritime activities in general [16], have been investigated in recent studies on AIS data with regard to the problem of anomaly detection, route estimation, collision prediction and path planning, amongst others [18]. Indeed, the massively accumulated AIS data, continuously collected even today, through large-scale maritime has proven its potential analyses deriving various insights across the globe [15] as well as modeling worldwide maritime routes [14]. However, there are still challenges in applying AIS data to real-world navigation owing to the quality, validity, and accuracy of the data [17][19]. These challenges arise from errors included in the data, such as the spacetemporal mislocation of vessels, missing values, and contextual misinformation. These are not only caused by machines as sensor/transmission failure, but also by human mistakes such as unstructured/misspelled/unfilled data [20][23]. Many state-of-the-art maritime intelligence methods make an effort to overcome these challenges by either preprocessing raw AIS data or considering identification and refinement of the errors as problem to be addressed. This section provides review of related studies regarding methods dealing with AIS data from two perspectives: analyses to extract meaningful context from noisy AIS data, and the former approaches conducted to predict the future location from AIS trajectories. Cleansing and context extraction of AIS data. Vesselidentifying messages are continuously and autonomously transmitted over the AIS system and contain static identification, dynamic position, and future-route indicative in the data provided information. On the other hand, from recordings, one out of 14 messages includes incorrect/missing identification according to study that investigated the reliability of AIS data [20]. Hence, the data need to be refined and contextual mining process should be performed before the analysis. The simplest and most often suggested processing methods were rule-based methods to eliminate errors from raw observations. Regardless of the task objectives, many AIS-relevant prior studies [7], [9][12], [24][26] set up boundaries, such as the aforementioned ROI, upon realvalued fields as longitude, latitude, Speed over Ground (SOG), or Course over Ground (COG), to filter noise. The thresholds are set based on either the area of interest, domain knowledge, signal protocol from the AIS system, or considering all of them. Some priors combined the filtering process with algorithmic methods to deal with the logical integrity of trajectories and improved AIS data quality [22], [23], [26]. In addition, interpolation of longitudes and latitudes was widely used for preprocessing while handling irregular time-series data [8][10]. Others attempted to detect outliers using statistical approaches and extract the context from the trajectory sequence. These approaches contributed not only to preprocessing, such as the interpolative substitution of SOG, along with the detection of abnormal velocity peaks, but also to capturing and classifying the behavior of ships. Clustering-based models were commonly adopted to describe positional anomalies based on time and space 2 IEEE TRANSACTIONS ON AEROSPACE AND ELECTRONIC SYSTEMS VOL. XX, No. XX XXXXXXX perspectives and to discover traffic patterns and meaningful segments of trajectories [9], [14], [27], [28]. AIS trajectory forecasting. Defined to predict anticipated future locations given the incomplete trajectory of moving object, the mobility prediction problem has been considered an important concern for decades in various transport-relevant domains, including urban, maritime, and aviation [29]. Formula-based predictions, which rely on motion functions from physics, were one of the earliest approaches in the field [30]. The constant velocity model, which is one of the well-known linear models in the maritime domain based on the mathematical formula, keeps the SOG and COG constant throughout the prediction [31]. The control models were investigated in previous studies that adopted more complex motion formula. The extended Kalman filter and OrnsteinUlenbeck (OU) process were employed to track and model vessel dynamic motions at sea [4], [32]. As one of the linear and the non-linear models respectively, these methods are straightforward, simple, and have strength in the robustness of input data quality. Among the above, in the maritime domain, OU process model based on meanreverting stochastic processes was adopted to perform long-term prediction of vessel movement over hours in the domain [33]. Recent studies built models based on the history of movements in certain regions by exploiting patterns over the past trajectory of objects. These data-driven techniques consider not only the movement captured from the target of interest but also of the other observed objects moving in the same area (or the historical movements of the target in the area) [29]. Probabilistic approaches based on bridging distributions were proposed, where Bayesian theory was exploited to estimate the probability of endpoints and to infer the intended destination including the future paths from given vessel trajectories, respectively [34], [35]. Further, upon the success of deep learning architectures in sequential processing lately, many researchers have conducted studies using deep learning models for AIS data [6][13]. Representative structures of sequential processing deep neural networks, Recurrent Neural Networks (RNNs) [36], [37], Long Short-Term Memory (LSTM) [38], and Sequence-to-sequence [39] architectures were adopted to capture traffic patterns and estimate the future locations of vessels. An RNN was proposed to compute the association probability of new AIS message and an existing track [9]. Embedding block of variational RNN encoders was introduced to learn hidden regimes from maritime surveillance tasks [7]. The bidirectional LSTM was trained over coordinates to predict the behavior of ships online [6]. Given past AIS trajectory data, an encoderdecoder architecture comprising LSTM generated predictive coordinate sequence [8], [9]. Sequence-to-sequence model approach to maritime trajectory prediction was discussed in [9], which investigated the intermediate aggregation layer. Processing trajectories for each AIS message step [6] [10] has clear limitations in handling global AIS trajectories because of the time-spatial bias within observations that occur from irregular intervals. Given this bias, many studies either sampled messages in fixed duration or exploited the linear interpolation of coordinates between the received messages to obtain the trajectory of regular steps [7][10]. However, these methods are difficult to apply to long-range intercontinental trajectories. Thus, it is not feasible to model the data in such way, given the number of AIS messages received, which is not related to the physical voyage distance, along with the extreme variances in both length distributions. Other studies proposed an approach using token representation that defines vessel positions into uniformly divided grid area rather than real-valued coordinates [11] [13]. This approach availed Sequence-to-sequence models to be trained on vessel trajectory as text sentence and to estimate future path and destination port, as represented by sequence of tokens [13]. One attempted to tokenize not only longitude and latitude but also the SOG and COG, and adopted Transformerdecoder [40] to deal with AIS trajectory forecasting [12]. Based on spatial grid tokens, the bias from irregular intervals can be mitigated by unifying observations within the same spatial area into single representation [13]. However, the drawback of tokenization is that the approach requires the models to learn the spatial correlation from the bottom, where the correlation can be clearly defined physically by the coordinates. In addition, by unifying the representation from multiple observations, it is clear that the larger the sampling grid, the more details are lost. By contrast, shrinking the size of the unit space results in the exponential increment of the parameters to learn. In addition to the tradeoff, it is difficult to specify whether the approach can consider irregular intervals of AIS trajectories because they are not spatial-continuously connected, even in tokenized representations. In summary, the studies, related to forecast/estimating the future vessel position using AIS trajectory data so far [6][13], have been constrained under ROI. The constraint should be broken to consider the global scope of analysis, and modeling the port-to-port trajectory at sea should consider various features given real-world AIS data, rather than only regarding kinetic information, which is primarily focused on real-valued coordinates. Finally, this article proposes novel deep-learning approach for the task, estimation of the port destination given the vessel operation trajectory from its departure, exploiting the worldwide AIS data. The contribution of this work focuses on the followings:"
        },
        {
            "title": "Contribution",
            "content": "Recasting data-driven approach of AIS trajectory AIS data have been dealt with as sequence of either message-wise observations or spatial grid representation units. However, neither of them fits to estimate the long-range destination of international vessel operations far ahead days to even few months of the arrival due to each reason; the KIM ET AL.: WAY: ESTIMATION OF VESSEL DESTINATION IN WORLDWIDE AIS TRAJECTORY 3 irregular intervals form spatio-temporal bias and the coarse portrayal loses the details, respectively. This work suggests recasting the problem of global port destination estimation with novel approach based on spatial grids mitigating the spatio-temporal bias while preserving the detailed representation. Establishing novel deep learning architecture This work also includes novel framework that meets with the of deep learning model setup of problem reformulated. the model comprises advanced deep-learning architectures adopting multi-channel representation, multi-headed selfand channelattention techniques. Compared to the conventional methods of vessel trajectory forecasting, the proposed model fully utilizes the given AIS information, not only the kinematic features but also the non-kinetic context such as ship type and departure port, and estimates the port destination. Introducing task-specialized learning technique training to maximize the probability of the target destination given an incomplete trajectory, surge of feedback may occur in the training procedure according to the varying length of vessel motions. Here, taskspecialized learning technique Gradient Dropout prevents the model to be biased in such many-to-many learning process by stochastically suppressing the surge depending on the length of training samples."
        },
        {
            "title": "As the problem leads the model",
            "content": "Comparing different deep learning methods The proposed method is compared to the conventional spatial grid-based approach with different deep learning benchmark algorithms. Performing the destination estimation task, the experiment shows the robustness of the proposed model dealing with reformulated representation against the other prior approaches. In addition, further experiment depicts interthe model channel processing methods, and efficiency. in terms of feature availability, III. PROBLEM DEFINITION In this section, the problem of port destination estimation is formalized. Assuming any vessel operation proceeds between certain tuple of departure and destination ports, AIS trajectory data can be represented as set of {Pα, Pω, ST }. The symbols α and ω denote the departure and destination among the total set of ports respectively, and ST is the time-ordered sequence of AIS messages received along the space-time progression of the operation. To address the problem of destination estimation ahead of vessel arrival, the objective of learning from data-driven approach is to maximize the conditional probability of the destination port, given the departure and the ordered sequence of AIS messages to the current time t. Given that the preferable condition of worldwide data collection, such as the sequence of uniform intervals thoroughly containing flawless messages, the estimation can be ideally processed by model function with parameter θ. Hence the formulation of the destination estimation of the given trajectory at step t, and the training procedure can be defined as: ˆPω = argmaxPM(x1:t, Pα; θ) 1 ˆθ = argminθ L(M(xi (cid:88) i=1 1:t, α; θ), ω) (2) where the procedure aims to minimize the error of loss function from given training trajectory samples, xi 1:t, ω are the input AIS sequence, departure port, and target destination, correspondingly. α, and However, the formulation is difficult to be directly applied to real-world AIS data for two main reasons. First, real-world AIS data has been collected forming irregular intervals. The properties cause spatio-temporal bias about data existence and affect the training to overfit certain excessively data-populated regions. Second, AIS data itself is the cumulative result of tremendous number of near-real-time records with unverified transmission errors included, while the data is not separately annotated as port-to-port operations. Next two subsections present the mitigation of the issues above. A. Spatial Grid Unit Processing As discussed in Sec. II, prior spatial grid token-based processing approach has been proposed to resolve the spatio-temporal bias issue [13]. Adopting the token-based approach, given SK reconstructs the original sequence ST , the objective formulations can be recast as below: (3) ST SK = {gk; =1, ..., gk (xi, ..., xi+j)} maximize p(Pωg1, ..., gk, Pα) where SK comprises the element gk which is the spatially integrated representation of non-overlapping subset of ST each, that is in continuous time order from to + j. Accordingly, the training and estimation of the model would be recast as below, where the unit step of trajectory processing, gk replaces the xt. ˆPω = argmaxPM(g1:k, Pα; θ) 1 ˆθ = argminθ L(M(gi (cid:88) i=1 1:k, α; θ), ω) (4) On the other side, however, the coarsely represented sequence SK loses the locally detailed navigational pattern information from the original. Resolving the tradeoff, the proposed method in this paper adopts rearranging the original trajectory as nested sequence structure as follows: ST = SK = {Gk = {xi, ..., xi+j; gk}; = 1, ..., K} ST ={xt; = 1, ..., } maximize p(Pωx1, ..., xt, Pα) (1) maximize p(Pωx1, ..., xt, Pα) (5) maximize p(PωG1, ..., Gk,t, Pα) 4 IEEE TRANSACTIONS ON AEROSPACE AND ELECTRONIC SYSTEMS VOL. XX, No. XX XXXXXXX 2023 Fig. 1. Overall annotation processing framework. where Gk encompasses not only the spatial representation of the grid unit gk integrating the continuous subset {xi, ..., xi+j} from the original trajectory ST but also the subset itself. Since, Gk,t, the last given element of SK on the current step = + of the original sequence ST , has state dependency on t, the maximization objective of the conditional probability from the given rearranged trajectory meets that of the original. Finally, the formulation of destination estimation and of the training can be recast as: ˆPω = argmaxPM(G1:k,t, Pα; θ) 1 ˆθ = argminθ L(M(Gi (cid:88) i= 1:k,t, α; θ), ω) (6) where the input sequence Gi 1:k,t comprises an ordered sequence of the non-overlapping subsequences of the original Si and the sequence of spatially integrated unit grid representations respectively. Accordingly, the model can process the trajectory data over unit steps upon the spatially uniform grid without losing the locally detailed information of vessel operations. B. Annotation Framework To meet the needs of the assumption of the data-driven formulation indeed, raw AIS data need to be annotated and refined as set of meaningful segments that the start and end of each vessel operation are defined. The segment, which can be called port-to-port operation, is the trajectory recorded from set of continuous AIS observations that share the same departure and destination. The refinement process is the verification and removal of the error that occurred during given port-to-port trajectory, which causes the illogical shift of vessel movement. In this work, the port identification dataset and the AIS data are coupled to perform the segmentation and refinement of raw AIS data. The segmentation of portto-port trajectory is conducted along the features from the AIS messages received, by exploiting the Damerau Levenshtein distance [41], [42] and port-wise boundary thresholding, where the detailed implementation is described in Appendix A. Afterward, the segmented portto-port trajectories undergo the refinement process with the clustering algorithm DBSCAN, of detecting abnormal shifts. The detail of Implementing DBSCAN as verifying the erroneous transmission is depicted in Appendix B. The overall procedure of the data annotating framework is shown in Fig. 1, which illustrates the refined result of 5-year accumulated AIS data from single vessel. IV. METHODOLOGY This section presents WAY, the architecture for processing AIS data, with novel approach toward global trajectory representations. In addition, Gradient Dropout learning technique is proposed to mitigate the feedback bias issue proportional to the data length while designing many-to-many training framework. This technique is only applied to the training set and detached for inference. The overall framework of the proposed method is illustrated in Fig. 2, where denotes channels, implies the number of grid areas observed, is the hidden dimension size of the model, and indicates the number of layers repeated as stack, and WAY is shown to process the trajectories based on 4-channel vector sequences. A. Trajectory Representation An observed trajectory is processed within each unit area in the WAY architecture. To do so, the raw observations are reconstructed and handled by nature before the main process began. Let us denote x1:T = {x1, . . . , xT } RT as sequence of AIS observations from an ongoing ship at time step , where indicates the number of AIS fields used as features that contain timestamps, longitudes, latitudes, etc. The given sequence can therefore be reorganized using uniform spatial grids to {G1, . . . , GN }, where each grid element Gk = {gk; xk } for {1, . . . , } includes the identity coordinate gk and subset of observations inside xk = {xj+1, . . . , xj+mk } x1:T , and where = (cid:80)k i=1 mi and = (cid:80)N i=1 mi. 1:mk 1:mk Thereafter, samples of ˆmk observations are taken dynamically from xk 1:mk , where ˆmk follow Poisson distribution with the parameter λ = 5. The intention of sampling is to reflect the circumstances under irregular KIM ET AL.: WAY: ESTIMATION OF VESSEL DESTINATION IN WORLDWIDE AIS TRAJECTORY 5 Fig. 2. Overview of WAY architecture. An example of this rearrangement is visualized in Fig. 3, while the longitude, latitude, and timestamp fields included in xk 1:mk are transformed into manner of relativeness to each grid area belonged. Based on each grid center coordinate gk = (λ, ϕ), the observed longitudes and latitudes (λi, ϕi) xk for {1, ..., mk} are converted into (λλi, ϕϕi), and the mk timestamps are converted into mk time distances, measuring the progression in days from the 0 distance for the first sample xk 1. The trajectory contains the non-sequential features as well, acknowledged from the annotation and the ship itself, type Sx, which are the departure port Yx and vessel respectively. Subsequently, input = {G1:N ; Yx; Sx} is handled in the representation layer by each feature component, as described below: the organized model"
        },
        {
            "title": "Description of AIS trajectory components",
            "content": "Unit Area. sequence of center coordinate (λ, ϕ) tuples of the spatial grid from the observed, denoted by {g1, ..., gN } RN (λ,ϕ). Local Pattern. sequence of subsets from the observed; each includes kinetic patterns corresponding to the unit area. The sequence is denoted by } RN f , where denotes {x1 1:mN set of subsequential lengths. , . . . , xN 1:m1 Departure. categorical value of ports Yx N. Ship Type. categorical value of ships Sx N. Time Distance. sequence of time intervals between each last observation in subsets and the very first from the trajectory, denoted by {1, . . . , } RN where = time(xN x1) and the intervals mN are measured in days. Fig. 3. An example of reorganizing AIS trajectory in WAY. The Red arrow indicates the very first observation in given trajectory, and the Blue arrows show the sampled observations defining subsequences from each region. denotes the time distance measured in days. intervals and consider any moment of trajectory progression when and wherever the observation possibly exists in regions. In addition, sampling can moderate the flooding of redundant AIS records generated by such intervals and also by the reason owing to the timing issue between transmission and receiving. Thus, subsequential trajectory xk is redefined by the sampled observations in each Gk. 1:mk ˆmk 6 IEEE TRANSACTIONS ON AEROSPACE AND ELECTRONIC SYSTEMS VOL. XX, No. XX XXXXXXX 2023 Fig. 4. The example output of Spatial Encoding, given sequence of grid coordinates from the above trajectory. 1. Spatial Encoding Inspired by positional encoding from Transformer [40], Spatial Encoding (SE) module is designed to transform real-valued coordinates into high-dimensional vectors. Given an observed sequence of the unit area coordinates RN (λ,ϕ) and hidden size d, the module produces the output vector sequence RN as follows: SE(λ,ϕ,4i) = cos(g(ϕ, 4i)) sin(g(λ, 4i)) SE(λ,ϕ,4i+1) = (log π)2 sin(g(ϕ, 4i)) SE(λ,ϕ,4i+2) = cos(g(ϕ, 4i)) cos(g(λ, 4i)) SE(λ,ϕ,4i+3) = (log π)2 sin(g(ϕ, 4i)) (7) where the function g(q, 4i) = q/(2π)4i/d2 operates with radian unit (λ, ϕ), and specifies the dimension. The combinations of the sinusoidal functions are motivated by the conversion definition of polar to Cartesian coordinate system, and the frequency from the division term of function g(q, 4i) is set to 2π. Therefore, the produced vector comprises the sinusoidal wave of marginally different frequencies, where each 4ith and 4i + 2th dimensions are based on the wavelengths from π to π (2π)1/d, and 4i + 1th and 4i + 3th dimensions corresponds to the wavelengths from 2π to (2π)11/d. Fig. 4 illustrates the actual output of the SE module with = 128, given the sequence of the grid coordinates from the example trajectory. Fig. 5a and Fig. 5b show the scaled distance distributions between the encoded vectors from sets of each longitudeand latitude-wise sampled coordinates, respectively. As the transformed representations have the cyclic distance with the longitudes and represent the diverging distance distribution with the latitudes, the set of outputs from SE module preserves the spatial distance concept of the original coordinates. As result, the encoded vector from each grid coordinate represents its own positional identity on the spherical surface, which can Fig. 5. An example of Spatial Encoding result. (a) indicates the longitude-wise Euclidean distances between encoded vectors, (b) is the distance between vectors arranged in latitudes, and (c) visualizes the 3-dimensional PCA result of encoded vectors Rd from the whole 1 1 (2 ) grids, where the Blue are sampled in (a) and Red as (b). be explained by the dimensionality reduction of Principal Component Analysis (PCA) [43] (see Fig. 5c). 2. Step-wise Gated Recurrent Unit To capture the ships behavioral details and specify local patterns in uniform grid areas, Gated Recurrent Unit (GRU) [44] is used to process each subsequence, which employs the concept of LSTM, updating hidden and cell states via gate functions while using fewer parameters. Given the individual subsequence xk Rmkf , the state update at the current step [1, . . . , mk] is defined by the input xk , sigmoid function σ, update gate ut, and reset gate rt, as follows: + Uuht1 + bu) + Urht1 + br) ut = σ(Wuxk rt = σ(Wrxk ht = tanh(Whxk ht = (1 ut) ht1 + ut ht + (rt ht1)Uh + bh) (8) Batchifying the process among the sequence steps, each input subsequence xk Rmkf yields hmk Rd using the (L/2)-layered GRU stack. Consequently, the set of last hidden states [hm1; . . . ; hmN ] RN represents the sequence of local navigational patterns. 3. Semantic Representations and Time Encoding Objectifying port-to-port trajectory as single antypes contain alytic instance, departure and vessel semantic relationship toward the port destination. That is, international shipments do not occur randomly, but are involved in national trading relations, goods, and needs. Learnable parameters are set for worldwide ports and types of ships such that each lookup table can be described by RY and RSd, respectively. Rd The tables return the vectors of indexed by departure Yx and ship type Sx. Rd and KIM ET AL.: WAY: ESTIMATION OF VESSEL DESTINATION IN WORLDWIDE AIS TRAJECTORY Thereafter, the vectors are sequentialised by adding time information in order. Modifying positional encoding [40], Time Encoding (TE) module generates representations of the temporal progression of given trajectory. Whereas the fixed uniform-discrete offset is given to the original encoding procedure, AIS data comprises the sequence of irregular intervals. Therefore the procedure has to be adjusted to accept real-value offset input , the day-unit time distance, and operate as continuous function. Based on the timestamps of each sampled subsequence as shown in Fig. 3, given the time distances between the last samples and the first observation of whole trajectory, the equation to process input RN can be defined as: (9) TE(,2i) = cos(/10002i/d) TE(,2i+1) = sin(/10002i/d) where specifies the dimension. To sufficiently cover the maximum temporal progression of the vessel operations and consider the adequate intervals within the encoded representations, the frequency of the sinusoidal functions in TE is set to 1000. Subsequently, the TE output is produced as RN d, forming geometric progression in each dimension based on wavelengths from 2π to 1000 2π. The sequence of time-encoded vectors is added to each while duplicating their identical for steps, as well as to the sequence outputs that were defined from Sec. IVA1 and Sec. IVA2 each. Accordingly, the concatenation of such representations yields 4-channel vector sequence RCN d, where = 4. An observed AIS trajectory is time-sequentially depicted by perspectives of global space, local patterns, and semantics in the respective channels. and B. Channel Aggregative Sequence Processing Based on the multi-channel vector sequence output from the representation layer, Channel Aggregative Sequence Processing (CASP) layer is proposed to aggregate each distinct nature of AIS data distributed over channels and convey the sequential information toward the current step of the decision. CASP layer comprises multi-head channel attention (MCA), masked multi-head self-attention (MSA), and shared feed-forward (SFF) network modules responsible for current feature aggregation, sequential processing, and decoding, respectively. 1. Multi-head Channel Attention Channel Attention was first proposed in the Squeezeand-Excitation network [45] in the computer vision domain. This method involves conducting an information comparison among channels and emphasizing each by the compared results. The concept is extended in WAY to multi-perspective comparison by applying an identical set of linear transitions to channels, as shown in Fig. 6. MCA aggregates the current step representations from each channel into single vector comprising accentuated dimensions. From individual steps RCd, the perFig. 6. Multi-head Channel Attention Module. Rddk for [1, . . . , h], spectives are spread via tr where denotes the number of heads and dk is dimensions per head. Thus, the current step RhCdk is given, and the equation of multi-headed attention is as follows: sq (x); FMAX [zavg; zmax] = = [FAVG [z (x)] max] = = max(0, zWsq)Wex avg + αC = σ(z avg; max) sq (10) = αC sq sq avg, is the average pooling function and FAVG where FAVG is the max pooling in terms of dimensions in each channel. The squeezed zavg, zmax RhC is transformed into max RhC using the shared the corresponding parameters Wsq and Wex. The procedures for each head are performed in parallel using Wsq RhCC/γ and Wex RhC/γC, where γ = 2 and ReLU [46] activation is applied to the bottleneck. The attention weight αC RhC emphasizes the channels of the input x, where the sigmoid function σ contracts the sum of the intensities in the range of (0, 1). The emphasized tensor RhCdk are transposed to RC(hdk) by headwise concatenation and then max pooling function is applied over channels, extracting the most highlighted values for each dimension. Thereby 1-channel vector output R(hdk) is provided, and the final result of the module Rd is produced by the linear transition of out R(hdk)d. Considering that aggregation occurs at every step, the sequence output from the MCA module is denoted by RN d. 2. Masked Multi-head Self Attention Originally introduced to address the neural machine translation problem, Transformer [40] has further improved the performance of deep learning approaches in several domains, and this method has been widely used in state-of-the-art studies. The proposed concept of selfattention maximizes the utilization of attention mechanisms [47], [48], capturing long-term correlations in given sequential data. In WAY, the transformer decoder archi8 IEEE TRANSACTIONS ON AEROSPACE AND ELECTRONIC SYSTEMS VOL. XX, No. XX XXXXXXX 2023 tecture is adopted to convey past trajectory representations toward the current step and decode such information into features for destination estimation. With the proceeded output RN from the fore MCA module, MSA delivers the past aggregated information to the present. The multi-headed attention weight αS RhN is defined by the following equations: Qi = xW Vi = xW Ki = xW QK dk αS = softmax(Fmask( )) (11) = αS i , , and where [1, . . . , h] indicates each head, dk denotes the head dimension, and Q, K, and RhN dk are the sets of vectors transformed by Rddk , respectively. Based on the matrix multiplication of and RhdkN , the inter-correlation scores are measured over sequence steps, and the lower triangular matrix filter Fmask is applied to block information flows from future steps. Thus, αS is given, and RhN dk is produced, of which the vectors in are scaled and mixed with the representations from the past. Eventually, the concatenation of the heads RN (hdk) is multiplied by linear transition out R(hdk)d, providing the output sequence RN d. 3. Channel Concatenation and Shared Feed Forward Before applying SFF module procedure, the channelwise concatenation between the original CASP layer input sequence RCN and the output sequence RN from MSA module proceeds. The concatenation, which is more likely to be said to substitute certain channel sequence, is to withdraw one of the channels from the original input and fill the spot with the output of MSA module. Despite the replacement, the altered channel has more enriched information and incorporates the withdrawn identity because of the residual connections that will be described in Sec. IVB4. In this study, the single channel is designated to be repeatedly replaced over the stack of CASP layers in the procedure, that is, the output from SE module. The purpose of the design is to update certain channel by gathering all channel-wise features and sequential information, whereas the others maintain their current step identities. Based on the idea of CSPNet [49], the connection not only relieves the computational burden, but also gives the model the ability to add up representations enriched repeatedly within the stack of CASP layers. Consequently, the concatenated tensor RCN maintains the number of channels C, and SFF module performs linear transformations for each representation in given tensor. The module comprises 2-layered fully connected network W1 Rddf and W2 Rdf with intermediate ReLU activation, as the transition is shared in positions and channels. Accordingly, CASP layer output RCN can be obtained. 4. Residual Connection As shown in Fig. 2, residual connection [50] and layer normalization [51] follow each submodule in CASP layer. The residual connection adds input to the output from the module, which is presented to address the vanishing gradient problem of deep neural network architectures. Layer normalization is used to stabilize the hidden state dynamics in the sequential modeling. As introduced in [40], the same combination is applied to MSA and SFF, where the inputs and outputs of each have identical shapes. However, in the MCA module, where channels are aggregated and the output comprises single channel, only the designated input channel is subjected to such an architecture. Considering that certain channel was designated to be replaced in Sec. IVB3, the channel to be withdrawn preserves its identity through residual connection, and moreover, it reflects the aggregated representation over both channels and sequence since MSA proceeds the output sequence from MCA module. C. Loss Function and Learning Technique In this study, the classification problem of destination estimation is formulated given the vessel trajectory from its departure. Therefore, let the model input be denoted as = {x1, . . . , xT ; Yx; Sx}, where an accumulated AIS observation from single ongoing ship at time step and the voyage is departed from port Yx and the ship belongs to type Sx. Thereafter, in processing the multichannel sequence structure, WAY repeatedly aggregates information from channels and the past. The current step of the designated channel representation Rd to is converted from the last CASP block output probability distribution over port classes using the final linear transition RdY with the softmax function, which is defined as: LCE(y, x, θ) = log (yx1:T ; Yx; Sx, θ) (12) where CE denotes Cross Entropy loss, is the future destination port, and θ denotes the model parameters. Indeed, by exploiting the loss above, many-to-many model training framework results in biased parameter update. Given the full port-to-port trajectories, the summation of feedback within the sequence toward single destination can be affected by certain extremely long instances. To address this issue, Gradient Dropout learning technique is proposed. This technique controls the validity of stepwise loss from each instance in the mini-batch. The validity is determined stochastically by the sampling ratio, which is inversely proportional to the log-scaled length of the instances, as follows: δk = 1 + logmax(N1,...,NB ) min(N1, . . . , NB) Nk (13) where Nk for {1, . . . , B} denotes the length of the kth among instances in the mini-batch. As shown in Fig. 7, sampling ratio δk adjusts the feedback validity over instances, balancing the loss update against the lengths. KIM ET AL.: WAY: ESTIMATION OF VESSEL DESTINATION IN WORLDWIDE AIS TRAJECTORY 9 TABLE The components of AIS trajectory features. Category Features AIS Timestamp Estimated Time of Arrival Longitude Latitude Speed Over Ground Rate Of Turn Course Over Ground Heading AIS draught Ship Type Port Departure Unit UTC UTC degree degree knot degree degree degree meter categorical categorical Fig. 7. An example of Gradient Dropout learning technique. (a) shows the valid steps of instances in the training batch and (b) visualizes the same batch after the technique is applied. V. EXPERIMENTS A. Dataset Satellite AIS data collected from ORBCOMM and port identification data provided by SeaVantage were used during this study. Experiments were conducted on 5year (January 2016-November 2020) accumulated realworld AIS data of 5,103 individual ships, where the vessels belong to one of three types: tanker, container, and bulk. total of 130K trajectories comprising 17M AIS messages were mapped between 3,243 port classes using the framework described in Section IIIB. destination-wise stratified split was used to generate the training/validation/test trajectory dataset as 70%, 15%, and 15% of the total. Given AIS trajectory instances, the features exploited by the proposed method are listed in Table I. In addition to the timestamps and coordinates, relevant to the preprocessing of the relative coordinates and time distances previously stated in Sec. IVA, other numerical features were adopted to reflect the local navigational patterns. It should also be noted that ETA, which is human-generated, was preprocessed to the time distance between the current timestamp, and the departure port indicates the categorical index among the list of total port classes. processing fields, Transformer-decoder and TrAISformer [12] architectures were added for comparison. Dividing the global ocean area into spatial grid, unit size of 1 1 (2 ) was set as the processing unit. As contemplation of prior grid-token-based approaches, the comparison models embedded lookup tables for spatial vocabularies and learned their representations from the training set. In the comparison of benchmarks, the models shared the hyperparameters of the number of stacked layers = 4 and hidden dimension size = 128. In addition, TrAISformers, Transformer-decoder, and WAY shared the hyperparameters relevant to the attention architecture and feedforward network, which are the number of attention heads = 4, the head-wise hidden dimension size dk = 64, and the intermediate dimension size in the feedforward network df = 256. The models were trained using the Adam [52] optimizer for 100 epochs with batch size of 32 and dropout ratio of 30%, where the learning rate was set to 1e4. Test evaluations were conducted for each model when the minimal loss was recorded for the validation set. 2. Evaluation Metric An accuracy metric was adopted to evaluate the models in terms of port classification, where the overall and quartile-based accuracies were measured. The overall accuracy subjectifies the correctness of the models estimation for every grid-unit step. The evaluation of accuracy is measured as the equation below: B. Experimental Setup Accuracy = 1. Benchmark Models and Implementation Details Benchmark models selected from previous studies were employed to process AIS data, and the details were modified to meet the objective of the task. LSTM [38] was the most frequently used sequence model in the maritime domain. Sharing the gated sequential processing concept with LSTM, GRU [44] was occasionally adopted as comparison in priors and the applications of the attention mechanism [48] to both LSTM and GRU were also considered. In addition, considering that Transformer [40] has improved the performance of various sequential data (cid:80)M i=1 (cid:80)Ni j=1(yi = ˆyij) (cid:80)Ni j=1 (cid:80)M i=1 (14) where indexes the trajectory instances from the test set , and Ni corresponds to the length of unit-grid sequence composing the ith instance. The destination port class of ith trajectory is denoted by yi, and ˆyij indicates the class of the maximum probability the model infers at the progression step of the trajectory. Given that the performance can vary depending on the voyage progress, the accuracy of different voyage progressions was also assessed. Quartile-based accuracy was measured by adjusting the iteration range of from Equation 14. The models were 10 IEEE TRANSACTIONS ON AEROSPACE AND ELECTRONIC SYSTEMS VOL. XX, No. XX XXXXXXX TABLE II Benchmark comparison results. The models are evaluated by quartered progression (Q) and overall trajectory steps. Quartile division is based on the length of the observed data. Method LSTM LSTM-ATTN GRU GRU-ATTN Transformer-decoder TrAISformer TrAISformer-multiResolution WAY (ours) WAY w/ GD (ours) Accuracy(%) Overall 0Q 1Q 1Q 2Q 2Q 3Q 3Q 4Q 56.48 0.32 55.76 0.17 56.35 0.40 56.45 0.09 60.26 0.05 64.38 0.14 64.60 0.28 79.45 0.32 80.44 0. 40.90 0.60 41.60 0.15 41.30 0.07 41.54 0.26 44.35 0.26 50.15 0.22 50.23 0.36 56.63 0.16 55.77 0.35 55.74 0.55 56.32 0.39 59.45 0.27 63.62 0.10 64.07 0.49 62.48 0.27 61.56 0.35 62.18 0.50 62.25 0.16 65.83 0.32 69.44 0.12 69.60 0.22 67.04 0.49 65.13 0.23 67.25 0.52 66.60 0.21 72.46 0.12 75.27 0.13 75.46 0.13 71.21 0.21 71.96 0.20 79.50 0.22 80.19 0. 82.42 0.40 83.38 0.06 85.25 0.47 86.81 0.20 F1-score(%) Overall 27.30 1.22 27.40 0.82 29.02 0.11 28.21 0.15 32.79 0.53 33.12 0.26 34.10 0.26 49.45 0.68 52.01 0. Fig. 8. The actual estimation result of each comparison model for the sample test trajectory. The trajectory proceeds from the Red marker (Departure port) to the Blue marker (Destination port). The grids are colored Green if the estimation was correct at the respective steps, while the Orange denotes the model has estimated the wrong destination. evaluated along the quarter-wise accumulated progression of each test trajectory, hence the range of (1, Ni) at the term (cid:80)Ni 4 Ni), ( 1 2 Ni), ( 1 2 Ni + 1, 3 4 Ni + 1, Ni), according to quartiles respectively. j=1 was adjusted into (1, 1 4 Ni), and ( 3 4 Ni + 1, 1 Additionally, an overall F1-score was adopted to verify the models under an imbalanced label condition. The measurement of F1-score for each port class follows the equation below: True Positive (TP) = (cid:80)M i=1 False Positive (FP) = (cid:80)M i=1 False Negative (FN) = (cid:80)M i=1 (yi = ˆyij) 1c yi 1/c yi(c = ˆyij) (cid:80)Ni j=1 (cid:80)Ni j=1 (cid:80)Ni j=1 TP TP + 0.5(FP + FN) 1c yi (yi = ˆyij) F1-score = (15) where 1c yi denotes if destination port label yi is class and 1/c yi denotes that the destination of the ith trajectory is other than the class c. Finally, the overall measure of F1-score for the multi-class classification problem is computed by averaging the class-wise F1-scores, also called macro-averaged F1-score. C. Experimental Results Two types of experimental results are presented in this subsection: First, the overall performance of estimating the long-term destination between WAY and other benchmark models is compared, whilst another experiment verifies the advantage of using Gradient Dropout (GD). As shown in Table II, WAY achieves remarkable improvement compared to the other benchmark models, and WAY with GD further demonstrates performance gain. As well as the overall scores, WAY improves the performance of destination estimation for all steps along the trajectory, especially of which steps were included before the 1st quartile progression. Fig. 8 illustrates the example of actual estimation results from each comparison model given the sample trajectory. In this regard, the experiment implies the limitation of the coarse spatial representation from the basic grid-token approaches for handling AIS KIM ET AL.: WAY: ESTIMATION OF VESSEL DESTINATION IN WORLDWIDE AIS TRAJECTORY 11 TABLE III Verifying the effect of Gradient Dropout (GD) learning technique. Method Accuracy(%) F1-score(%) w/o w/ GD w/o w/ GD LSTM LSTM-ATTN GRU GRU-ATNN Transformer-decoder TrAISformer TrAISformer-multiResolution 56.48 0.32 55.76 0.17 56.35 0.40 56.45 0.09 60.26 0.05 64.38 0.14 64.60 0.28 57.20 0.30 56.48 0.10 57.70 0.25 57.15 0.16 60.68 0.07 66.06 0.46 66.13 0.03 27.30 1.22 27.40 0.82 29.02 0.11 28.21 0.15 32.79 0.53 33.12 0.26 34.10 0.26 28.85 0.47 29.22 0.20 30.23 0.77 29.96 0.28 33.22 0.10 36.30 0.35 37.00 0.06 WAY (ours) 79.45 0. 80.44 0.11 49.45 0.68 52.01 0.80 data worldwide. This suggests the importance of enriching the detailed representations of the AIS trajectory and aggregating information effectively. Among the conventional methods that represent trajectories using only spatial tokens (LSTM, GRU, -ATTNs, Transformer-decoder), Transformerdecoder records the highest performance. Differentiated from the other prior recurrent sequence processing models, which are considerably dependent on the current step representation, Transformerdecoder is shown to be advantageous for handling long sequence of AIS trajectories. Self attention, the concept introduced in Transformer to maximize the utility of the attention mechanism, is robust to the long-term dependency while treating each step equally in the processing of sequential steps. Contrastively, the appliance of the attention mechanism, on the top of the recurrent processing models, is shown to be uncompetitive. Considering that the objective is to estimate long-range destinations far beyond time and space, the recurrence is speculated as rather enforcing the dependency and failing to capture the inter-token long-term correlation along the trajectory. Thus, it seems difficult that the improvement is anticipated using shallow attention computation under lack of sharable representation. TrAISformers, which have an identical structure to Transformer-decoder, accomplish extra improvement by carrying out their own tokenization method that accepts extra features from AIS trajectories other than the prevalent spatial tokenization. In the approach of TrAISformers, the regions are tokenized separately by each axis of longitude and latitude, and SOG and COG are discretized and also represented as tokens. Thereafter, they concatenate the representations of the coordinates, SOG, and COG, allowing the transformer decoder to process the data. The improvement shown in TrAISformers supports that the availability of AIS features other than spatial coordinates, enriching the representations of AIS trajectory, benefits the performance despite adopting the same sequential processing steps. The results also show discrepancies between the accuracy and F1 measure from the benchmark models, including WAY. This is attributed to the disparities originating from the imbalance in port-to-port operation frequency this study depending on the ship type. Nevertheless, confirms that WAY clearly manifests its performance on both sides of the evaluation. The results in Table II verify that GD increases the performance of WAY. To generalize the advantage of the task-specialized learning technique in the trajectories with large length deviations, GDs were applied to benchmark models. As shown in Table III, the results suggest that applying GD always achieves performance gain regardless of the backbone model. The average gains are +1.01% for the overall accuracy and +1.92% for the F1-score. D. Further Experiments In this subsection, further experiments are conducted to examine the effects of the proposed methods on the performance. The experiments covers the comparison results based on the feature types, channel aggregation methods, and model capacity. Feature types. The importance of considering trajectory representations are discussed, where, to achieve enriched representations, WAY divided the feature types, other than spatial areas, into local navigational patterns, departure, and ship types and developed representation methods to fit each type. In Table IV, an experiment is conducted to investigate the effect of each feature type by removing one feature type. It is observed that all of the feature types significantly affected the performance gain, and navigational patterns, particularly contributed to the improvement in the performance. Channel aggregation methods. Considering the multichannel representations of AIS trajectories, aggregation methods for inter-channel information are explored. Unifying channels via dimension-wise concatenation is typical method for aggregating information distributed in multiple channels. Introduced to process multi-modal time series, Cross Attention [53] is representative method to reflect mutual information between sequences. In addition, the original Channel Attention [45], the predecessor of MCA module in WAY is also examined without the extension of multi-headed perspectives. The results listed in Table suggest that the proposed channel aggregation method is outstanding in terms of assembling the representations of each channel. IEEE TRANSACTIONS ON AEROSPACE AND ELECTRONIC SYSTEMS VOL. XX, No. XX XXXXXXX 2023 TABLE IV Comparison of performance dependence on each represented channel. Channel Availability Accuracy(%) F1-score(%) w/o Local Pattern w/o Departure w/o Ship Type Use All (base) 64.70 0.24 76.35 0.46 78.84 0.22 38.31 0.57 42.36 0.64 48.58 0.78 79.45 0.32 49.45 0.68 TABLE Comparison of inter-channel aggregation methods. Aggregation Method Accuracy(%) F1-score(%) Concatenation Cross Attention Channel Attention 73.59 0.10 75.61 0.49 77.94 0.34 42.47 0.27 40.95 0.10 48.59 0. Multi-head Channel Attention 79.45 0.32 49.45 0.68 TABLE VI Comparison of model capacity and the performances. Method #Parameter Accuracy(%) F1-score(%) LSTM GRU TF-decoder TrAISformer WAY-Tiny WAY-Small WAY (base) 4.76M 4.62M 5.02M 1.30M 0.24M 0.52M 2.04M 56.48 0.32 56.35 0.40 60.26 0.05 64.38 0.14 69.51 0.22 74.68 0.05 79.45 0.32 27.30 1.22 29.02 0.11 32.79 0.53 33.12 0.26 36.32 0.28 43.92 0.66 49.45 0.68 Model capacity. Finally, Table VI presents the experimental results of the model comparison in terms of capacity and performance. The experiment includes benchmark models with conventional grid-token-based approach (LSTM, GRU, and Transformer-decoder), TrAISformer, which designed its own technique of tokenbased representation, and WAY-Tiny and WAY-Small. WAY-Tiny and WAY-Small have the same architecture as WAY (base); however, their hyperparameters are adjusted, where {L, d, h, dk, df } are set to {2, 32, 2, 16, 128} and {2, 64, 2, 32, 128}, respectively. The results demonstrates that the previous methods for laying an embedding table of learnable parameters for spatial areas overwhelm the number of parameters, while their performances are uncompetitive. TrAISformer succeeds in reducing parameters and improving the performance compared to the above but fails to overcome the parameterizing for spatial correlation. However, WAY (base) achieves the highest score evaluation without wasting massive number of parameters for covering worldwide regions. Although WAY-Tiny and WAY-Small are not shown to have the best performance, they still outperform the other benchmarks with 2.5 20.5 times fewer parameters. VI. DISCUSSION This section discusses additional tasks before applying WAY to solve the port congestion problem. As proved TABLE VII The comparison results in terms of destination and arrival time estimation. Method Human-made WAY WAY GD WAY-Mul WAY-Mul GD Objective Metric Destination Arrival time Accruracy MAE - 79.45 80.44 79.30 80.05 4.26 - - 3.03 2. in Section V, WAY achieved outstanding performance in terms of destination estimation; however, knowing both the destination and arrival times of vessels is necessary to address the port congestion problem. Considering its application in the industry, further experiment is conducted to verify whether WAY, as an end-to-end model, could show outstanding performance in terms of both destination and arrival time estimation. WAY-Mul, comprising the classifier and an additional regression head to estimate both the destination and arrival time, is designed and trained with the same parameters as used for WAY. Table VII summarizes the comparison result between human-made ETA and WAY-Muls estimation. WAY-Mul reduces the arrival time errors from 4.26 days to 2.90 3.03 days while keeping the performance at destination estimation. Although the experiment result shows WAYs expandability from single-task to multi-task learning, the performance of estimating arrival time needs to be improved to solve the port congestion problem. It is shown that low performance of arrival time estimation occurred time labels. The arrival owing to inconsistent arrival time of vessels is affected by voyage conditions such as the distance between departure and destination port, vessel speed, and draft. However, external factors like port congestion and due date of shipping result in waiting time, which leads to inconsistent arrival time. Since WAYs expandability to multi-task learning is verified, WAY can achieve outstanding performance in terms of both destination and arrival time estimation if consistent arrival time labels are guaranteed. In future studies, different annotation framework needs to be designed for consistent arrival time labels. Given the consistent arrival time labels, the authors believe that the accurate estimation within both destination and arrival time can be achieved, and thus this study contributes to mitigating the port congestion problem. VII. CONCLUSION This study establishes the necessity of handling global range AIS data to address the problem of port destination estimation and introduces novel data-driven approach toward the AIS trajectory. Based on the premise that port-to-port annotated trajectory is given, the objective of maximizing the probability of the target destination is KIM ET AL.: WAY: ESTIMATION OF VESSEL DESTINATION IN WORLDWIDE AIS TRAJECTORY 13 formulated. Recasting the objective defined on messagewise trajectory processing to the uniform grid-wise processing, the approach mitigates the spatio-temporal bias within long international AIS data forming irregular intervals. Concurrently, by adopting the nested sequence representation, the rearranged trajectory preserves the details of the original. Based on this approach, the end-to-end model architecture of WAY is proposed, which demonstrates state-ofthe-art performance by processing the AIS trajectory as 4-channel vector sequence. Based on multi-channel representation, WAY processes AIS trajectories in spatial grid steps without losing the detailed AIS properties such as global-spatial identities, local patterns, semantics, and time irregular progression of trajectory. Experimental results highlight the importance of enriching the details and effective aggregation of the long sequence while showing the limitations of the conventional grid-based approach, that is, the coarse portrayal of trajectories. Additionally, the experimental results verify that the adoption of Gradient Dropout, task-specialized learning technique, leads to further performance gain in the estimation. The performance gain is shown not only for WAY, but also for other benchmarks based on the conventional spatial grid approach. Finally, this study shows the expandability of WAY into multi-tasked learning for ETA, and discusses provision of real-world port congestion estimation that can be realized through further improvement in identifying the accurate time of arrival from historical AIS data."
        },
        {
            "title": "REFERENCES",
            "content": "[1] S. N. Sirimanne, J. Hoffman, R. Asariotis, G. Ayala, M. Assaf, C. Bacrot et al., Review of maritime transport 2021, ser. Review of Maritime Transport. United Nations, Mar 2022. [2] International convention for the safety of life at sea (SOLAS), chapter V, regulation 19, 2002. [3] B. Ristic, B. La Scala, M. Morelande, and N. Gordon, Statistical analysis of motion patterns in AIS data: Anomaly detection and motion prediction, in Proceedings of the IEEE International Conference on Information Fusion (FUSION), 2008, pp. 17. [4] L. P. Perera, P. Oliveira, and C. G. Soares, Maritime traffic monitoring based on vessel detection, tracking, state estimation, and trajectory prediction, IEEE Transactions on Intelligent Transportation Systems, vol. 13, no. 3, pp. 11881200, 2012. [5] H. J. Park, M. S. Lee, D. I. Park, and S. W. Han, Time-aware and feature similarity self-attention in vessel fuel consumption prediction, Applied Sciences, vol. 11, no. 23, p. 11514, 2021. [6] M. Gao, G. Shi, and S. Li, Online prediction of ship behavior with automatic identification system sensor data using bidirectional long short-term memory recurrent neural network, Sensors, vol. 18, no. 12, p. 4211, 2018. [7] D. Nguyen, R. Vadaine, G. Hajduch, R. Garello, and R. Fablet, multi-task deep learning architecture for maritime surveillance using AIS data streams, in Proceedings of the IEEE International Conference on Data Science and Advanced Analytics (DSAA), 2018, pp. 331340. [8] N. Forti, L. M. Millefiori, P. Braca, and P. Willett, Prediction of vessel trajectories from AIS data via sequence-to-sequence recurrent neural networks, in Proceedings of the IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP), 2020, pp. 89368940. [9] S. Capobianco, L. M. Millefiori, N. Forti, P. Braca, and P. Willett, Deep learning methods for vessel trajectory prediction based on recurrent neural networks, IEEE Transactions on Aerospace and Electronic Systems, vol. 57, no. 6, pp. 43294346, 2021. [10] J. Y. Yu, M. O. Sghaier, and Z. Grabowiecka, Deep learning approaches for AIS data association in the context of maritime domain awareness, in Proceedings of the IEEE International Conference on Information Fusion (FUSION), 2020, pp. 18. [11] X. Zhou, Z. Liu, F. Wang, Y. Xie, and X. Zhang, Using deep learning to forecast maritime vessel flows, Sensors, vol. 20, no. 6, p. 1761, 2020. [12] D. Nguyen and R. Fablet, TrAISformer-A generative transformer for AIS trajectory prediction, arXiv preprint arXiv:2109.03958, 2021. [13] D.-D. Nguyen, C. Le Van, and M. I. Ali, Vessel trajectory prediction using sequence-to-sequence models over spatial grid, in Proceedings of the ACM International Conference on Distributed and Event-based Systems (DEBS), 2018, pp. 258261. [14] D. Zissis, K. Chatzikokolakis, G. Spiliopoulos, and M. Vodas, distributed spatial method for modeling maritime routes, IEEE Access, vol. 8, pp. 47 55647 568, 2020. [15] L. M. Millefiori, P. Braca, D. Zissis, G. Spiliopoulos, S. Marano, P. K. Willett, and S. Carniel, Covid-19 impact on global maritime mobility, Scientific reports, vol. 11, no. 1, pp. 116, 2021. [16] B. J. Tetreault, Use of the automatic identification system (AIS) for maritime domain awareness (MDA), in Proceedings of the IEEE/MTS Oceans. IEEE, 2005, pp. 15901594. [17] A. Weintrit, Marine navigation and safety of sea transportation. CRC Press, 2009. [18] E. Tu, G. Zhang, L. Rachmawati, E. Rajabally, and G.-B. Huang, Exploiting AIS data for intelligent maritime navigation: comprehensive survey from data to methodology, IEEE Transactions on Intelligent Transportation Systems, vol. 19, no. 5, pp. 1559 1582, 2017. [19] C. Claramunt, C. Ray, L. Salmon, E. Camossi, M. Hadzagic, A. Jousselme, G. Andrienko, N. Andrienko, Y. Theodoridis, and G. Vouros, Maritime data integration and analysis: recent progress and research challenges, Advances in Database Technology-EDBT, vol. 2017, pp. 192197, 2017. [20] R. Kerbiriou, L. Levˆeque, A. Rajabi, and A. Serry, The automatic identification system (AIS) as data source for studying maritime traffic, in Proceedings of the International Maritime Science Conference, 2017. [21] A. Harati-Mokhtari, A. Wall, P. Brooks, and J. Wang, Automatic identification system (AIS): data reliability and human error implications, The Journal of Navigation, vol. 60, no. 3, pp. 373389, 2007. [22] L. Zhao, G. Shi, and J. Yang, Ship trajectories pre-processing based on AIS data, The Journal of Navigation, vol. 71, no. 5, pp. 12101230, 2018. [23] F. Heymann, T. Noack, and P. Banys, Plausibility analysis of navigation related AIS parameter based on time series, 2013. [24] S. Mao, E. Tu, G. Zhang, L. Rachmawati, E. Rajabally, and G.- B. Huang, An automatic identification system (AIS) database for maritime trajectory prediction and data mining, in Proceedings of ELM-2016. Springer, 2018, pp. 241257. [25] D. A. Herrero, D. S. Pedroche, J. G. Herrero, and J. M. M. Lopez, AIS trajectory classification based on IMM data, in Proceedings of the IEEE International Conference on Information Fusion (FUSION), 2019, pp. 18. [26] S. Sun, Y. Chen, Z. Piao, and J. Zhang, Vessel AIS trajectory online compression based on scan-pick-move algorithm added sliding window, IEEE Access, vol. 8, pp. 109 350109 359, 2020. [27] M. Mieczynska and I. Czarnowski, DBSCAN algorithm for AIS data reconstruction, Procedia Computer Science, vol. 192, pp. 25122521, 2021. [28] G. Pallotta, M. Vespe, and K. Bryan, Vessel pattern knowledge discovery from AIS data: framework for anomaly detection and route prediction, Entropy, vol. 15, no. 6, pp. 22182245, 2013. 14 IEEE TRANSACTIONS ON AEROSPACE AND ELECTRONIC SYSTEMS VOL. XX, No. XX XXXXXXX 2023 [48] T. Luong, H. Pham, and C. D. Manning, Effective approaches to attention-based neural machine translation, in Proceedings of the Conference on Empirical Methods in Natural Language Processing (EMNLP), 2015, pp. 14121421. [49] C.-Y. Wang, H.-Y. M. Liao, Y.-H. Wu, P.-Y. Chen, J.-W. Hsieh, and I.-H. Yeh, CSPNet: new backbone that can enhance learning capability of CNN, in Proceedings of the IEEE/CVF Computer Vision and Pattern Recognition (CVPR) Workshops, 2020, pp. 390391. [50] K. He, X. Zhang, S. Ren, and J. Sun, Deep residual learning for image recognition, in Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR), 2016, pp. 770778. [51] J. L. Ba, J. R. Kiros, and G. E. Hinton, Layer normalization, arXiv preprint arXiv:1607.06450, 2016. [52] D. P. Kingma and J. Ba, Adam: method for stochastic optimization, in Proceedings of the International Conference on Learning Representations (ICLR), 2015. [53] Y.-H. H. Tsai, S. Bai, P. P. Liang, J. Z. Kolter, L.-P. Morency, and R. Salakhutdinov, Multimodal transformer for unaligned multimodal language sequences, in Proceedings of the conference. Association for Computational Linguistics. Meeting. NIH Public Access, 2019, p. 6558. Jin Sob Kim received the B.S. degree in computer engineering from Hongik University, Seoul, Republic of Korea, in 2021. He is currently pursuing Ph.D. degree at the school of industrial and management engineering with Korea University, Seoul, Republic of Korea. His research interests spatiotemporal data mining, attention mechanism, time series modeling, and deep learning. include Hyun Joon Park received the B.S. degree in industrial engineering from Hongik University, Seoul, Republic of Korea, in 2020. He is currently pursuing Ph.D. degree at the school of industrial and management engineering at Korea University, Seoul, Republic of Korea. His research interests include attention mechanism, time series modeling, speech enhancement, and deep learning. Wooseok Shin received the B.S. degree in industrial and information systems engineering from Seoul National University of Science and Technology, Seoul, Republic of Korea, in 2020. He is currently pursuing Ph.D. degree at the school of industrial and management engineering with Korea University, Seoul, Republic of Korea. His research interests include model compression in computer vision and speech. [29] H. Georgiou, S. Karagiorgou, Y. Kontoulis, N. Pelekis, P. Petrou, D. Scarlatti, and Y. Theodoridis, Moving objects analytics: Survey on future location & trajectory prediction methods, arXiv preprint arXiv:1807.04639, 2018. [30] X. R. Li and V. P. Jilkov, Survey of maneuvering target tracking. Part I. Dynamic models, IEEE Transactions on aerospace and electronic systems, vol. 39, no. 4, pp. 13331364, 2003. [31] Z. Xiao, X. Fu, L. Zhang, and R. S. M. Goh, Traffic pattern mining and forecasting technologies in maritime traffic service networks: comprehensive survey, IEEE Transactions on Intelligent Transportation Systems, vol. 21, no. 5, pp. 17961825, 2019. [32] L. M. Millefiori, P. Braca, K. Bryan, and P. Willett, Long-term vessel kinematics prediction exploiting mean-reverting processes, in Proceedings of the IEEE International Conference on Information Fusion (FUSION), 2016, pp. 232239. [33] , Modeling vessel kinematics using stochastic meanreverting process for long-term prediction, IEEE Transactions on Aerospace and Electronic Systems, vol. 52, no. 5, pp. 23132330, 2016. [34] J. Liang, B. I. Ahmad, R. Gan, P. Langdon, R. Hardy, and S. Godsill, On destination prediction based on markov bridging distributions, IEEE Signal Processing Letters, vol. 26, no. 11, pp. 16631667, 2019. [35] B. I. Ahmad, J. K. Murphy, P. M. Langdon, and S. J. Godsill, Bayesian intent prediction in object tracking using bridging distributions, IEEE transactions on cybernetics, vol. 48, no. 1, pp. 215227, 2016. [36] D. E. Rumelhart, G. E. Hinton, and R. J. Williams, Learning representations by back-propagating errors, nature, vol. 323, no. 6088, pp. 533536, 1986. [37] P. J. Werbos, Backpropagation through time: what it does and how to do it, Proceedings of the IEEE, vol. 78, no. 10, pp. 1550 1560, 1990. [38] S. Hochreiter and J. Schmidhuber, Long short-term memory, Neural computation, vol. 9, no. 8, pp. 17351780, 1997. [39] I. Sutskever, O. Vinyals, and Q. V. Le, Sequence to sequence learning with neural networks, in Advances in Neural Information Processing Systems (NIPS), 2014, pp. 31043112. [40] A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez, Ł. Kaiser, and I. Polosukhin, Attention is all you need, in Advances in Neural Information Processing Systems (NIPS), 2017, pp. 59986008. [41] V. I. Levenshtein et al., Binary codes capable of correcting deletions, insertions, and reversals, in Soviet physics doklady, vol. 10, no. 8. Soviet Union, 1966, pp. 707710. [42] F. J. Damerau, technique for computer detection and correction of spelling errors, Communications of the ACM, vol. 7, no. 3, pp. 171176, 1964. [43] K. Pearson, LIII. On lines and planes of closest fit to systems of points in space, The London, Edinburgh, and Dublin philosophical magazine and journal of science, vol. 2, no. 11, pp. 559572, 1901. [44] K. Cho, B. van Merrienboer, . Gulcehre, D. Bahdanau, F. Bougares, H. Schwenk, and Y. Bengio, Learning phrase representations using RNN encoder-decoder for statistical machine translation, in Proceedings of the Conference on Empirical Methods in Natural Language Processing (EMNLP), 2014, pp. 1724 1734. [45] J. Hu, L. Shen, and G. Sun, Squeeze-and-excitation networks, in Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR), 2018, pp. 71327141. [46] V. Nair and G. E. Hinton, Rectified linear units improve restricted boltzmann machines, in Proceedings of the International Conference on Machine Learning (ICML), 2010, pp. 807814. [47] D. Bahdanau, K. Cho, and Y. Bengio, Neural machine translation by jointly learning to align and translate, in Proceedings of the International Conference on Learning Representations (ICLR), 2015. KIM ET AL.: WAY: ESTIMATION OF VESSEL DESTINATION IN WORLDWIDE AIS TRAJECTORY 15 Dongil Park received the B.S. degree in computer engineering from Gyeongnam National University of Science, Gyeongnam, Korea, in 2003. He is currently in charge of Chief Technical Officer at SeaVantage, in Seoul, Korea. His research interests include the development of maritime platforms, ship routing systems, transportation economics, and applications of deep learning in the vessel domain. Sung Won Han received the M.S. degrees in operations research, in statistics, and in mathematics from the Georgia Institute of Technology, Atlanta, GA, USA in 2006, 2007, and 2010, respectively, and the Ph.D. degree from the school of industrial and systems engineering (statistics), Georgia Institute of Technology, Atlanta, GA, USA. He was senior research scientist with the division of biostatistics, school of medicine, New York University, NY, USA, and postdoctoral researcher with the department of biostatistics and epidemiology/center for clinical epidemiology and biostatistics, school of medicine, University of Pennsylvania, Philadelphia, PA, USA. He is currently an associate professor with the school of industrial and management engineering, Korea University, Seoul, Republic of Korea. His research interests include probabilistic graphical model, network analysis, machine learning, and deep learning. 16 IEEE TRANSACTIONS ON AEROSPACE AND ELECTRONIC SYSTEMS VOL. XX, No. XX XXXXXXX"
        },
        {
            "title": "Appendix",
            "content": "A. Port Label Annotation Algorithm 1 Destination candidate extraction REGULARIZE(exp[1 : m]) for 1 to do exp[i] space if exp[i] special character strip(exp[i]) if exp[i 1] = space exp N-gram(exp, space) return exp EXTRACT CANDIDATE(exp{1 : }, port{1 : }) candidates for 1 to do for 1 to do distance DL(exp[n], port[y]) score 1 (distance/exp[n]) if score > thresh then candidates candidates {port[y]} return candidates The AIS destination, string data written by humans, semantically indicates the destination port of the current navigation. However, the data have been barely trustworthy because of the errors caused by humans paradoxically, such as unformatted indications, diverse languages, misspells, delaying updates, and unrelated information to destinations. In many cases, however, the data have alphabetical similarities with port identifications, which are the names and UN/LOCODE (code for ports and other locations). Therefore, the resemblances support the idea that the data contain an intention to express the destination in its own way while the freight is ongoing. To read the semantic context of the written data and map it to the actual ports, DamerauLevenshtein (DL) distance [41], [42] method is used to measure the similarity between the AIS destination and port identifications. The thresholding of similarities yields the current destination candidates. The posterior verification is then conducted on nominee ports based on whether future trajectory progression illustrates that the ship actually arrives and docks to the ports. For each transmitted AIS message, given AIS destination expression exp comprising characters, the Algorithm 1 is the pseudocode for computing the similarities and narrowing down the destination candidates among port identifications. The expression is first regularized and turned into an N-gram set to consider any possibility of partial context being included. Thereafter, for individual grams in the set, the candidates are extracted by similarity scores computed for each port identification, where the scores are measured based on the DL distance, exp[n] denotes the length of the nth gram string, and thresh = 0.75. Subsequently, based on the candidate nominated ports, valid trajectory continuities are verified by kinematic features at the posterior perspective regarding any range of sequences from raw AIS data. The pseudocode Algorithm Algorithm 2 Posterior candidate validation POSITIONAL STATUS(X{1 : }, port{1 : }) status for 1 to do coord X[t].(Longitude, Latitude) if status[1] = then distance Euclidean(coord, center) if rad > distance then append(status, c); continue lag false for X[t].candidates{1 : C} do rad α(cid:112)area(port[c].P olygon)/π center center(port[c].P olygon) distance Euclidean(coord, center) if rad > distance then lag true append(status, c); break if lag = true then continue if X[t].SpeedOverGround > 1 then append(status, 0) else append(status, null) return status EXTRACT TRAJECTORY(X{1 : }) ; for 1 to do if X[t].status {0, null} then append(s, X[t]); continue 0 port X[t].status port{1 : } while X[t + j].status = port do append(s, X[t + j]) if nearest(X[t + j].coord, port.center) then append(S, s); + 1 continue as + return VALIDATE TRAJECTORY(S{1 : }) for s{t 1 : ˆT } S{1 : } do dept s[1].status; dest s[ ˆT ].status if dept, dest / {0, null} and dept = dest and s[t].status = null and s[t].status = 0 and s[t].candidates {dept, dest} = and (s[t] s[t 1]).T imestamp < thresh continue delete(S, s) return 2, comprising three subprocedures, describes the procedure of annotating trajectories from the raw accumulated data and the verification of each annotated trajectory such that the set of valid trajectories remains at the end. KIM ET AL.: WAY: ESTIMATION OF VESSEL DESTINATION IN WORLDWIDE AIS TRAJECTORY 17 Fig. 9. Visualization of posterior candidate validation in-process. The voyage proceeds from left to right, and colors denote observations with the port as one of the candidates. (a) and (b) are expanded images from the box regions above, illustrating the geo-polygons of each port and their thresholds around these areas. Before the start of this procedure, the authors strongly recommend the readers to use spherical distance measure (e.g., Haversine) replacing the Euclidean in Algorithm 2. Since it rather fits to assume the coordinates exist on spherical surface than in two-dimensional space. The first part verifies the candidates extracted from Algorithm 1 and confirms the actual moment of arrival within the coordinates and SOG recorded in the raw data. This process generates status tags for positions on whether the ship is on the dock or ongoing. The border of tag decisions is dependent on the size of the geo-polygon areas marginalized by α = 1.8, which creates circular boundaries, such as the dashed lines around each port area shown in Fig. 9a and Fig. 9b. In addition, under the circumstances of an ongoing ship, two status tags are specified, where 0 indicates acceleration and the null value denotes staying still at the location. These tags are used to validate the trajectories. the accumulated data are split Referring to the positional status tags defined in the previous process, into individual sections whose departure and destination were confirmed. The division occurs at the nearest point among the observations included in the port boundaries, organizing the set of trajectories S. Finally, the trajectories are verified with singular pair of departure and destination. In other words, the sections with the possibility of the subject containing more than one ship operation are excluded; however, the pairs at the beginning and the end were confirmed. In this validation, the aforementioned status tags are used to affirm whether trajectory sequence included cease behavior apart from confirmed Fig. 10. Examples of illogical movement detected using the DBSCAN algorithm. The Red edges are excluded as anomalies. departure or destination location, while the acceleration must have been shown in the trajectory at least once. In addition, the context of the human source is verified over the sequences, checking of port candidates from every observation if any moment exists that neither candidate intended to represent departure or destination. The insufficiency of the kinetical reason forms part of the validation, and thresh = 3 days is set as the maximum allowance of the time gap between continuous observations. B. Trajectory Refinement While the annotation process concentrates on capturing the errors that arise from human resources and clarifies the context of trajectories, the refinement process focuses on rectifying machinery errors that generate illogical movements during trajectory progression. There are some default values in the kinetic features included in AIS messages, such as SOG of 1023, COG of 360, ROT of 731, and 511 heading. The values indicate the definite error signs reasoned by the out-of-field range; therefore, the removal must be performed. However, in addition to the clear signs, illogical shifts still exists in the annotated trajectories. These anomalies can occur either by the combination or by the sole of unspecified transmission errors. The density-based clustering algorithm, DBSCAN, is utilized to capture edge-wise anomalies derived from unrecognized errors. Using the time, spatial distances, and SOGs between each continuous observation pair, residual vectors are composed to represent the normality of edges, where each vector is given as follows: { λ, ϕ, λ, ϕ }/(δtime AVG(SOG)), where the residual of each longitude and latitude are λ and ϕ, denotes the Manhattan distance, is Euclidean, δtime indicates the time interval between two, and AVG() 18 IEEE TRANSACTIONS ON AEROSPACE AND ELECTRONIC SYSTEMS VOL. XX, No. XX XXXXXXX 2023 is set is the average. The hyperparameter of the DBSCAN algorithm, epsilon, to 0.15, and the results of abnormal detection from the edge-wise vectors are shown in Fig 10. By deleting these illogical conclusions, the trajectories can possibly lose their validity if the arrival is betided by such errors. Consequently, the sequences must be re-validated by the last sub-procedure defined in Appendix A. KIM ET AL.: WAY: ESTIMATION OF VESSEL DESTINATION IN WORLDWIDE AIS TRAJECTORY"
        }
    ],
    "affiliations": [
        "Korea University, Seoul 02841, Republic of Korea",
        "SeaVantage, Seoul 06119, Republic of Korea"
    ]
}